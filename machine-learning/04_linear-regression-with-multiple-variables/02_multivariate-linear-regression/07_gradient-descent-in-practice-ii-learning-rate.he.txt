בסרטון זה, אני רוצה לתת כמה עצות מעשיות על איך לגרום לירידה במדרון לעבוד. הרעיונות בסרטון זה מתרכזים סביב קצב הלמידה אלפא. באופן קונקרטי, הנה כלל העדכון של הירידה במדרון. ומה שאני רוצה לעשות בוידאו הזה הוא לספר לכם על מה שאני קורא לו ניפוי באגים, וכמה עצות כדי לוודא שהירידה במדרון פועלת כראוי. ושנית, אני רוצה להסביר איך לבחור את שיעור הלמידה אלפא או לפחות איך שאני בוחר אותו. הנה משהו שאני עושה לעתים קרובות כדי לוודא כי הירידה במדרון פועלת כשורה. התפקיד של ירידה במדרון הוא למצוא את הערך של תטא שאנחנו מקווים שימזער את פונקצית העלות J של תטא. מה שאני עושה לעתים קרובות הוא לשרטט את פונקציית העלות (תטא)J תוך כדי ריצת הירידה במדרון. אז ציר ה-X כאן הוא מספר האיטרציות של הירידה במדרון, וכשהירידה במדרון רצה אנו מקווים לקבל גרף שאולי נראה ככה. שימו לב שציר ה-x הוא מספר האיטרציות. בעבר הסתכלנו על גרפים של (תטא)J שבהם ציר ה-x, הציר האופקי, היה וקטור הפרמטרים תטא אבל זה משהו אחר. באופן ספציפי, הנקודה הזו פירושה הוא כך: אני הולך להריץ ירידה במדרון במשך 100 סיבובים. ויש איזשהו ערך שאני אקבל עבור תטא לאחר 100 חזרות, אני הולך לקבל איזה שהוא ערך של תטא אחרי 100 חזרות. ואז אני אחשב את פונקציית העלות J של תטא. עבור אותו ערך של תטא שאקבל אחרי 100 איטרציות, והגובה האנכי של הנקודה כאן הוא הערך של (תטא)J. עבור הערך של תטא שאותו קיבלתי אחרי 100 איטרציות של ירידה במדרון. והנקודה הזאת כאן מתאימה לערך של (תטא)J עבור תטא שקיבלתי לאחר הפעלת ירידה במדרון למשך 200 איטרציות. אז מה שהגרף מראה הוא, מראה את הערך של פונקציית העלות שלך לאחר כל איטרציה של ירידה במדרון. ואם הירידה במדרון עובדת כראוי אז (תטה)J אמור לרדת לאחר כל איטרציה. עוד דבר שימושי שסוג כזה של כרף יכול להגיד לך הוא שאם תסתכל על הגרף הספציפי שציירתי, זה נראה שכשאתה מגיע אולי ל-300 איטרציות, בין 300 ל-400 איטרציות, הקטע הזה נראה כאילו (תטא)J לא ירד עוד הרבה. אז כשמגיעים ל-400 איטרציות, זה נראה כאילו העקומה הזו כאן משתטחת. או במילים אחרות כשמגיעים ל-400 איטרציות, זה נראה כאילו הירידה במדרון פחות או יותר התכנסה כי פונקצית העלות לא יורדת הרבה יותר. אז הסתכלות על הגרף הזה יכולה גם לעזור לך לשפוט האם הירידה במדרון התכנסה. דרך אגב, מספר האיטרציות שלוקח לירידה במדרון להתכנס ליישום מסוים יכול להשתנות במידה רבה, אז אולי עבור יישום אחד, הירידה במדרון עשויה להתכנס לאחר שלושים חזרות בלבד. עבור יישום אחר, הירידה במדרון עשויה לקחת 3,000 איטרציות, ועבור אלגוריתם למידה אחר, זה עלול לקחת 3 מיליון איטרציות. מתברר שזה קשה מאוד לדעת מראש כמה איטרציות הירידה במדרון צריכה כדי להתכנס. ובדרך כלל על ידי שרטוט סוג כזה של גרף, בו מחשבים את עלות הפונקציה עם הגדלת מספר האיטרציות, בדרך כלל על ידי הסתכלות על הגרפים האלה. אנחנו יכולים להעריך אם הירידה במדרון התכנסה. זה אפשרי גם לכתוב מבחן התכנסות אוטומטי, זאת אומרת, לכתוב אלגוריתם שיכול לומר לך אם הירידה במדרון התכנסה. והנה אולי דוגמה טיפוסית למדי של מבחן ההתכנסות האוטומטית. ומבחן כזה עשוי להכריז על התכנסות אם פונקציית העלות שלך (תטה)J קטַנה בפחות מאשר איזה ערך קטן אפסילון, לדוגמא בפחות מערך קטן כגון 10 בחזקת מינוס 3 באיטרציה אחת. אבל אני מוצא שבדרך כלל לבחור מהו הסף הנכון זה די קשה. ולכן כדי לבדוק את התכנסות הירידה במדרון אני בעצם נוטה להסתכל על גרפים כאלה, כמו הגרף הזה בצד שמאל, במקום להסתמך על מבחן ההתכנסות האוטומטי. מבט על סוג כזה של ציור יכול גם להגיד לך, או לתת לך אזהרה מראש, אם הירידה בשיפוע לא עובדת כראוי. באופן קונקרטי, אם אתה מתווה את (תטא)J כפונקציה של מספר האיטרציות. אז אם אתה רואה גרף כזה שבו (תטא)J למעשה גדל, אז זה נותן לך סימן ברור שהירידה במדרון לא עובדת. ותטא כמו זה בדרך כלל אומר שאתה צריך לשנות את קצב הלמידה אלפא. אם (תטא)J ממש גדל, הסיבה הנפוצה ביותר לכך היא שאתה מנסה למזער פונקציה, שאולי נראית ככה. אבל אם שיעור הלמידה שלך גדול מדי אז אם אתה מתחיל כאן, הירידה במדרון עשויה לפספס את המינימום ולהעיף אותך לשם. ואם שיעור הלמידה גדול מדי, ייתכן שתפספס אותו שוב ותישלח לשם, וכן הלאה. אז מה שבאמת רצית זה להתחיל כאן ולרדת בהדרגה, נכון? אבל אם שיעור הלמידה הוא גדול מדי, אז הירידה במדרון עלולה במקום זאת להמשיך ולהעיף אותך מעל המינימום. אז אתה עלול למצוא את עצמך במצב הולך ומחמיר במקום להגיע לערכים נמוכים יותר של פונקציית העלות (תטה)J. אז אתה מוצא את עצמך עם גרף כזה ואם אתה רואה גרף כזה, שיטת התיקון היא בדרך כלל פשוט להשתמש בערך קטן יותר של אלפא. אה, וגם, כמובן, לוודא שבקוד שלך אין באג שגרם לזה. אבל בדרך כלל ערך גדול מדי של אלפא יכול להיות בעיה נפוצה. באופן דומה לפעמים אתה עשוי גם לראות את (תטה)J עושה משהו כזה, הוא עלול לרדת במשך זמן מה ואז לעלות ואז לרדת קצת ואז לעלות ושוב לרדת במשך זמן מה ואז שוב לעלות וכן הלאה. וגם עבור זה התיקון הוא להשתמש בערך קטן יותר של אלפא. אני לא הולך להוכיח את זה כאן, אבל תחת הנחות מסוימות לגבי פונקציית העלות J, שמתקיימות לגבי רגרסיה ליניארית, מתמטיקאים הוכיחו שאם שיעור הלמידה אלפא הוא קטן מספיק, אז (תטא)J צריך לרדת בכל איטרציה. אז אם זה לא קורה זה כנראה אומר שאלפא גדול מדי, ואתה צריך לקחת ערך קטן יותר. אבל כמובן, אתה גם לא רוצה ששיעור הלמידה יהיה קטן מדי, כי אז הירידה במדרון עלולה להתכנס מאד באיטיות. ואם אלפא יהיה קטן מדי, אתה עלול למצוא את עצמך מתחיל כאן, נניח, ומתקדם רק בצעדי תינוק זעירים. וזה פשוט לוקח המון איטרציות לפני שמגיעים סוף סוף למינימום, ולכן אם אלפא קטן מדי, הירידה במדרון עלולה להתקדם בקצב איטי מאוד ולהתכנס באיטיות. לסיכום, אם שיעור הלמידה הוא קטן מדי, אנחנו עלולים להיתקל בבעיה של התכנסות איטית, ואם שיעור הלמידה הוא גדול מדי, (תטא)J עלול לא לרדת בכל איטרציה ועלול אפילו שלא להתכנס. במקרים מסוימים, אם שיעור הלמידה גדול מדי,
ייתכן גם שכן נגיע להתכנסות אבל איטית. אבל הבעיה הנפוצה יותר שאתה רואה היא פשוט ש-(תטא)J לא יורד בכל איטרציה. וכדי למצוא את כל הבאגים האלה, לעתים קרובות שרטוט של (תטא)J כפונקציה של מספר האיטרציות יכול לעזור לנו להבין מה קורה. באופן מעשי, מה שאני עושה בפועל כאשר אני מפעיל ירידה במדרון הוא לנסות מגוון של ערכים. פשוט מנסה להריץ ירידה במדרון עם טווח של ערכים עבור אלפא, כגון 0.001 ו-0.01. דהיינו הפרשים של סדר גודל. ובשביל הערכים השונים האלה של אלפא אני משרטט את (תטא)J כפונקציה של מספר האיטרציות, ואז אני בוחר את הערך של אלפא שנראה שגורם ל-(תטא)J לקטון במהירות. למעשה, מה שאני עושה הוא לא באמת הפרשים של פי עשרה. אז כאן יש לנו סולם ערכי אלפא של פי עשרה. מה שאני באמת עושה הוא לנסות את טווח הערכים הזה וכן הלאה, כאן אני מתחיל ב-0.001. ואז אני אגדיל את קצב הלמידה ל-0.003. ואז אני אגדיל את זה. זה שוב בערך הגדלה של פי 3, מ-0.003 ל-0.01. אז אלה, בערך, הם הערכים שאני מנסה איתם לרדת במדרון וכל ערך שאני מנסה הוא בערך פי שלשה גדול יותר מהערך הקודם. אז מה שאני עושה הוא לנסות מגוון של ערכים עד שאני מוצא ערך אחד שהוא כבר קטן מדי ובצד השני אחד שהוא גדול מדי. ואז אני מנסה לבחור את הערך הגדול ביותר האפשרי, או רק משהו קצת יותר קטן מהערך הסביר הגדול ביותר שמצאתי. וזה בדרך כלל נותן לי שיעור למידה טוב עבור הבעיה שלי. ואם גם אתם תעשו את זה, יש סיכוי טוב שתצליחו לבחור שיעור למידה טוב ליישום הירידה במדרון שלכם.