בסרטון הקודם דיברנו על ירידה סטוכסטית במדרון, וכיצד היא יכולה להיות הרבה יותר מהירה מאשר הירידה במדרון באצווה. בסרטון הזה, בואו נדבר על וריאציה אחרת ברעיונות האלה הנקראת ירידה במדרון במיני-אצווה שיכולה לפעמים לעבוד אפילו קצת יותר מהר מאשר ירידה סטוכסטית במדרון. לסיכום האלגוריתמים שדיברנו עליהם עד כה. בירידה במדרון באצווה אנחנו משתמשים בכל m הדוגמאות בכל צעד. בעוד שבירידה סטוכסטית במדרון אנו משתמשים בדוגמה אחת בכל צעד. והירידה במדרון במיני-אצווה היא איפשהו בין לבין. באופן ספציפי, עם האלגוריתם הזה אנחנו נשתמש בכל איטרציה ב-b דוגמאות, כאשר b הוא פרמטר שנקרא "גודל המיני-אצווה" ולכן הרעיון הוא שזה קצת בין הירידה במדרון באצווה ובין הירידה הסטוכסטית במדרון. זה בדיוק כמו ירידה במדרון באצווה, אלא שאנחנו נשתמש בגודל אצווה קטן בהרבה. בחירה אופיינית עבור הערך של b עשויה להיות 10, נניח, ובעצם הטווח הטיפוסי יכול להיות כל מספר מ-2 ועד 100. זה טווח טיפוסי למדי של ערכים עבור גודל המיני-אצווה. והרעיון הוא שבמקום להשתמש בדוגמה אחת בכל פעם או ב-m דוגמאות בכל פעם נשתמש ב-b דוגמאות בכל פעם. אז תנו לי רגע לכתוב את זה בצורה לא רשמית, אנחנו הולכים לקבל, נניח, b. ובדוגמה הזו, נניח b שווה 10. אז אנחנו הולכים לקחת את 10 הדוגמאות הבאות מסדרת האימון שלנו, זאת אומרת סט של דוגמאות xi, yi. ואם זה 10 דוגמאות אז האינדקסים יהיו עד (x(i+9),y(i+9, אז זה ביחד 10 דוגמאות ואז נבצע עדכון של ירידה במדרון באמצעות 10 הדוגמאות האלה. אז נקבל עדכון של עשירית α כפול הסכום מעל k מ-i עד i+9 של ((h(x(k פחות (y(k כפול x(k)j. אז בביטוי הזה אנחנו מסכמים את ביטויי הנגזרת על עשר הדוגמאות שלנו. המספר עשר, זהו גודל המיני-אצווה שלנו וה-i+9 שוב, המספר 9 נובע מהבחירה של הפרמטר b, ואחרי הצעד הזה אנחנו מגדילים את i ב-10, וממשיכים עם עשר הדוגמאות הבאות, ולאחר מכן ממשיכים להתקדם ככה. אז בואו עכשיו נכתוב את כל האלגוריתם במלואו. על מנת לפשט את האינדקסים עבור הביטויים כאן למעלה מימין, אני אניח שיש לנו מיני אצווה בגודל עשר וסדרת אימון בגודל של אלף, ולכן יש לנו לולאה שבה i שווה אחת, אחת-עשרה, 21 וכו' כי אנחנו צועדים בצעדים של 10 כי אנחנו מסתכלים על 10 דוגמאות בכל פעם. ובתוך זה אנחנו מבצעים סוג של ירידה במדרון ומשתמשים בעשר דוגמאות בכל פעם אז המספרים האלה 10 ו-i+9 הם תוצאה של בחירת המיני-אצווה שלנו להיות בגודל עשר. והלולאה החיצונית הזו מסתיימת ב-991 כי אם יש לנו 1000 דוגמאות אימונים אז אנחנו צריכים 100 איטרציות בגודל 10 כדי לעבור על כל קבוצת האימון. אז זוהי הירידה במדרון במיני-אצווה. יחסית לירידה במדרון באצווה, גם זה מאפשר לנו להתקדם הרבה יותר מהר. שוב בואו נדבר על הדוגמה שלנו, נתוני מפקד האוכלוסין של ארה"ב עם 300 מיליון דוגמאות הכשרה, אז מה שאנחנו אומרים הוא שאחרי שראינו רק את 10 הדוגמאות הראשונות אנחנו כבר יכולים להתחיל להתקדם בשיפור הפרמטרים θ, אנחנו לא צריכים לסרוק את כל סדרת האימון. אנחנו צריכים להסתכל רק על 10 הדוגמאות הראשונות, וזה מאפשר לנו להתקדם, ואז נוכל להסתכל על עשר הדוגמאות השניות ושוב לשנות קצת את הפרמטרים וכן הלאה. אז בגלל זה הירידה במדרון במיני-אצווה יכולה להיות יותר מהירה מאשר ירידה במדרון באצווה. כלומר, אפשר להתחיל ולהתקדם בשינוי הפרמטרים לאחר מבט בעשר דוגמאות בלבד במקום צורך לחכות עד שסרקנו כל אחת מ-300 מיליון דוגמאות האימון. מה לגבי ירידה במדרון במיני-אצווה לעומת הירידה הסטוכסטית במדרון. למה אנחנו רוצים להשתמש ב-b דוגמאות בכל פעם ולא רק בדוגמה אחת בכל פעם כמו הירידה הסטוכסטית במדרון? התשובה היא וקטוריזציה. בפרט, ירידה במדרון במיני-אצווה תהיה טובה יותר מהירידה הסטוכסטית במדרון רק אם יש לנו יישום וקטורי טוב. במקרה כזה, הסיכום על 10 דוגמאות יכול להתבצע בצורה וקטורית יותר מה שיאפשר לנו למקבל חלקית את החישוב על פני עשר הדוגמאות. במילים אחרות, בשימוש בווקטוריזציה מתאימה לחשב את הביטויים, אפשר לפעמים להשתמש בספריות אלגברה נומריות טובות שממקבלות את החישובים של הנגזרות על b דוגמאות, בעוד שכשמסתכלים רק על דוגמה אחת כל פעם עם ירידה סטוכסטית במדרון אז כשמסתכלים רק על דוגמה אחת כל פעם אין כל כך מה למקבל. או לפחות יש פחות אפשרות למקבל. חסרון אחד של ירידה במדרון במיני-אצווה הוא שיש עכשיו פרמטר נוסף b, הגודל של מיני-אצווה, שייתכן שיהיה צורך להתעסק איתו, וזה עשוי לקחת זמן. אבל כשיש יישום וקטורי טוב, זה יכול לפעמים לרוץ אפילו יותר מהר מאשר ירידה סטוכסטית במדרון. אז זה היה הדיון בירידה במדרון במיני-אצווה שהוא אלגוריתם שבמובן מסוים עושה משהו שהוא קצת בין מה שעושה ירידה סטוכסטית במדרון לבין מה שעושה הירידה במדרון באצווה. ואם תבחרו ערך סביר של b. אני בדרך כלל משתמש ב-b שווה 10, אבל ערכים אחרים, כל ערך בין נניח 2 לבין 100, יהיה נפוץ למדי. אז אנחנו בוחרים ערך טוב של b ואם נשתמש ביישום וקטורי טוב, לפעמים זה יכול להיות מהיר יותר הן מאשר ירידה סטוכסטית במדרון והן מאשר ירידה במדרון באצווה.