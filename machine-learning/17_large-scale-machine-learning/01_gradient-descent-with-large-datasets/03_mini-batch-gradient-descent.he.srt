1
00:00:00,000 --> 00:00:07,306
בסרטון הקודם דיברנו על ירידה סטוכסטית במדרון, וכיצד היא יכולה להיות הרבה יותר מהירה מאשר הירידה במדרון באצווה.

2
00:00:07,306 --> 00:00:12,866
בסרטון הזה, בואו נדבר על וריאציה אחרת ברעיונות האלה הנקראת ירידה במדרון במיני-אצווה

3
00:00:12,866 --> 00:00:16,906
שיכולה לפעמים לעבוד אפילו קצת יותר מהר מאשר ירידה סטוכסטית במדרון.

4
00:00:16,906 --> 00:00:22,046
לסיכום האלגוריתמים שדיברנו עליהם עד כה.

5
00:00:22,046 --> 00:00:26,619
בירידה במדרון באצווה אנחנו משתמשים בכל m הדוגמאות בכל צעד.

6
00:00:26,619 --> 00:00:31,792
בעוד שבירידה סטוכסטית במדרון אנו משתמשים בדוגמה אחת בכל צעד.

7
00:00:31,792 --> 00:00:36,120
והירידה במדרון במיני-אצווה היא איפשהו בין לבין.

8
00:00:36,120 --> 00:00:46,559
באופן ספציפי, עם האלגוריתם הזה אנחנו נשתמש בכל איטרציה ב-b דוגמאות, כאשר b הוא פרמטר שנקרא "גודל המיני-אצווה"

9
00:00:46,559 --> 00:00:52,688
ולכן הרעיון הוא שזה קצת בין הירידה במדרון באצווה ובין הירידה הסטוכסטית במדרון.

10
00:00:52,688 --> 00:00:57,488
זה בדיוק כמו ירידה במדרון באצווה, אלא שאנחנו נשתמש בגודל אצווה קטן בהרבה.

11
00:00:57,488 --> 00:01:08,672
בחירה אופיינית עבור הערך של b עשויה להיות 10, נניח, ובעצם הטווח הטיפוסי יכול להיות כל מספר מ-2 ועד 100.

12
00:01:08,672 --> 00:01:13,668
זה טווח טיפוסי למדי של ערכים עבור גודל המיני-אצווה.

13
00:01:13,668 --> 00:01:21,153
והרעיון הוא שבמקום להשתמש בדוגמה אחת בכל פעם או ב-m דוגמאות בכל פעם נשתמש ב-b דוגמאות בכל פעם.

14
00:01:21,153 --> 00:01:28,833
אז תנו לי רגע לכתוב את זה בצורה לא רשמית, אנחנו הולכים לקבל, נניח, b. ובדוגמה הזו, נניח b שווה 10.

15
00:01:28,833 --> 00:01:37,782
אז אנחנו הולכים לקחת את 10 הדוגמאות הבאות מסדרת האימון שלנו, זאת אומרת סט של דוגמאות xi, yi.

16
00:01:37,782 --> 00:01:46,114
ואם זה 10 דוגמאות אז האינדקסים יהיו עד (x(i+9),y(i+9,

17
00:01:46,114 --> 00:01:57,794
אז זה ביחד 10 דוגמאות ואז נבצע עדכון של ירידה במדרון באמצעות 10 הדוגמאות האלה.

18
00:01:57,794 --> 00:02:19,012
אז נקבל עדכון של עשירית α כפול הסכום מעל k מ-i עד i+9 של ((h(x(k פחות (y(k כפול x(k)j.

19
00:02:19,012 --> 00:02:27,213
אז בביטוי הזה אנחנו מסכמים את ביטויי הנגזרת על עשר הדוגמאות שלנו.

20
00:02:27,229 --> 00:02:32,370
המספר עשר, זהו גודל המיני-אצווה שלנו וה-i+9 שוב,

21
00:02:32,370 --> 00:02:39,384
המספר 9 נובע מהבחירה של הפרמטר b, ואחרי הצעד הזה אנחנו מגדילים

22
00:02:39,384 --> 00:02:46,755
את i ב-10, וממשיכים עם עשר הדוגמאות הבאות, ולאחר מכן ממשיכים להתקדם ככה.

23
00:02:46,755 --> 00:02:50,584
אז בואו עכשיו נכתוב את כל האלגוריתם במלואו.

24
00:02:50,584 --> 00:02:55,231
על מנת לפשט את האינדקסים עבור הביטויים כאן למעלה מימין,

25
00:02:55,231 --> 00:02:59,843
אני אניח שיש לנו מיני אצווה בגודל עשר וסדרת אימון בגודל של אלף, 

26
00:02:59,843 --> 00:03:05,045
ולכן יש לנו לולאה שבה i שווה אחת, אחת-עשרה, 21 וכו' כי אנחנו צועדים

27
00:03:05,045 --> 00:03:07,926
בצעדים של 10 כי אנחנו מסתכלים על 10 דוגמאות בכל פעם.

28
00:03:07,926 --> 00:03:13,648
ובתוך זה אנחנו מבצעים סוג של ירידה במדרון ומשתמשים בעשר דוגמאות בכל פעם

29
00:03:13,648 --> 00:03:21,566
אז המספרים האלה 10 ו-i+9 הם תוצאה של בחירת המיני-אצווה שלנו להיות בגודל עשר.

30
00:03:21,566 --> 00:03:27,435
והלולאה החיצונית הזו מסתיימת ב-991 כי

31
00:03:27,435 --> 00:03:34,457
אם יש לנו 1000 דוגמאות אימונים אז אנחנו צריכים 100 איטרציות בגודל 10 כדי לעבור על כל קבוצת האימון.

32
00:03:34,457 --> 00:03:37,729
אז זוהי הירידה במדרון במיני-אצווה.

33
00:03:37,729 --> 00:03:43,219
יחסית לירידה במדרון באצווה, גם זה מאפשר לנו להתקדם הרבה יותר מהר.

34
00:03:43,219 --> 00:03:49,487
שוב בואו נדבר על הדוגמה שלנו, נתוני מפקד האוכלוסין של ארה"ב עם 300 מיליון דוגמאות הכשרה,

35
00:03:49,487 --> 00:03:55,621
אז מה שאנחנו אומרים הוא שאחרי שראינו רק את 10 הדוגמאות הראשונות אנחנו כבר יכולים להתחיל להתקדם

36
00:03:55,621 --> 00:04:00,873
בשיפור הפרמטרים θ, אנחנו לא צריכים לסרוק את כל סדרת האימון.

37
00:04:00,873 --> 00:04:05,377
אנחנו צריכים להסתכל רק על 10 הדוגמאות הראשונות, וזה מאפשר לנו להתקדם,

38
00:04:05,377 --> 00:04:09,289
ואז נוכל להסתכל על עשר הדוגמאות השניות ושוב לשנות קצת את הפרמטרים וכן הלאה.

39
00:04:09,289 --> 00:04:14,186
אז בגלל זה הירידה במדרון במיני-אצווה יכולה להיות יותר מהירה מאשר ירידה במדרון באצווה.

40
00:04:14,186 --> 00:04:19,578
כלומר, אפשר להתחיל ולהתקדם בשינוי הפרמטרים לאחר מבט בעשר דוגמאות בלבד

41
00:04:19,578 --> 00:04:24,836
במקום צורך לחכות עד שסרקנו כל אחת מ-300 מיליון דוגמאות האימון.

42
00:04:24,836 --> 00:04:29,699
מה לגבי ירידה במדרון במיני-אצווה לעומת הירידה הסטוכסטית במדרון.

43
00:04:29,699 --> 00:04:38,237
למה אנחנו רוצים להשתמש ב-b דוגמאות בכל פעם ולא רק בדוגמה אחת בכל פעם כמו הירידה הסטוכסטית במדרון?

44
00:04:38,237 --> 00:04:42,044
התשובה היא וקטוריזציה.

45
00:04:42,044 --> 00:04:47,450
בפרט, ירידה במדרון במיני-אצווה תהיה טובה יותר מהירידה הסטוכסטית במדרון

46
00:04:47,450 --> 00:04:50,817
רק אם יש לנו יישום וקטורי טוב.

47
00:04:50,817 --> 00:04:58,571
במקרה כזה, הסיכום על 10 דוגמאות יכול להתבצע בצורה וקטורית יותר

48
00:04:58,571 --> 00:05:05,376
מה שיאפשר לנו למקבל חלקית את החישוב על פני עשר הדוגמאות.

49
00:05:05,376 --> 00:05:09,953
במילים אחרות, בשימוש בווקטוריזציה מתאימה לחשב את הביטויים,

50
00:05:09,953 --> 00:05:18,565
אפשר לפעמים להשתמש בספריות אלגברה נומריות טובות שממקבלות את החישובים של הנגזרות על b דוגמאות,

51
00:05:18,565 --> 00:05:24,152
בעוד שכשמסתכלים רק על דוגמה אחת כל פעם עם ירידה סטוכסטית במדרון

52
00:05:24,152 --> 00:05:27,456
אז כשמסתכלים רק על דוגמה אחת כל פעם אין כל כך מה למקבל.

53
00:05:27,456 --> 00:05:29,824
או לפחות יש פחות אפשרות למקבל.

54
00:05:29,824 --> 00:05:34,866
חסרון אחד של ירידה במדרון במיני-אצווה הוא שיש עכשיו פרמטר נוסף b,

55
00:05:34,866 --> 00:05:39,006
הגודל של מיני-אצווה, שייתכן שיהיה צורך להתעסק איתו, וזה עשוי לקחת זמן.

56
00:05:39,006 --> 00:05:45,611
אבל כשיש יישום וקטורי טוב, זה יכול לפעמים לרוץ אפילו יותר מהר מאשר ירידה סטוכסטית במדרון.

57
00:05:45,611 --> 00:05:52,937
אז זה היה הדיון בירידה במדרון במיני-אצווה שהוא אלגוריתם שבמובן מסוים עושה משהו

58
00:05:52,937 --> 00:05:57,697
שהוא קצת בין מה שעושה ירידה סטוכסטית במדרון לבין מה שעושה הירידה במדרון באצווה.

59
00:05:57,697 --> 00:06:02,626
ואם תבחרו ערך סביר של b. אני בדרך כלל משתמש ב-b שווה 10, אבל

60
00:06:02,626 --> 00:06:07,343
ערכים אחרים, כל ערך בין נניח 2 לבין 100, יהיה נפוץ למדי.

61
00:06:07,343 --> 00:06:11,917
אז אנחנו בוחרים ערך טוב של b ואם נשתמש ביישום וקטורי טוב,

62
00:06:11,917 --> 00:06:15,917
לפעמים זה יכול להיות מהיר יותר הן מאשר ירידה סטוכסטית במדרון והן מאשר ירידה במדרון באצווה.