בבעיית קיבוץ, או אשכולות ניתנת לנו מערכת נתונים ללא תוויות ואנחנו רוצים שהאלגוריתם יקבץ את הנתונים באופן אוטומטי לתת-קבוצות קוהרנטיות או אשכולות קוהרנטיים עבורנו. אלגוריתם K-means או K-מרכזים הוא ללא ספק הפופולרי ביותר, אלגוריתם האשכולות הנפוץ ביותר, ובוידאו הזה אני רוצה לספר לכם מהו אלגוריתם K-מרכזים ואיך הוא עובד. אלגוריתם K-מרכזים ניתן לתיאור בצורה הטובה ביותר בעזרת תמונות. נניח שאני רוצה לקחת נתונים ללא תוויות כמו אלה שמוצגים כאן, ואני רוצה לקבץ את הנתונים לשני אשכולות. כדי להפעיל את אלגוריתם קיבוץ האשכולות K-מרכזים, הנה מה שאני אעשה. הצעד הראשון הוא לבחור באקראי שתי נקודות, הנקראות "מרכזים" או "סנטרואידים" של האשכול. שני הצלבים האלה כאן נקראים מרכזי אשכולות ויש לי שניים כאלה כי אני רוצה לקבץ את הנתונים לשני אשכולות. K-מרכזים הוא אלגוריתם איטרטיבי והוא עושה שני דברים. הראשון הוא צעד הקצאת האשכולות, והשני הוא צעד העברת המרכזים. אני אסביר לכם מה פירושם של הדברים האלה. הראשון בשני השלבים בלולאה של K-מרכזים הוא צעד הקצאת האשכולות. מה שזה אומר הוא כך, האלגוריתם עובר על כל הדוגמאות, כל הנקודות הירוקות שמוצגות כאן, ולפי אם הנקודה קרובה יותר למרכז האשכול האדום או למרכז האשכול הכחול, הוא יקצה כל אחת מהנקודות לאחד משני המרכזים. מה שזה אומר במילים אחרות הוא לעבור על כל הנקודות ולצבוע אותן או באדום או בכחול, לפי אם הן קרובות יותר למרכז האשכול האדום או למרכז האשכול הכחול, כמו שעשיתי בדיאגרמה כאן. אז זה היה צעד הקצאת האשכולות. החלק השני של K-מרכזים, בלולאה של K-מרכזים, הוא צעד הזזת המרכזים, מה שעושים הוא לקחת את שני מרכזי האשכולות, כלומר, את הצלב האדום ואת הצלב הכחול, ולהעביר אותם לממוצע של הנקודות בצבע זהה. אז מה שעושים הוא להסתכל על כל הנקודות האדומות ולחשב את הממוצע, פשוט את הממוצע של המיקום של כל הנקודות האדומות, ולשם להזיז את המרכז של האשכול האדום. ואותו דבר עבור האשכול הכחול, להסתכל על כל הנקודות הכחולות ולחשב את הממוצע שלהם, ואז להזיז את מרכז האשכול הכחול לשם. אז בואו ונעשה את זה עכשיו. אנחנו נעביר את מרכזי האשכולות, ועכשיו העברתי אותם אל הממוצעים שלהם. האדום נע כך, והכחול נע כך. והאדום נע כך. ואז אנחנו חוזרים לעוד צעד של הקצאת אשכולות, אז אנחנו שוב מסתכלים על כל הדוגמאות הלא מתויגות שלנו, ולפי האם הן קרובות יותר למרכז האשכול האדום או הכחול, אנחנו נצבע אותם או באדום או בכחול . זאת אומרת, להקצות כל נקודה לאחד משני המרכזים, אז תרשו לי לעשות את זה עכשיו. אז הצבעים של כמה נקודות פשוט השתנו. ועכשיו אני הולך לעשות עוד צעד של הזזת מרכזים. אני אחשב את הממוצע של כל הנקודות הכחולות, ואת הממוצע של כל הנקודות האדומות ולהעביר את מרכזי האשכולות שלנו ככה, אז בואו נעשה את זה שוב. הרשו לי לעשות עוד צעד של הקצאת אשכולות. זאת אומרת לצבוע כל נקודה באדום או בכחול לפי המרכז אליו היא קרובה יותר, ולאחר מכן לעשות שוב צעד של הזזת מרכזים, וזהו, סיימנו. ולמעשה אם נמשיך להריץ עוד איטרציות של K-מרכזים האשכולות לא ישתנו עוד והצבעים של הנקודות לא ישתנו יותר. אז זהו, עכשיו K-מרכזים התכנס והוא עשה עבודה די טובה למצוא שני אשכולות בנתונים האלה. בואו נכתוב את אלגוריתם K-מרכזים בצורה יותר פורמלית. אלגוריתם K-מרכזים מקבל שני פרמטרי קלט. האחד הוא הפרמטר K, שהוא מספר האשכולות שברצונך למצוא בנתונים. אני אסביר מאוחר יותר איך אנחנו יכולים להחליט איך לבחור את K, אבל עכשיו נניח שאנחנו החלטנו שאנחנו רוצים מספר מסוים של אשכולות ואנחנו הולכים לומר לאלגוריתם כמה אשכולות אנחנו חושבים שיש במערך הנתונים. והפרמטר השני שאותו מקבל K-מרכזים הוא סדרת נתונים לא מתויגים, קבוצה של x-ים ומאחר וזה אלגוריתם של למידה לא מושגחת, אין לנו יותר תוויות y. ולגבי הלמידה הלא מושגחת של K-מרכזים אני אשתמש במוסכמה ש-(x(i הוא וקטור במרחב Rn. ולכן דוגמאות האימונים שלנו עכשיו תהיינה וקטורים n-ממדיים ולא (n+1)-ממדיים. הנה מה שעושה אלגוריתם K-מרכזים. הצעד הראשון הוא לאתחל באקראי k מרכזי-אשכול שנקרא להם מיו - μ1, μ2, וכן הלאה עד μK. אז בתרשים שהיה לנו קודם, מרכזי האשכולות התאימו למיקום הצלב האדום ומיקום הצלב הכחול. היו לנו שני מרכזי אשכולות, אולי הצלב האדום היה μ1 והצלב הכחול היה μ2 ובמצב הכללי יותר יהיו לנו k מרכזי אשכול ולא דווקא 2. ואז הלולאה הפנימית של K-מרכזים עושה את הדברים הבאים, אנחנו מריצים בלולאה שוב ושוב את הדברים הבאים. ראשית עבור כל אחת מדוגמאות האימונים שלנו, אנחנו נגדיר משתנה (c(i שהוא האינדקס בין 1 ו-K של מרכז האשכול הקרוב ביותר ל-(x(i. זה היה הצעד של הקצאת האשכולות, שבו צבענו כל אחת מהדוגמאות בצבע אדום או כחול, לפי איזה מרכז אשכול היה הקרוב ביותר. (c(i הוא מספר בין 1 ל-K. שאומר האם הדוגמא קרובה יותר לצלב האדום או לצלב הכחול, ועוד דרך לכתוב את זה היא זו, כדי לחשב את (c(i, אנחנו ניקח את הדוגמה הi-ית, (x(i ונמדוד את המרחק ממנה לכל אחד ממרכזי האשכולות שלנו, הנקודות μ k קטנה, שימו לב ש-K גדולה היא מספר המרכזים הכולל ואנחנו משתמשים ב-k קטנה כאן בתור האינדקס של המרכזים השונים. אז (c(i יהיה, אנחנו נמזער על ערכי k ונמצא את הערך של k שממזער את המרחק בין (x(i ומרכז האשכול ה-k, אתם מבינים, הערך של k שממזער את המרחק הזה, זה מה שיקבע את (c(i. אז הנה עוד דרך לכתוב את (c(i. אם אני כותב את הנורמה של וקטור ההפרש בין (x(i ובין μk, אז זה המרחק בין דוגמת האימון ה-i-ית (x(i ובין מרכז האשכול μk, ה-k הזה כאן הוא k קטן. אז כאמור K באותיות גדולות מציין את המספר הכולל של מרכזי אשכול, ו-k קטן הוא מספר בין 1 לבין K. אני פשוט משתמש ב-k קטנה כאינדקס לתוך מערך מרכזי האשכול. זה כאן זו k קטנה. אז זה המרחק בין דוגמה לבין מרכז של אשכול, ועכשיו מה שנעשה הוא למצוא את הערך של k, הערך של k שממזער את זה, אז הערך של k שממזער את הדבר הזה, הנורמה הזו, אותו נגדיר כ-(c(i, ולפי הקונבנציה כתבתי את המרחק בין (x(i ומרכז האשכול, הקונבנציה היא שלמעשה נוטים לכתוב את זה כמרחק בריבוע. אז אפשר לחשוב על (c(i כבחירת מרכז האשכול עם המרחק בריבוע הכי קטן לדוגמת האימון (x(i. אבל כמובן מינימום המרחק בריבוע ומינימום המרחק צריכים לתת לך את אותו ערך של (c(i, אבל אנחנו בדרך כלל נכתוב את המרחק בריבוע לפי המוסכמה בה משתמשים ב-K-מרכזים. אז זה היה הצעד של הקצאת אשכולות. הצעד השני בלולאה של K-מרכזים הוא צעד הזזת המרכזים. ומה שזה עושה לכל אחד ממרכזי האשכולות הוא שבלולאה עבור k שווה 1 עד K, הוא קובע את μk שווה לממוצע של הנקודות שהוקצו לאשכול k. אז כדוגמה מוחשית, נניח שאחד ממרכזי האשכולות שלי, נניח מרכז אשכול מספר שתיים, יש בו הדוגמאות, 1, 5, 6 ו-10 שהוקצו לו. ומה שזה אומר, זה בעצם אומר ש-(1)c שווה 2, (5)c שווה 2, (6)c שווה 2, (10)c שווה 2, ברור? אם זה מה שקיבלנו מהצעד של הקצאת אשכולות, אז זה אומר שדוגמאות 1,5,6 ו-10 הוקצו למרכז האשכול מספר שתיים. אז בשלב הזה של הזזת המרכזים, מה שאנחנו עושים הוא פשוט לחשב את הממוצע של ארבע הנקודות האלה. x1 פלוס x5 פלוס x6 פלוס x10. ועכשיו כדי לחשב את הממוצע של ארבע הנקודות שהוקצו למרכז האשכול הזה, פשוט לחלק את התוצאה בארבע. μ2 הוא וקטור n-ממדי, כי כל אחת מהדוגמאות האלה x1, x5, x6, x10 כל אחת מהם היא וקטור n-ממדי, וכשאני מחבר אותם ומחלק בארבע כי יש לי ארבע נקודות שהוקצו למרכז האשכול הזה, שזה מה שאני עושה בצעד הזזת המרכזים, אני מקבל ערך μ2 חדש עבור מרכז האשכול מספר שתיים. ולזה יש ההשפעה של העברת μ2 לממוצע של ארבע הנקודות הרשומות כאן. דבר אחד ששואלים אותי לפעמים הוא, אמרנו כאן שנציב ב-μk את הממוצע של הנקודות שהוקצו לאשכול. אבל מה אם יש מרכז אשכול ללא נקודות, עם אפס נקודות שהוקצו לו? במקרה זה הדבר המקובל ביותר לעשות הוא פשוט לחסל את האשכול ומרכז האשכול הזה. וכשאנחנו עושים את זה, אנחנו נשארים בעצם עם K-1 אשכולות במקום K אשכולות. לפעמים אם אנחנו באמת צריכים K אשכולות, אז דבר אחר שאפשר לעשות אם יש לנו מרכז אשכול עם אפס נקודות שהוקצו לו זה להגריל פשוט מרכז אשכול חדש באופן אקראי, אבל זה יותר נפוץ פשוט לחסל אשכול אם איפשהו במהלך K-מרכזים הגענו למרכז אשכול ללא כל נקודות שהוקצו לו, וזה יכול לקרות, אבל בפועל זה לא קורה לעתים קרובות. אז זהו אלגוריתם K-מרכזים. לפני שנסיים את הוידאו הזה אני רק רוצה לספר לכם על יישום שכיח אחד של K-מרכזים והוא לפתור בעיות עם אשכולות שאינם מופרדים היטב. אסביר את כוונתי. עד כה חשבנו על K-מרכזים ויישמנו אותו על ערכות נתונים כמו זו שמוצגת כאן שבה יש לנו שלושה אשכולות מופרדים היטב, ואנחנו רוצים אלגוריתם כדי למצוא את 3 האשכולות עבורנו. אבל מתברר שלעתים קרובות מריצים את K-מרכזים גם על ערכות נתונים שנראות ככה שבהם אין בעצם כמה אשכולות מופרדים היטב. הנה יישום לדוגמה, לגדלים של חולצות טי. נניח שאתה יצרן חולצות טריקו ומה שעשית הוא ללכת לאוכלוסייה שלה אתה רוצה למכור חולצות, ואספת מספר דוגמאות של גובה ומשקל של האנשים האלה, אז אני מניח שהגובה והמשקל נוטים להיות מתואמים באופן חיובי אז אולי אתה מקבל סט נתונים כאלה, עם דוגמה או קבוצה של דוגמאות של גבהים שונים ומשקלים שונים של אנשים. נניח שאתה רוצה להחליט על הגדלים של החולצות שלך. או נניח שאתה רוצה לעצב ולמכור חולצות בשלושה גדלים, קטן, בינוני וגדול. אז מה הגודל שאתה צריך לעשות את החולצה הקטנה שלך? מה הגודל שאתה צריך לעשות את החולצה הבינונית שלך? ומה הגודל שאתה צריך לעשות את החולצה הגדולה שלך? אחת הדרכים לעשות זאת היא להפעיל את אלגוריתם K-מרכזים על סט הנתונים ... מימין, ואולי מה ש-K-מרכזים יעשה הוא לקבץ את כל הנקודות האלה לאשכול אחד ולקבץ את אלה לאשכול שני ולקבץ את כל הנקודות הללו לאשכול שלישי. אז, למרות שהנתונים מלכתחילה לא נראו כאילו הם יתקבצו יפה ל-3 אשכולות מופרדים היטב, K-מרכזים יצליח בעצם להפריד את הנתונים למספר אשכולות בשבילך. ואז מה שאפשר לעשות הוא להסתכל על אוכלוסיית האנשים הראשונה ולהביט בהם, להסתכל על הגובה והמשקל, ולנסות לעצב חולצת טריקו קטנה שתתאים לאוכלוסייה הראשונה הזו של אנשים היטב, ואז לעצב חולצה בינונית ולעצב חולצה גדולה. וזה למעשה מין פילוח שוק שבו אתה משתמש ב-K-מרכזים כדי להפריד את השוק שלך ל-3 מגזרים שונים. וכך אתה יכול לעצב מוצר בנפרד שהוא חולצה קטנה, בינונית וגדולה, המנסות להתאים לצרכים של כל אחת מ-3 תת-הקבוצות הנפרדות היטב. אז זהו אלגוריתם K-מרכזים. ועכשיו אתה כבר אמור לדעת איך ליישם את אלגוריתם K-מרכזים ובערך לגרום לו לעבוד על כמה סוגי בעיות. אבל בסרטונים הבאים מה שאני רוצה לעשות הוא באמת לצלול יותר לעומק של הפרטים של K-מרכזים ולדבר קצת על איך באמת לגרום לו לעבוד ממש טוב.