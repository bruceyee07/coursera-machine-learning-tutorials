1
00:00:00,170 --> 00:00:01,340
בסרטון הזה, אני רוצה

2
00:00:01,450 --> 00:00:03,230
לדבר על איך לאתחל

3
00:00:04,580 --> 00:00:05,970
את K-מרכזים ודבר יותר חשוב,

4
00:00:06,170 --> 00:00:07,240
זה גם יוביל לדיון

5
00:00:07,550 --> 00:00:10,210
איך לגרום לK-מרכזים להימנע מאופטימום מקומי.

6
00:00:10,740 --> 00:00:12,390
הנה אלגוריתם האישכול K-מרכזים

7
00:00:12,950 --> 00:00:14,420
עליו דיברנו קודם.

8
00:00:15,760 --> 00:00:16,760
צעד אחד שאף פעם לא ממש

9
00:00:17,260 --> 00:00:18,350
דיברנו עליו הוא השלב הזה

10
00:00:18,820 --> 00:00:21,560
של איתחול אקראי של מרכזי אשכולות.

11
00:00:22,390 --> 00:00:23,490
ישנן מספר דרכים שונות

12
00:00:23,710 --> 00:00:25,350
שניתן לחשוב עליהן של איך

13
00:00:25,960 --> 00:00:26,860
לאתחל באקראי מרכזי אשכולות.

14
00:00:27,510 --> 00:00:28,580
אבל מתברר

15
00:00:28,720 --> 00:00:29,820
שיש שיטה אחת

16
00:00:30,050 --> 00:00:31,700
שהיא הרבה יותר מומלצת מאשר

17
00:00:32,080 --> 00:00:33,830
רוב האפשרויות האחרות שאפשר להעלות על הדעת.

18
00:00:34,400 --> 00:00:35,250
אז תרשו לי לספר לכם

19
00:00:35,590 --> 00:00:38,160
על האפשרות הזו כי נראה שהיא בדרך כלל עובדת הכי טוב.

20
00:00:39,550 --> 00:00:42,210
כך אני בדרך כלל מאתחל את מרכזי האשכולות שלי.

21
00:00:43,300 --> 00:00:44,710
כשמריצים את K-מרכזים, חייבים

22
00:00:45,140 --> 00:00:47,160
להגדיר את מספר מרכזי האשכולות K,

23
00:00:47,430 --> 00:00:48,520
להיות קטן

24
00:00:48,590 --> 00:00:50,090
ממספר דוגמאות ההכשרה m.

25
00:00:50,170 --> 00:00:51,210
זה יהיה ממש מוזר להפעיל

26
00:00:51,430 --> 00:00:52,600
את K-מרכזים כשמספר

27
00:00:52,870 --> 00:00:54,270
מרכזי האשכולות

28
00:00:54,520 --> 00:00:55,790
גדול או שווה למספר הדוגמאות, נכון?

29
00:00:58,080 --> 00:00:59,010
אז הדרך

30
00:00:59,150 --> 00:01:00,510
שבה אני בדרך כלל מאתחל את K-מרכזים היא,

31
00:01:00,770 --> 00:01:02,510
אני בוחר באקראי K

32
00:01:02,990 --> 00:01:05,170
דוגמאות אימון. ואז

33
00:01:05,610 --> 00:01:06,730
אני מגדיר את μ1

34
00:01:06,850 --> 00:01:09,320
עד μK להיות שווים ל-K הדוגמאות האלה.

35
00:01:10,610 --> 00:01:11,470
תנו לי להראות לכם דוגמה קונקרטית.

36
00:01:12,560 --> 00:01:14,190
נניח ש-K

37
00:01:14,470 --> 00:01:16,600
שווה 2

38
00:01:17,070 --> 00:01:19,520
ושבדוגמה הזו מימין אני רוצה למצוא שני אשכולות.

39
00:01:21,170 --> 00:01:22,060
אז מה שאעשה

40
00:01:22,200 --> 00:01:23,350
כדי לאתחל

41
00:01:23,770 --> 00:01:25,340
את מרכזי האשכולות הוא

42
00:01:25,470 --> 00:01:27,320
לבחור כמה דוגמאות באופן אקראי.

43
00:01:27,760 --> 00:01:28,960
ונניח שאני בוחר

44
00:01:29,230 --> 00:01:31,060
את זו ואת זו.

45
00:01:31,230 --> 00:01:32,320
והאופן שבו אני

46
00:01:32,380 --> 00:01:34,100
מאתחל את מרכזי האשכולות

47
00:01:34,310 --> 00:01:35,190
הוא כזה, אני פשוט מאתחל

48
00:01:36,200 --> 00:01:38,930
את מרכזי האשכול להיות ממש על הדוגמאות האלה.

49
00:01:39,530 --> 00:01:40,430
אז זה מרכז האשכול הראשון

50
00:01:41,410 --> 00:01:43,230
וזה מרכז האשכול השני,

51
00:01:43,390 --> 00:01:45,770
וזו שיטה אחת לאתחול אקראי של K-מרכזים.

52
00:01:48,540 --> 00:01:50,480
הבחירה שלי נראית כבחירה טובה במיוחד.

53
00:01:50,890 --> 00:01:51,810
לפעמים יש לי פחות מזל

54
00:01:52,040 --> 00:01:53,370
ואולי יוצא לי

55
00:01:53,510 --> 00:01:54,900
לבחור את זה בתור

56
00:01:55,330 --> 00:01:58,420
הראשון באקראי, ואת זה בתור השני.

57
00:01:59,050 --> 00:02:01,380
וכזכור אני בוחר שתי דוגמאות כי K שווה 2.

58
00:02:01,590 --> 00:02:03,590
אז בחרנו באופן אקראי שתי

59
00:02:03,890 --> 00:02:05,030
דוגמאות אימון ואם

60
00:02:05,100 --> 00:02:06,660
בחרתי את שתי אלה אז

61
00:02:06,830 --> 00:02:08,040
קיבלנו את

62
00:02:08,250 --> 00:02:09,200
המרכז הראשוני של האשכול הראשון

63
00:02:09,510 --> 00:02:10,980
כאן ואת המיקום הראשוני

64
00:02:11,140 --> 00:02:13,560
של המרכז השני כאן.

65
00:02:14,150 --> 00:02:15,690
אז, ככה אפשר לאתחל

66
00:02:16,070 --> 00:02:17,560
באופן אקראי מרכזי אשכולות.

67
00:02:17,810 --> 00:02:19,670
אז בעת האתחול,

68
00:02:19,860 --> 00:02:21,110
מרכז האשכול הראשון μ1

69
00:02:21,270 --> 00:02:23,350
יהיה שווה ל-(x(i עבור

70
00:02:23,520 --> 00:02:25,870
ערך אקראי כלשהו של i

71
00:02:26,980 --> 00:02:27,660
ו-μ2 יהיה שווה ל-(x(j

72
00:02:29,240 --> 00:02:30,980
עבור איזשהו ערך אקראי שונה

73
00:02:31,380 --> 00:02:32,830
של j וכן הלאה,

74
00:02:32,910 --> 00:02:34,440
אם יש לנו יותר אשכולות ויותר מרכזים.

75
00:02:35,680 --> 00:02:37,540
והערת אגב,

76
00:02:38,110 --> 00:02:39,240
אני חייב לומר

77
00:02:39,320 --> 00:02:40,840
שבוידאו הקודם שבו

78
00:02:41,150 --> 00:02:43,030
איירנו את K-מרכזים עם האנימציה,

79
00:02:44,310 --> 00:02:45,070
בקבוצה ההיא של שקופיות,

80
00:02:45,900 --> 00:02:46,890
רק לצורך המחשה,

81
00:02:47,590 --> 00:02:48,690
אני בעצם השתמשתי

82
00:02:49,240 --> 00:02:51,750
בשיטה שונה של אתחול מרכזי האשכולות.

83
00:02:52,460 --> 00:02:53,790
אבל השיטה המתוארת

84
00:02:53,900 --> 00:02:55,940
בשקופית הזו, זו באמת הדרך המומלצת.

85
00:02:56,430 --> 00:02:58,850
וזו הדרך שבה אתם מן הסתם צריכים להשתמש, כאשר אתם מממשים K-מרכזים.

86
00:03:00,090 --> 00:03:01,560
אז כפי אולי ניתן להבין

87
00:03:02,070 --> 00:03:04,090
משתי הדוגמאות המצוירות כאן מימין,

88
00:03:04,930 --> 00:03:06,050
אתם בעצם יכולים לנחש שK-מרכזים

89
00:03:06,530 --> 00:03:08,130
יכול להתכנס

90
00:03:08,260 --> 00:03:10,150
לפתרונות שונים בתלות

91
00:03:10,860 --> 00:03:12,470
באיתחול האשכולות,

92
00:03:12,990 --> 00:03:15,170
זאת אומרת שבהתאם לאתחול האקראי,

93
00:03:16,280 --> 00:03:18,180
K-מרכזים יכול להגיע לפתרונות שונים.

94
00:03:18,930 --> 00:03:22,560
ובפרט, K-מרכזים בעצם עלול להגיע לאופטימום מקומי.

95
00:03:23,650 --> 00:03:24,920
אם אתה מקבל ערכת נתונים כזו,

96
00:03:25,400 --> 00:03:26,370
אז זה נראה כאילו

97
00:03:26,660 --> 00:03:28,340
יש כאן שלושה אשכולות, אז

98
00:03:28,780 --> 00:03:30,090
אם אתה מפעיל את K-מרכזים

99
00:03:30,150 --> 00:03:31,380
ואם הוא מתכנס

100
00:03:31,820 --> 00:03:32,910
למינימום מקומי טוב

101
00:03:33,040 --> 00:03:35,830
שיכול גם להיות המינימום הגלובלי, אתה עשוי לקבל אישכול כזה.

102
00:03:36,820 --> 00:03:38,440
אבל אם היה לך

103
00:03:39,110 --> 00:03:41,630
איתחול אקראי רע במיוחד, K-מרכזים

104
00:03:42,100 --> 00:03:43,660
יכול גם להיתקע

105
00:03:44,180 --> 00:03:45,740
במינימום מקומי כלשהו.

106
00:03:45,850 --> 00:03:47,330
אז בדוגמה הזו בצד שמאל

107
00:03:47,620 --> 00:03:48,700
זה נראה כאילו האשכול הכחול לכד

108
00:03:49,470 --> 00:03:51,700
הרבה נקודות משמאל ואילו האשכולות האדום והירוק

109
00:03:52,050 --> 00:03:54,810
לכדו מספר קטן יחסית של נקודות כל אחד.

110
00:03:55,020 --> 00:03:56,480
אז זה מתאים

111
00:03:56,640 --> 00:03:58,470
למינימום מקומי גרוע, משום

112
00:03:58,530 --> 00:04:00,060
שהוא לקח את שני

113
00:04:00,470 --> 00:04:01,560
האשכולות הללו ומיזג אותם

114
00:04:01,780 --> 00:04:03,440
לאחד, ויתרה מזאת,

115
00:04:04,150 --> 00:04:06,070
פיצל את האשכול השני

116
00:04:06,580 --> 00:04:09,170
לשני תת-אשכולות נפרדים,

117
00:04:09,380 --> 00:04:10,270
והוא גם

118
00:04:10,720 --> 00:04:12,280
פיצל את האשכול השלישי

119
00:04:12,540 --> 00:04:14,220
לשני

120
00:04:14,460 --> 00:04:16,630
אשכולות משנה נפרדים כמו זה,

121
00:04:16,760 --> 00:04:17,880
אז שתי

122
00:04:18,000 --> 00:04:18,970
הדוגמאות האלה מימין למטה

123
00:04:19,220 --> 00:04:20,890
מתאימות למינימום מקומיים שונים

124
00:04:21,250 --> 00:04:22,440
של K-מרכזים ולמעשה,

125
00:04:22,890 --> 00:04:24,440
בדוגמה הימנית,

126
00:04:25,070 --> 00:04:26,150
האשכול האדום

127
00:04:26,550 --> 00:04:27,870
בעצם לכד רק דוגמה אחת.

128
00:04:28,380 --> 00:04:29,810
המונח אופטימום

129
00:04:30,200 --> 00:04:31,000
מקומי, אגב, מתייחס

130
00:04:31,490 --> 00:04:32,930
לאופטימום המקומי של

131
00:04:33,190 --> 00:04:35,940
פונקצית העיוות J,

132
00:04:36,320 --> 00:04:38,380
והפתרונות האלה כאן

133
00:04:38,590 --> 00:04:39,830
למטה, האופטימומים המקומיים

134
00:04:40,120 --> 00:04:41,420
תואמים

135
00:04:41,530 --> 00:04:42,880
לפתרונות כאלה שבהם K-מרכזים

136
00:04:43,330 --> 00:04:44,050
נתקע במינימום מקומי

137
00:04:44,600 --> 00:04:45,940
ולא באמת מצליח

138
00:04:46,170 --> 00:04:47,940
למזער את

139
00:04:48,110 --> 00:04:50,030
פונקצית העיוות J. אז

140
00:04:50,540 --> 00:04:52,250
אם אתם מודאגים לגבי כך שK-מרכזים

141
00:04:52,540 --> 00:04:53,810
יתקע במינימום מקומי, אם

142
00:04:53,970 --> 00:04:55,110
אתם רוצים להגדיל את הסיכויים

143
00:04:55,330 --> 00:04:56,950
שK-מרכזים ימצא את חלוקת האשכולות

144
00:04:57,230 --> 00:04:58,480
הטובה ביותר האפשרית, כמו זו שמוצגת

145
00:04:58,730 --> 00:05:00,290
כאן למעלה, מה

146
00:05:00,350 --> 00:05:02,820
שאפשר לעשות הוא לנסות התאמות אקראיות מרובות.

147
00:05:03,580 --> 00:05:04,820
במקום לאתחל את K-מרכזים

148
00:05:05,430 --> 00:05:06,460
פעם אחת ולקוות שהוא

149
00:05:06,670 --> 00:05:07,680
יעבוד, מה שאנחנו יכולים לעשות

150
00:05:08,040 --> 00:05:10,020
הוא, לאתחל את K-מרכזים הרבה פעמים

151
00:05:10,130 --> 00:05:10,990
ולהפעיל את K-מרכזים הרבה פעמים,

152
00:05:11,890 --> 00:05:12,870
ולהשתמש בזה

153
00:05:12,950 --> 00:05:13,840
כדי לנסות להיות בטוחים שאנחנו מקבלים

154
00:05:14,110 --> 00:05:15,640
פתרון טוב לפחות כמו

155
00:05:15,800 --> 00:05:18,380
מינימום מקומי או גלובלי טוב ככל האפשר.

156
00:05:19,480 --> 00:05:22,460
באופן קונקרטי, הנה איך אפשר לעשות את זה.

157
00:05:22,720 --> 00:05:23,500
נניח, אני יכול להחליט להפעיל

158
00:05:23,700 --> 00:05:24,800
את K-מרכזים מאה פעמים,

159
00:05:25,160 --> 00:05:26,790
אז אני אבצע את הלולאה הזאת

160
00:05:27,060 --> 00:05:28,900
מאה פעמים וזה

161
00:05:29,330 --> 00:05:30,830
מספר אופייני למדי

162
00:05:30,920 --> 00:05:31,910
של פעמים בK-מרכזים,

163
00:05:32,160 --> 00:05:33,670
כשהטווח עשוי להיות בין 50 ל-1000.

164
00:05:35,090 --> 00:05:36,730
אז נניח שאתה מחליט להריץ את K-מרכזים מאה פעמים.

165
00:05:38,220 --> 00:05:39,100
אז מה שזה אומר הוא

166
00:05:39,170 --> 00:05:41,490
שאנחנו נאתחל את K-מרכזים באופן אקראי.

167
00:05:42,350 --> 00:05:43,250
ועבור כל פעם

168
00:05:43,340 --> 00:05:44,710
שאנחנו מאתחלים אקראית,

169
00:05:45,370 --> 00:05:47,040
אנחנו נפעיל את K-מרכזים

170
00:05:47,220 --> 00:05:48,200
וזה ייתן לנו קבוצה

171
00:05:48,430 --> 00:05:50,270
של אשכולות, ומערכת של מרכזים

172
00:05:50,590 --> 00:05:51,940
של אשכולות, ואז

173
00:05:52,040 --> 00:05:53,760
נחשב את פונקצית העיוות J,

174
00:05:54,500 --> 00:05:55,600
זאת אומרת נחשב את פונקצית העלות

175
00:05:56,910 --> 00:05:58,260
על קבוצת ההקצאות לאשכולות

176
00:05:58,720 --> 00:05:59,910
ומרכזי האשכולות שקיבלנו.

177
00:06:01,000 --> 00:06:03,470
ואז, לאחר שעשינו את כל התהליך הזה מאה פעמים,

178
00:06:04,450 --> 00:06:06,330
יהיו לך מאה דרכים שונות

179
00:06:06,710 --> 00:06:08,990
לאישכול של הנתונים

180
00:06:09,240 --> 00:06:10,310
ואז בסופו של דבר מה שצריך לעשות

181
00:06:10,590 --> 00:06:11,510
הוא מבין כל מאה

182
00:06:11,820 --> 00:06:13,210
הדרכים האלה שמצאת לבנות אשכולות נתונים,

183
00:06:13,800 --> 00:06:16,050
פשוט לבחור דרך אחת, את זו שנותנת לנו את העלות הנמוכה ביותר.

184
00:06:16,400 --> 00:06:18,480
זאת שנותנת לנו את העיוות הנמוך ביותר.

185
00:06:18,960 --> 00:06:20,610
מתברר

186
00:06:21,170 --> 00:06:22,490
שאם אתה מפעיל את K-מרכזים

187
00:06:22,670 --> 00:06:24,520
עם מספר קטן יחסית

188
00:06:24,630 --> 00:06:25,260
של אשכולות, אם מספר

189
00:06:25,520 --> 00:06:26,700
האשכולות הוא איזה שהוא מספר בין

190
00:06:26,760 --> 00:06:28,180
שתיים עד אולי 10,

191
00:06:28,980 --> 00:06:30,650
אז להריץ מספר גדול של אתחולים אקראיים

192
00:06:31,460 --> 00:06:32,880
יכול לפעמים

193
00:06:32,990 --> 00:06:34,430
לוודא שתמצא מינימום מקומי טוב יותר.

194
00:06:34,690 --> 00:06:37,680
לוודא שתמצא דרך טובה יותר לקיבוץ אשכולות.

195
00:06:37,870 --> 00:06:38,930
אבל אם K הוא גדול מאוד,

196
00:06:39,080 --> 00:06:40,000
אם K הוא הרבה יותר גדול מ-10,

197
00:06:40,160 --> 00:06:41,010
בוודאות אם K הוא,

198
00:06:41,080 --> 00:06:42,340
אם אתה מנסה

199
00:06:42,400 --> 00:06:44,050
למצוא מאות אשכולות, אז

200
00:06:45,840 --> 00:06:47,310
להרצה של מספר אתחולים אקראיים

201
00:06:47,940 --> 00:06:49,220
יש סיכוי קטן יותר לשנות הרבה,

202
00:06:49,360 --> 00:06:50,400
ויש סיכוי

203
00:06:50,590 --> 00:06:51,910
הרבה יותר גבוה שכבר

204
00:06:52,320 --> 00:06:53,610
האתחול האקראי הראשון שלך ייתן לך

205
00:06:53,730 --> 00:06:55,380
פתרון די סביר,

206
00:06:56,590 --> 00:06:58,070
ואולי, וכנראה, להריץ כמה נסיונות

207
00:06:58,680 --> 00:07:00,060
ייתן לך פתרון

208
00:07:00,260 --> 00:07:02,500
קצת יותר טוב אבל אולי לא בהרבה.

209
00:07:02,780 --> 00:07:04,230
רק באזור שבו

210
00:07:04,540 --> 00:07:05,810
יש לך מספר קטן יחסית

211
00:07:06,090 --> 00:07:07,740
של אשכולות, במיוחד אם

212
00:07:08,040 --> 00:07:09,080
יש לך נניח 2 או 3

213
00:07:09,150 --> 00:07:10,550
או 4 אשכולות, אז להריץ

214
00:07:11,140 --> 00:07:13,790
כמה נסיונות של אתחול אקראי יכול לעשות הבדל עצום

215
00:07:14,190 --> 00:07:15,090
בוידוא של הצלחה

216
00:07:15,170 --> 00:07:16,920
במיזעור של פונקצית העיוות

217
00:07:17,560 --> 00:07:18,730
ולתת לך סידור אשכולות טוב.

218
00:07:21,390 --> 00:07:22,560
אז זהו הנושא

219
00:07:22,640 --> 00:07:23,300
של אתחול אקראי בK-מרכזים.

220
00:07:24,350 --> 00:07:25,570
אם אתה מנסה ללמוד

221
00:07:25,710 --> 00:07:26,950
אשכולות עם מספר קטן יחסית

222
00:07:27,310 --> 00:07:28,250
של אשכולות, 2, 3,

223
00:07:28,400 --> 00:07:30,540
4, 5, אולי, 6, 7,

224
00:07:31,660 --> 00:07:34,040
אז מספר רב של אתחולים אקראיים

225
00:07:34,380 --> 00:07:36,830
יכול לפעמים לעזור לך למצוא חלוקת אשכולות הרבה יותר טובה של הנתונים.

226
00:07:37,680 --> 00:07:39,650
אבל אם אתה לומד מספר רב של אשכולות,

227
00:07:40,350 --> 00:07:43,280
אז שיטת האתחול האקראית שתיארתי כאן

228
00:07:43,520 --> 00:07:45,110
אמורה לתת לK-מרכזים

229
00:07:45,370 --> 00:07:46,680
נקודת התחלה סבירה להתחיל

230
00:07:47,030 --> 00:07:48,580
כדי למצוא חלוקה טובה לאשכולות.