1
00:00:00,400 --> 00:00:01,510
בשלב זה, כבר ראינו את כל

2
00:00:01,800 --> 00:00:03,600
החלקים העיקריים של

3
00:00:04,030 --> 00:00:06,760
אלגוריתם מערכת ההמלצות או אלגוריתם הסינון המשותף.

4
00:00:07,770 --> 00:00:08,770
בסרטון הזה אני רוצה

5
00:00:08,940 --> 00:00:10,620
רק לשתף אתכם בפרט יישומי אחד אחרון,

6
00:00:12,000 --> 00:00:14,140
שהוא נירמול אל הממוצע,

7
00:00:14,350 --> 00:00:15,520
שיכול לפעמים לגרום

8
00:00:15,570 --> 00:00:17,090
לאלגוריתם לעבוד קצת יותר טוב.

9
00:00:18,290 --> 00:00:20,820
כדי להתחיל לדון ברעיון של נירמול לפי הממוצע, הבה

10
00:00:22,130 --> 00:00:24,390
נבחן דוגמה שבה

11
00:00:24,710 --> 00:00:26,530
יש משתמשים שלא דירגו סרטים.

12
00:00:28,050 --> 00:00:29,290
אז בנוסף

13
00:00:29,540 --> 00:00:30,790
לארבעת המשתמשים שלנו, אליס, בוב, קרול

14
00:00:31,060 --> 00:00:32,710
ודייב, הוספתי

15
00:00:32,870 --> 00:00:35,110
משתמשת חמישית, חוה, שלא דירגה סרטים בכלל.

16
00:00:36,470 --> 00:00:37,920
בואו נראה מה יעשה אלגוריתם הסינון

17
00:00:38,350 --> 00:00:39,570
המשותף שלנו על המשתמשת הזו.

18
00:00:41,020 --> 00:00:43,140
נניח ש-n שווה 2

19
00:00:43,390 --> 00:00:44,420
דהיינו אנחנו נלמד שתי תכונות

20
00:00:45,410 --> 00:00:46,470
ואנחנו

21
00:00:46,630 --> 00:00:47,890
נלמד גם וקטור פרמטרים

22
00:00:48,140 --> 00:00:50,420
⁽θ⁽⁵, שהוא

23
00:00:51,130 --> 00:00:52,560
ב-R2, כי כזכור

24
00:00:52,750 --> 00:00:55,920
עכשיו הוקטורים שלנו הם ב-Rn ולא ב-Rn+1,

25
00:00:57,070 --> 00:00:58,210
נלמד את וקטור הפרמטרים ⁽θ⁽⁵ עבור המשתמשת מספר 5 שלנו, חוה.

26
00:00:59,780 --> 00:01:00,800
אז אם נסתכל

27
00:01:00,960 --> 00:01:02,020
על הביטוי הראשון

28
00:01:02,200 --> 00:01:04,020
של מטרת האופטימיזציה,

29
00:01:04,220 --> 00:01:05,490
המשתמשת חוה לא דירגה

30
00:01:05,730 --> 00:01:07,860
שום סרט, ולכן

31
00:01:08,120 --> 00:01:10,750
אין שום סרט

32
00:01:11,050 --> 00:01:12,810
שלגביו (r(i,j שווה 1

33
00:01:13,130 --> 00:01:14,590
עבור המשתמשת חוה

34
00:01:14,700 --> 00:01:15,840
ולכן המונח הראשון

35
00:01:16,060 --> 00:01:17,400
אינו משחק תפקיד בקביעת ⁽θ⁽⁵

36
00:01:18,610 --> 00:01:19,790
כי אין סרטים שחוה דירגה.

37
00:01:20,960 --> 00:01:22,120
אז המונח היחיד

38
00:01:22,260 --> 00:01:24,300
שמשפיע על ⁽θ⁽⁵ הוא המונח הזה.

39
00:01:24,880 --> 00:01:25,830
אז אנחנו אומרים שאנחנו

40
00:01:25,910 --> 00:01:28,840
רוצים לבחור וקטור פרמטרים ⁽θ⁽⁵

41
00:01:28,950 --> 00:01:33,820
כך שמונח ההסדרה האחרון

42
00:01:34,540 --> 00:01:35,500
הוא קטן ככל האפשר.

43
00:01:35,920 --> 00:01:38,470
במילים אחרות אנחנו רוצים למזער את

44
00:01:39,040 --> 00:01:39,610
λ/2 כפול ⁽θ₁⁽⁵ בריבוע

45
00:01:40,880 --> 00:01:43,150
ועוד ⁽θ₂⁽⁵

46
00:01:43,820 --> 00:01:45,840
בריבוע,

47
00:01:46,040 --> 00:01:47,170
שהוא החלק של

48
00:01:47,270 --> 00:01:49,460
ביטוי ההסדרה ששייך

49
00:01:49,740 --> 00:01:51,610
למשתמש 5, וכמובן

50
00:01:51,850 --> 00:01:53,280
אם המטרה היא

51
00:01:53,550 --> 00:01:55,540
למזער את המונח הזה, אז

52
00:01:55,900 --> 00:01:56,790
מה שנקבל הוא

53
00:01:56,980 --> 00:01:58,520
פשוט ש-⁽θ⁽⁵ שווה 0 0.

54
00:01:59,670 --> 00:02:01,550
כי מונח ההסדרה

55
00:02:01,850 --> 00:02:03,270
מכוון אותנו להגדיר

56
00:02:03,510 --> 00:02:05,120
פרמטרים הקרובים ל-0,

57
00:02:05,620 --> 00:02:07,580
ואם אין

58
00:02:07,730 --> 00:02:08,820
נתונים שמנסים

59
00:02:08,990 --> 00:02:10,210
להרחיק את הפרמטרים

60
00:02:10,410 --> 00:02:11,460
מ-0, כי הביטוי הראשון

61
00:02:12,710 --> 00:02:13,800
כמו שאמרנו איננו משפיע על ⁽θ⁽⁵,

62
00:02:13,880 --> 00:02:15,410
אנחנו פשוט נקבל ⁽θ⁽⁵

63
00:02:15,690 --> 00:02:18,450
שווה לווקטור של אפסים.

64
00:02:18,590 --> 00:02:19,610
אז כשננסה

65
00:02:19,730 --> 00:02:20,920
לחזות איך משתמש 5

66
00:02:21,280 --> 00:02:22,570
ידרג כל סרט, נקבל

67
00:02:22,890 --> 00:02:25,850
⁽θ⁽⁵⁾ᵀx⁽ⁱ,

68
00:02:26,900 --> 00:02:28,380
וזה, עבור כל i, פשוט

69
00:02:29,950 --> 00:02:31,060
יהיה שווה לאפס.

70
00:02:31,570 --> 00:02:33,320
כי ⁽θ⁽⁵ הוא 0

71
00:02:33,750 --> 00:02:35,780
בלי קשר ל-x, ולכן המכפלה הפנימית תהיה שווה ל-0.

72
00:02:35,900 --> 00:02:37,160
ומה שנקבל לפיכך הוא

73
00:02:37,310 --> 00:02:38,780
שאנחנו ננבא שחוה

74
00:02:39,480 --> 00:02:40,870
תדרג כל סרט וסרט

75
00:02:41,170 --> 00:02:42,690
ב-0 כוכבים.

76
00:02:44,050 --> 00:02:45,970
אבל זה לא נראה שימושי במיוחד, נכון?

77
00:02:46,110 --> 00:02:47,310
אני מתכוון, בואו נסתכל על סרטים שונים,

78
00:02:47,770 --> 00:02:49,710
לדוגמא אהבה סופסוף, הסרט הראשון,

79
00:02:50,130 --> 00:02:52,300
כמה מהצופים דירגו את זה ב-5 כוכבים.

80
00:02:54,940 --> 00:02:56,870
וגם עבור חרבות נגד קראטה, מישהו דירג את זה כ-5 כוכבים.

81
00:02:57,410 --> 00:02:58,780
אז אנשים שונים אוהבים סרטים שונים.

82
00:02:59,270 --> 00:03:01,030
זה נראה לא שימושי

83
00:03:01,160 --> 00:03:03,750
פשוט לחזות שחוה תדרג את כל הסרטים ב-0 כוכבים.

84
00:03:04,570 --> 00:03:05,850
ולמעשה אם אנחנו צופים

85
00:03:06,410 --> 00:03:08,340
שחוה תדרג כל סרט ב-0 כוכבים,

86
00:03:09,050 --> 00:03:10,100
אין לנו בעצם

87
00:03:10,280 --> 00:03:11,660
שום דרך טובה להמליץ לה על שום סרט,

88
00:03:11,810 --> 00:03:12,930
כי

89
00:03:13,130 --> 00:03:15,320
כל הסרטים האלה מקבלים בדיוק

90
00:03:15,410 --> 00:03:16,810
אותו דירוג צפוי עבור חוה,

91
00:03:17,010 --> 00:03:18,500
אז אין שום סרט מסוים

92
00:03:18,660 --> 00:03:20,010
עם דירוג צפוי גבוה יותר

93
00:03:20,210 --> 00:03:22,880
שעליו אנחנו יכולים להמליץ לה, אז זה לא הכי טוב.

94
00:03:24,520 --> 00:03:27,340
הרעיון של נירמול לפי הממוצע יאפשר לנו לתקן את הבעיה.

95
00:03:28,160 --> 00:03:29,410
אז כך זה עובד.

96
00:03:30,760 --> 00:03:31,720
הרשו לי כמו קודם לקבץ את כל

97
00:03:32,370 --> 00:03:33,750
הדירוגים של כל הסרטים לתוך המטריצה

98
00:03:34,280 --> 00:03:35,400
Y, פשוט לקחת את כל

99
00:03:35,460 --> 00:03:36,700
הדירוגים ולקבץ אותם

100
00:03:37,240 --> 00:03:38,400
לתוך המטריצה Y.

101
00:03:38,560 --> 00:03:39,740
והטור הזה כאן שכולו

102
00:03:39,910 --> 00:03:41,220
סימני שאלה מתאים

103
00:03:41,670 --> 00:03:43,300
לחווה שלא דירגה אף סרט.

104
00:03:44,830 --> 00:03:46,890
עכשיו כדי לבצע נירמול לפי הממוצע

105
00:03:47,140 --> 00:03:48,350
אנחנו נחשב את

106
00:03:48,720 --> 00:03:50,610
הדירוג הממוצע שכל סרט קיבל.

107
00:03:51,120 --> 00:03:51,760
ונאחסן את זה

108
00:03:52,040 --> 00:03:54,780
בווקטור שנקרא לו μ - מיו.

109
00:03:55,210 --> 00:03:57,250
אז הסרט הראשון קיבל פעמיים 5 כוכבים ופעמיים 0 כוכבים,

110
00:03:57,760 --> 00:03:58,960
הממוצע של זה הוא דירוג של 2.5 כוכבים.

111
00:03:59,040 --> 00:04:01,470
לסרט השני היה

112
00:04:01,620 --> 00:04:04,300
ממוצע של 2.5 כוכבים וכן הלאה.

113
00:04:04,470 --> 00:04:06,300
לסרט האחרון היו דירוגים של 0, 0, 5, 0.

114
00:04:06,330 --> 00:04:07,440
והממוצע של 0, 0,

115
00:04:07,520 --> 00:04:09,190
5, 0, הוא

116
00:04:09,620 --> 00:04:11,500
דירוג של 1.25.

117
00:04:12,240 --> 00:04:14,910
ועכשיו

118
00:04:15,000 --> 00:04:15,900
נסתכל על כל

119
00:04:16,020 --> 00:04:17,610
הדירוגים של הסרטים

120
00:04:18,010 --> 00:04:19,550
ונחסר מכל אחד את הדירוג הממוצע.

121
00:04:20,110 --> 00:04:22,990
אז מהאיבר הראשון, 5, אני מחסר 2.5 וזה נותן לי 2.5.

122
00:04:26,900 --> 00:04:29,380
ומהאיבר השני, 5, נחסר 2.5,

123
00:04:29,590 --> 00:04:30,000
ונקבל 2.5.

124
00:04:30,410 --> 00:04:31,760
ומה-0, 0,

125
00:04:32,040 --> 00:04:34,560
נחסר 2.5 ונקבל 2.5-, 2.5-.

126
00:04:35,450 --> 00:04:36,530
במילים אחרות, מה

127
00:04:36,620 --> 00:04:38,010
שאנחנו עושים הוא

128
00:04:38,310 --> 00:04:39,440
לקחת את המטריצה של דירוגי הסרטים,

129
00:04:39,960 --> 00:04:42,070
את המטריצה Y,

130
00:04:42,730 --> 00:04:45,580
ולחסר מכל שורה את הדירוג הממוצע של הסרט.

131
00:04:46,580 --> 00:04:47,580
בקיצור אנחנו

132
00:04:48,010 --> 00:04:49,600
פשוט מנרמלים כל סרט

133
00:04:49,740 --> 00:04:51,610
כך שיהיה לו דירוג ממוצע של אפס.

134
00:04:52,800 --> 00:04:53,580
אז רק דוגמה אחת אחרונה.

135
00:04:54,000 --> 00:04:56,010
אם תסתכלו בשורה האחרונה, 0 0 5 0.

136
00:04:56,270 --> 00:04:56,940
אנחנו מחסרים 1.25,

137
00:04:57,000 --> 00:04:58,590
ולכן מקבלים

138
00:05:00,950 --> 00:05:02,300
את הערכים האלה כאן.

139
00:05:02,510 --> 00:05:03,730
וכמובן

140
00:05:03,940 --> 00:05:05,380
סימני השאלה נשארים

141
00:05:06,960 --> 00:05:06,960
סימני שאלה.

142
00:05:07,880 --> 00:05:09,630
אז לכל סרט

143
00:05:09,810 --> 00:05:11,040
במטריצה החדשה הזו Y

144
00:05:11,210 --> 00:05:12,780
יש דירוג ממוצע של 0.

145
00:05:13,940 --> 00:05:15,180
ועכשיו

146
00:05:15,440 --> 00:05:16,850
אנחנו ניקח את הדירוגים האלה,

147
00:05:17,590 --> 00:05:20,170
ובהם נשתמש לאלגוריתם הסינון השיתופי.

148
00:05:20,480 --> 00:05:22,130
אנחנו מעמידים פנים שאלה

149
00:05:22,430 --> 00:05:24,200
היו הנתונים

150
00:05:24,420 --> 00:05:25,570
שקיבלנו מהמשתמשים, מעמידים פנים

151
00:05:25,810 --> 00:05:27,400
שאלה הם הדירוגים

152
00:05:27,530 --> 00:05:28,940
שקיבלנו למעשה מהמשתמשים,

153
00:05:29,250 --> 00:05:30,130
ואנחנו נשתמש בהם

154
00:05:30,270 --> 00:05:31,730
כסדרת הקלט

155
00:05:32,000 --> 00:05:33,920
שבעזרתה נלמד את הפרמטרים

156
00:05:34,560 --> 00:05:36,540
θj ואת התכונות xi -

157
00:05:36,860 --> 00:05:39,320
מתוך הדירוגים האלה המנורמלים לפי הממוצע של הסרטים.

158
00:05:41,280 --> 00:05:42,040
ועכשיו כאשר אנחנו רוצים לבצע תחזית

159
00:05:42,660 --> 00:05:43,910
של דירוג של סרט, הנה מה

160
00:05:44,070 --> 00:05:44,980
שעלינו לעשות:

161
00:05:45,250 --> 00:05:46,830
עבור המשתמש j על הסרט

162
00:05:47,130 --> 00:05:49,250
i, אנחנו נעשה ניבוי של

163
00:05:49,600 --> 00:05:54,730
⁽θ⁽ʲ⁾ᵀx⁽ⁱ

164
00:05:55,070 --> 00:05:55,990
כאשר x ו-θ הם הפרמטרים

165
00:05:56,590 --> 00:05:58,230
שלמדתי מסדרת הנתונים המנורמלת לפי הממוצע,

166
00:05:59,180 --> 00:06:00,680
אבל מכיוון שעל סדרת הנתונים

167
00:06:00,950 --> 00:06:02,260
הזו אנחנו הפחתנו את

168
00:06:02,330 --> 00:06:04,000
הממוצע, אז עכשיו על מנת

169
00:06:04,040 --> 00:06:05,210
לעשות חיזוי על הסרט i,

170
00:06:05,510 --> 00:06:07,220
עלינו להוסיף בחזרה את הממוצע,

171
00:06:08,070 --> 00:06:08,730
ולכן נחבר בחזרה

172
00:06:08,840 --> 00:06:10,690
את μi.

173
00:06:10,830 --> 00:06:11,780
אז זו תהיה

174
00:06:11,830 --> 00:06:13,350
התחזית שלנו. שוב - מכיוון

175
00:06:13,660 --> 00:06:14,860
שחיסרנו את הממוצע מסדרת האימון,

176
00:06:14,930 --> 00:06:16,290
לכן כאשר אנו

177
00:06:16,440 --> 00:06:20,770
מבצעים תחזיות אנחנו צריכים

178
00:06:21,770 --> 00:06:23,030
להוסיף בחזרה

179
00:06:23,410 --> 00:06:23,880
את הממוצע עבור הסרט i.

180
00:06:24,100 --> 00:06:25,320
אז בפרט, לגבי משתמש

181
00:06:25,330 --> 00:06:26,840
5 שהוא חוה, אותו טיעון

182
00:06:27,010 --> 00:06:28,250
עדיין חל כמו בשקופית הקודמת,

183
00:06:28,440 --> 00:06:29,870
במובן שחווה לא

184
00:06:30,080 --> 00:06:31,600
דירגה שום סרט

185
00:06:31,760 --> 00:06:32,930
ולכן הפרמטרים שיילמדו

186
00:06:33,710 --> 00:06:35,030
עבור משתמש 5 הם

187
00:06:35,970 --> 00:06:37,990
עדיין 0, 0.

188
00:06:38,270 --> 00:06:39,910
אז מה שנקבל

189
00:06:40,130 --> 00:06:41,320
הוא זה,

190
00:06:41,690 --> 00:06:42,980
על סרט מסוים i

191
00:06:43,130 --> 00:06:44,900
אנחנו צופים שחוה תדרג אותו

192
00:06:45,480 --> 00:06:49,930
כ-⁽θ⁽⁵⁾ᵀx⁽ⁱ פלוס

193
00:06:51,260 --> 00:06:52,890
מה שצריך להוסיף חזרה שהוא μi,

194
00:06:53,010 --> 00:06:54,360
והמרכיב הראשון

195
00:06:54,460 --> 00:06:57,520
שווה לאפס, כי ⁽θ⁽⁵ שווה לאפס.

196
00:06:58,290 --> 00:06:59,190
אז על הסרט i,

197
00:06:59,260 --> 00:07:00,660
אנחנו נחזה את μi.

198
00:07:01,090 --> 00:07:03,190
וזה באמת הגיוני.

199
00:07:03,380 --> 00:07:03,690
זה אומר

200
00:07:03,900 --> 00:07:05,270
שאת סרט 1 אנחנו

201
00:07:05,390 --> 00:07:06,990
צופים שחווה תדרג כ-2.5.

202
00:07:07,270 --> 00:07:10,260
את סרט 2 אנחנו צופים שחווה תדרג כ-2.5.

203
00:07:10,420 --> 00:07:11,640
את סרט 3 אנחנו

204
00:07:11,880 --> 00:07:13,000
צופים שחווה תדרג כ-2

205
00:07:13,200 --> 00:07:14,510
וכן הלאה.

206
00:07:14,780 --> 00:07:15,960
זה באמת הגיוני, כי זה אומר

207
00:07:16,320 --> 00:07:17,730
שאם חווה לא

208
00:07:18,020 --> 00:07:18,870
דירגה סרטים ואנחנו פשוט

209
00:07:19,100 --> 00:07:20,180
לא יודעים שום דבר על

210
00:07:20,410 --> 00:07:21,630
המשתמשת החדשה הזו חוה, כל מה שאנחנו יכולים

211
00:07:21,810 --> 00:07:23,770
לעשות הוא פשוט לחזות עבור

212
00:07:23,940 --> 00:07:25,140
כל אחד מהסרטים את

213
00:07:25,230 --> 00:07:27,520
הדירוג הממוצע של הסרטים האלה.

214
00:07:30,060 --> 00:07:31,480
לבסוף, כהערה צדדית,

215
00:07:31,810 --> 00:07:33,290
בסרטון הזה דיברנו על נירמול

216
00:07:33,540 --> 00:07:35,220
לפי הממוצע, שבו נירמלנו

217
00:07:35,320 --> 00:07:36,450
כל שורה של המטריצה y

218
00:07:37,510 --> 00:07:38,100
כך שיהיה לה ממוצע 0.

219
00:07:39,020 --> 00:07:40,730
אם יש לנו גם סרטים

220
00:07:41,020 --> 00:07:42,330
שאין להם שום דירוג, זה

221
00:07:42,590 --> 00:07:44,320
מקביל למשתמש שלא דירג שום דבר,

222
00:07:44,590 --> 00:07:45,550
אבל אם יש

223
00:07:46,250 --> 00:07:47,530
סרטים ללא דירוגים,

224
00:07:47,590 --> 00:07:48,700
אפשר גם לשחק עם גירסאות

225
00:07:49,320 --> 00:07:50,700
של האלגוריתם, שבהם

226
00:07:50,900 --> 00:07:52,190
מנרמלים את העמודות

227
00:07:52,790 --> 00:07:53,990
כך שיהיה להם ממוצע אפס, במקום

228
00:07:54,280 --> 00:07:55,180
לנרמל את השורות לאפס,

229
00:07:55,500 --> 00:07:56,990
אם כי זה אולי

230
00:07:57,240 --> 00:07:58,770
פחות חשוב, כי אם

231
00:07:58,870 --> 00:07:59,810
באמת יש סרט

232
00:08:00,040 --> 00:08:01,390
ללא דירוג, אולי פשוט

233
00:08:01,590 --> 00:08:03,920
לא צריך להמליץ על הסרט לאף אחד ממילא.

234
00:08:04,700 --> 00:08:08,010
ולכן טיפול

235
00:08:08,540 --> 00:08:09,980
במקרה של משתמש שלא

236
00:08:10,490 --> 00:08:11,780
דירג שום דבר עשוי להיות

237
00:08:12,010 --> 00:08:13,170
חשוב יותר מאשר לטפל במקרה

238
00:08:13,310 --> 00:08:14,550
של סרט

239
00:08:14,860 --> 00:08:16,090
שלא קיבל שום דירוג.

240
00:08:18,930 --> 00:08:20,080
אז לסיכום, כך

241
00:08:20,360 --> 00:08:21,830
אפשר לעשות נורמליזציה לממוצע

242
00:08:22,110 --> 00:08:25,110
כמין שלב עיבוד מראש עבור אלגוריתם סינון שיתופי.

243
00:08:25,740 --> 00:08:26,670
ובהתאם למערך הנתונים שלנו,

244
00:08:26,960 --> 00:08:28,140
הפעולה הזו עשויה לגרום לעיתים

245
00:08:28,540 --> 00:08:30,040
לשיפור הביצועים של היישום.