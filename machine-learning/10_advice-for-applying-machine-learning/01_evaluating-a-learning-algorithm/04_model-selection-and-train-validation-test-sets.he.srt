1
00:00:00,160 --> 00:00:04,570
נניח שאתה רוצה להחליט איזו דרגה של פולינום להתאים לסדרת הנתונים.

2
00:00:04,570 --> 00:00:08,750
או אילו תכונות לכלול בנוסחה של אלגוריתם הלמידה.

3
00:00:08,750 --> 00:00:13,160
או נניח שברצונך לבחור בפרמטר הרגולציה λ עבור אלגוריתם הלמידה.

4
00:00:13,160 --> 00:00:14,550
למידה ללא השגחה.

5
00:00:14,550 --> 00:00:15,830
איך עושים את זה

6
00:00:15,830 --> 00:00:17,510
לזה קוראים בעיית בחירת המודל.

7
00:00:17,510 --> 00:00:22,411
ובדיון שלנו על איך לעשות את זה, נדבר על לא רק איך

8
00:00:22,411 --> 00:00:27,031
לפצל את הנתונים שלך לערכת לימוד וערכת בדיקה, אלא איך לחלק נתונים

9
00:00:27,031 --> 00:00:31,020
למה שאנחנו נקרא ערכות לימוד, אימות ובדיקה.

10
00:00:31,020 --> 00:00:33,860
אנחנו נראה בסרטון הזה בדיוק מה הם הדברים האלה,

11
00:00:33,860 --> 00:00:36,890
וכיצד להשתמש בהם לבחירת המודל.

12
00:00:36,890 --> 00:00:40,350
כבר ראינו הרבה פעמים את הבעיה של התאמת-יתר,

13
00:00:40,350 --> 00:00:44,380
שבה רק בגלל שאלגוריתם למידה מתאים היטב לסדרת האימון,

14
00:00:44,380 --> 00:00:47,490
זה לא אומר שזאת השערה טובה.

15
00:00:47,490 --> 00:00:52,290
באופן כללי יותר, זו הסיבה ששגיאה שנוצרת בקבוצת האימון אינה מנבאת בצורה טובה

16
00:00:52,290 --> 00:00:56,000
את מידת ההצלחה של ההיפותזה בדוגמאות חדשות.

17
00:00:56,000 --> 00:00:59,150
דהיינו, אם אתה מתאים כמה פרמטרים,

18
00:00:59,150 --> 00:01:02,810
θ0, θ1, θ2, וכן הלאה, לסדרת האימון,

19
00:01:02,810 --> 00:01:07,210
אז העובדה שההשערה שלך מצליחה היטב על סדרת האימון,

20
00:01:07,210 --> 00:01:11,630
לא אומרת הרבה במונחים של ניבוי עד כמה ההשערה שלך תצליח

21
00:01:11,630 --> 00:01:15,970
בהכללה לדוגמאות חדשות שלא נראו בסדרת האימון.

22
00:01:15,970 --> 00:01:18,730
ויש עיקרון כללי יותר והוא שברגע

23
00:01:18,730 --> 00:01:21,290
שהפרמטרים שלך מתאימים לקבוצה מסוימת של נתונים,

24
00:01:21,290 --> 00:01:23,720
בין אם סדרת האימון, ובין אם קבוצה אחרת,

25
00:01:23,720 --> 00:01:27,900
אז השגיאה של ההשערה שלך כפי שהיא נמדדת על אותה קבוצת נתונים,

26
00:01:27,900 --> 00:01:29,600
כגון השגיאה בסדרת האימון,

27
00:01:29,600 --> 00:01:33,380
לא סביר שתהיה הערכה טובה של השגיאה בפועל על נתונים כלליים.

28
00:01:33,380 --> 00:01:38,330
דהיינו, טיב ההנחה כאשר מכלילים אותה לדוגמאות חדשות.

29
00:01:38,330 --> 00:01:41,170
עכשיו בואו נחשוב על בעיית בחירת המודל.

30
00:01:41,170 --> 00:01:45,100
נניח שאתה מנסה לבחור את דרגת הפולינום המתאימה לנתונים.

31
00:01:45,100 --> 00:01:48,800
האם אתה צריך לבחור פונקציה ליניארית, פונקציה ריבועית, פונקציה משולשת?

32
00:01:48,800 --> 00:01:50,740
או אולי פולינום אפילו מסדר 10?

33
00:01:51,940 --> 00:01:55,810
אז זה כאילו יש לנו פרמטר נוסף באלגוריתם הזה,

34
00:01:55,810 --> 00:02:01,210
שאני אציין ב-d, כלומר, הדרגה של הפולינום

35
00:02:01,210 --> 00:02:02,310
שאתה רוצה לבחור.

36
00:02:02,310 --> 00:02:06,610
אז זה כאילו, בנוסף לפרמטרים θ, זה כאילו

37
00:02:06,610 --> 00:02:10,680
יש פרמטר אחד נוסף, d, שאותו אנחנו מנסים לקבוע באמצעות סדרת הנתונים.

38
00:02:10,680 --> 00:02:14,940
אז האפשרות הראשונה היא d שווה 1, אם נתאים פונקציה ליניארית.

39
00:02:14,940 --> 00:02:19,760
אנחנו יכולים לבחור d = 2, d = 3, ואפשר להמשיך עד d = 10.

40
00:02:19,760 --> 00:02:24,830
אז אנחנו רוצים להתאים את הסוג הנוסף הזה של פרמטר שאני מציין באמצעות d.

41
00:02:24,830 --> 00:02:28,880
אז בואו נניח שאנחנו רוצים לבחור מודל,

42
00:02:28,880 --> 00:02:33,110
זאת אומרת לבחור דרגה של פולינום, לבחור אחד מה-10 מודלים האלה.

43
00:02:33,110 --> 00:02:37,920
גם להתאים את המודל הזה וגם לקבל איזושהי הערכה של כמה טוב

44
00:02:37,920 --> 00:02:42,570
תצליח ההיפותזה הזו להכליל לדוגמאות חדשות.

45
00:02:42,570 --> 00:02:44,130
הנה מין דבר שאפשר לעשות.

46
00:02:44,130 --> 00:02:49,790
מה שאפשר לעשות, קודם כל לקחת את המודל הראשון ואיתו למזער את שגיאת האימון.

47
00:02:49,790 --> 00:02:53,260
וזה ייתן לנו איזה שהוא וקטור פרמטרים θ.

48
00:02:53,260 --> 00:02:58,600
ואז אפשר לקחת את המודל השני, את הפונקציה הריבועית,

49
00:02:58,600 --> 00:03:01,290
ולהתאים אותו לסדרת האימון וזה ייתן לנו איזה

50
00:03:01,290 --> 00:03:03,040
וקטור פרמטרים אחר.

51
00:03:03,040 --> 00:03:06,790
כדי להבדיל בין וקטורי הפרמטרים השונים האלה, אני

52
00:03:06,790 --> 00:03:11,550
אשתמש בסימן עליון אחד וסימן עליון שתיים, וכאן θ סימן עליון אחד

53
00:03:11,550 --> 00:03:16,170
פשוט אומר הפרמטרים שאני מקבל על ידי התאמת המודל הראשון לנתוני האימון שלי.

54
00:03:16,170 --> 00:03:19,130
ו-θ סימן עליון 2 פשוט אומר הפרמטרים שאני

55
00:03:19,130 --> 00:03:23,940
מקבל על ידי התאמת הפונקציה הריבועית לנתוני האימון שלי וכן הלאה.

56
00:03:23,940 --> 00:03:30,500
על ידי התאמת מודל מדרגה שלוש אני מקבל θ סימן עליון סוגריים שלוש עד, נניח, θ10.

57
00:03:30,500 --> 00:03:36,200
דבר אחד שאנחנו יכולים לעשות זה לקחת את הפרמטרים האלה ולהסתכל על שגיאת הבדיקה.

58
00:03:36,200 --> 00:03:38,800
אז אני יכול לחשב על סדרת הבדיקה את השגיאה של (J(θ1,

59
00:03:38,800 --> 00:03:46,330
השגיאה של (J(θ2, וכן הלאה.

60
00:03:47,410 --> 00:03:51,930
השגיאה של (J(θ3, וכן הלאה.

61
00:03:53,050 --> 00:03:57,546
אז אנחנו ניקח כל אחת מההשערות עם הפרמטרים המתאימים

62
00:03:57,546 --> 00:04:00,270
ופשוט נמדוד את הביצועים שלה על סט הבדיקה.

63
00:04:00,270 --> 00:04:05,010
עכשיו, אחד מהדברים שאפשר לעשות אז הוא, על מנת להחליט איזה מהמודלים לבחור,

64
00:04:05,010 --> 00:04:09,160
אנחנו נבדוק לאיזה דגם יש את השגיאה הנמוכה ביותר על סט המבחן.

65
00:04:09,160 --> 00:04:09,930
ובואו נאמר שבמקרה שלנו,

66
00:04:09,930 --> 00:04:14,480
בסופו של דבר בחרנו במקרה את הפולינום מדרגה חמישית.

67
00:04:14,480 --> 00:04:16,940
עד עכשיו זה נראה הגיוני.

68
00:04:16,940 --> 00:04:21,060
אבל עכשיו נניח שאני רוצה לקחת את ההיפותזה החמישית שלי,

69
00:04:21,060 --> 00:04:26,080
את זה, המודל מסדר חמישי, ונניח שאני רוצה לשאול, עד כמה המודל הזה טוב בהכללות?

70
00:04:27,190 --> 00:04:30,560
דבר אחד שאני יכול לעשות הוא להסתכל על כמה טובה ההשערה

71
00:04:30,560 --> 00:04:34,710
הפולינומית הזו מסדר חמישי על דוגמאות הבדיקה שלי.

72
00:04:34,710 --> 00:04:39,450
אבל הבעיה היא שזו לא תהיה הערכה הוגנת של כמה

73
00:04:39,450 --> 00:04:42,360
ההשערה שלי תהיה טובה לדוגמאות חדשות.

74
00:04:42,360 --> 00:04:48,140
והסיבה היא כי מה שעשינו היה שהתאמנו את הפרמטר הנוסף הזה d,

75
00:04:48,140 --> 00:04:50,870
שהוא דרגת הפולינום.

76
00:04:50,870 --> 00:04:54,720
והחלטנו איזה d מתאים באמצעות ערכת הבדיקה, כלומר,

77
00:04:54,720 --> 00:05:00,310
בחרנו את הערך של d שנתן לנו את הביצועים הטובים ביותר על דוגמאות הבדיקה.

78
00:05:00,310 --> 00:05:06,340
אז הביצועים של וקטור הפרמטרים שלי θ5 על סט הבדיקה,

79
00:05:06,340 --> 00:05:11,160
היא הערכה אופטימית מדי לגבי מה תהיה השגיאה בדוגמא אקראית מהעולם.

80
00:05:11,160 --> 00:05:15,640
נכון, כי כך בנינו את הפרמטר הזה d לפי דוגמאות המבחן ולכן זה

81
00:05:15,640 --> 00:05:21,410
"לא הוגן" להעריך את טיב ההשערה על קבוצת המבחן הזו, כי אנחנו התאמנו

82
00:05:21,410 --> 00:05:25,900
את הפרמטרים על קבוצת המבחן, בחרנו את הדרגה d של הפולינום באמצעות ערכת הבדיקה.

83
00:05:25,900 --> 00:05:29,430
אז ההשערה עשויה להצליח יותר על

84
00:05:29,430 --> 00:05:33,650
דוגמאות המבחן מאשר על דוגמאות חדשות שהיא לא

85
00:05:33,650 --> 00:05:36,140
ראתה קודם לכן, שזה מה שבאמת אכפת לי.

86
00:05:36,140 --> 00:05:41,050
אז רק לחזור, בשקופית הקודמת ראינו שאם אנחנו מתאימים איזו קבוצת

87
00:05:41,050 --> 00:05:45,210
פרמטרים, לדוגמא θ0, θ1, וכן הלאה, לסדרת האימון,

88
00:05:45,210 --> 00:05:50,300
אז הביצועים של המודל המאומן הזה על קבוצת האימון לא מנבאים עד

89
00:05:50,300 --> 00:05:53,500
כמה תהיה ההשערה מסוגלת להכליל לדוגמאות חדשות.

90
00:05:53,500 --> 00:05:56,770
הסיבה לכך היא שהפרמטרים הללו אומנו לפי סדרת האימון,

91
00:05:56,770 --> 00:05:59,110
ולכן זה צפוי שהם יפעלו היטב על דוגמאות האימון,

92
00:05:59,110 --> 00:06:03,200
גם אם הפרמטרים לא מצליחים עם דוגמאות אחרות.

93
00:06:03,200 --> 00:06:07,460
ובפרוצדורה שתיארתי כרגע בשורה הזאת, פשוט עשינו את אותו הדבר.

94
00:06:07,460 --> 00:06:13,060
מה שעשינו היה בדיוק להתאים את הפרמטר הזה d לסדרת המבחן.

95
00:06:13,060 --> 00:06:16,770
ובגלל ההתאמה הזו של הפרמטר למערך הבדיקה, משמעות הדבר היא

96
00:06:16,770 --> 00:06:22,010
שהביצועים של ההשערה על אותה סדרת מבחן עשויים לא להיות הערכה הוגנת של כמה

97
00:06:22,010 --> 00:06:26,670
טובה סביר שתהיה ההשערה על דוגמאות שלא ראינו קודם לכן.

98
00:06:26,670 --> 00:06:30,630
כדי לטפל בבעיה זו, בהגדרת בחירת המודל,

99
00:06:30,630 --> 00:06:35,550
אם ברצוננו גם להעריך את ההיפותזה, הנה מה שאנחנו עושים בדרך כלל במקום זה.

100
00:06:35,550 --> 00:06:40,200
כשמקבלים סדרת נתונים, במקום לפצל אותה רק לערכת הכשרה

101
00:06:40,200 --> 00:06:43,930
וסדרת בדיקה, מה שאנחנו עושים הוא לפצל אותה לשלושה חלקים.

102
00:06:43,930 --> 00:06:49,130
החלק הראשון ייקרא סדרת האימון כרגיל.

103
00:06:50,130 --> 00:06:53,300
אז תנו לי לקרוא לחלק הראשון סדרת אימון.

104
00:06:54,780 --> 00:07:00,056
ולחלק השני של הנתונים אנחנו נקרא סדרת הוידוא או האימות הצולב.

105
00:07:00,056 --> 00:07:04,711
אימות צולב.

106
00:07:04,711 --> 00:07:08,860
נקצר את זה ל-CV.

107
00:07:08,860 --> 00:07:13,520
לפעמים זה גם נקרא פשוט סדרת אימות במקום סדרת אימות צולב.

108
00:07:13,520 --> 00:07:18,060
ולחלק האחרון נקרא כרגיל סדרת הבדיקה.

109
00:07:18,060 --> 00:07:21,930
ויחס טיפוסי למדי, שבו מפצלים את הדברים האלה יהיה

110
00:07:21,930 --> 00:07:24,990
להקצות 60% מהנתונים לקבוצת האימונים,

111
00:07:24,990 --> 00:07:29,290
אולי 20% לקבוצת האימות הצולב, ו-20% לסט המבחן.

112
00:07:29,290 --> 00:07:33,600
המספרים האלה יכולים להשתנות מעט אבל שילוב כזה הוא אופייני למדי.

113
00:07:33,600 --> 00:07:38,922
אז ערכת ההדרכה שלנו תכיל כעת רק 60% מהנתונים,

114
00:07:38,922 --> 00:07:44,860
וקבוצת האימות הצולב שלנו, או קבוצת האימות שלנו, תכלול מספר דוגמאות

115
00:07:44,860 --> 00:07:47,290
שאני אציין ב-m עם סימן תחתון cv.

116
00:07:47,290 --> 00:07:50,860
זה מספר דוגמאות האימות הצולב.

117
00:07:52,040 --> 00:07:59,110
ובהתאמה להסכם שלנו מקודם לגבי סימון של דוגמאות, אני אשתמש ב-x(i)-cv,y(i)-cv

118
00:07:59,110 --> 00:08:02,720
כדי לציין את דוגמת האימות מספר i.

119
00:08:02,720 --> 00:08:07,290
וכמובן בנוסף יש לנו גם קבוצת מבחן

120
00:08:07,290 --> 00:08:11,420
והסימון m-test כסימון תחתון משמש כמספר דוגמאות הבדיקה.

121
00:08:11,420 --> 00:08:14,570
אז עכשיו לאחר שהגדרנו קבוצת אימון, קבוצת אימות

122
00:08:14,570 --> 00:08:16,740
או אימות צולב, וקבוצת מבחן,

123
00:08:16,740 --> 00:08:21,420
אנו יכולים להגדיר גם את שגיאת האימון, שגיאת האימות הצולב ושגיאת המבחן.

124
00:08:21,420 --> 00:08:23,790
אז הנה שגיאת האימון שלנו,

125
00:08:23,790 --> 00:08:26,820
ואני כותב את זה פשוט כ-J סמון תחתון אימון של θ.

126
00:08:26,820 --> 00:08:29,030
זה די דומה למה שעשינו למעלה.

127
00:08:29,030 --> 00:08:32,260
זה אותו דבר כמו (J(θ שכבר כתבנו מקודם,

128
00:08:32,260 --> 00:08:37,110
אלא שהשגיאה מחושבת על קבוצת האימון, על פי תוצאות ערכת האימון,

129
00:08:37,110 --> 00:08:41,470
ואז יש לנו השגיאה של J-cv שהיא קבוצת האימות, וגם זה די מה שהיינו מצפים,

130
00:08:41,470 --> 00:08:45,970
בדיוק כמו השגיאה על קבוצת האימון, אבל הפעם נמדד על קבוצת האימות הצולבת,

131
00:08:45,970 --> 00:08:48,450
ולבסוף יש לנו שגיאת המבחן שנמדדת על קבוצת המבחן.

132
00:08:49,530 --> 00:08:53,410
אז כשיש לנו בעיה של בחירת המודל כמו כאן, מה שאנחנו נעשה

133
00:08:53,410 --> 00:08:58,709
הוא, במקום להשתמש בקבוצת המבחן כדי לבחור את המודל, אנחנו נשתמש

134
00:08:58,709 --> 00:09:04,580
בערכת האימות, או בערכת האימות הצולב, כדי לבחור את המודל.

135
00:09:04,580 --> 00:09:10,570
אז כמו מקודם אנחנו ניקח את ההשערה הראשונה שלנו, את המודל הראשון,

136
00:09:10,570 --> 00:09:13,580
נמזער את פונקצית העלות

137
00:09:13,580 --> 00:09:17,520
וזה ייתן לנו איזשהו וקטור פרמטרים θ עבור המודל הליניארי.

138
00:09:17,520 --> 00:09:20,300
וכמו מקודם, אני אסמן אותו ב-1,

139
00:09:20,300 --> 00:09:23,560
כדי לציין שזהו וקטור הפרמטרים של המודל הליניארי.

140
00:09:23,560 --> 00:09:25,660
ואז נעשה אותו דבר עבור המודל הריבועי.

141
00:09:25,660 --> 00:09:27,927
נקבל איזה וקטור פרמטרים θ2.

142
00:09:27,927 --> 00:09:31,601
נקבל וקטור פרמטר θ3, וכן

143
00:09:31,601 --> 00:09:35,470
הלאה, עד θ10 עבור הפולינום מדרגה 10.

144
00:09:35,470 --> 00:09:40,440
ואז מה שנעשה הוא, במקום לבדוק את ההשערות האלה על סדרת הבדיקה,

145
00:09:40,440 --> 00:09:43,130
אנחנו נבדוק אותם על סט האימות הצולב.

146
00:09:43,130 --> 00:09:46,600
ונמדוד את J-cv,

147
00:09:46,600 --> 00:09:52,180
כדי לראות עד כמה טובה כל אחת מההשערות האלה על סדרת האימות הצולב שלנו.

148
00:09:53,250 --> 00:09:57,180
ואז אנחנו נבחר את ההשערה עם השגיאה הנמוכה ביותר על סדרת האימות.

149
00:09:57,180 --> 00:10:00,180
אז בדוגמה זו, נניח למען הדוגמה,

150
00:10:00,180 --> 00:10:06,550
כי זה היה הפולינום מסדר 4, שהיה הנמוך ביותר בשגיאת האימות.

151
00:10:06,550 --> 00:10:11,070
אז במקרה זה אנחנו נבחר את המודל הפולינומי מסדר רביעי .

152
00:10:11,070 --> 00:10:15,250
כזכור, מה זאת אומרת שהפרמטר d,

153
00:10:15,250 --> 00:10:17,200
זוכרים ש-d היה הדרגה של הפולינום, נכון?

154
00:10:17,200 --> 00:10:20,270
d שווה שתיים, d שווה שלוש, עד d שווה 10.

155
00:10:20,270 --> 00:10:25,040
מה שעשינו הוא שהתאמנו את הפרמטר הזה והחלטנו שהוא שווה 4.

156
00:10:25,040 --> 00:10:27,290
ועשינו זאת באמצעות ערכת האימות הצולב.

157
00:10:27,290 --> 00:10:32,320
ולכן הדרגה של הפולינום, הפרמטר, לא נבנתה להיות מתאימה למערך הבדיקה,

158
00:10:32,320 --> 00:10:39,260
ולכן לא השתמשנו עדיין בקבוצת המבחן, וניתן להשתמש בקבוצת המבחן

159
00:10:39,260 --> 00:10:44,325
כדי למדוד או כדי לאמוד את שגיאת ההכללה של הדגם שנבחר

160
00:10:44,325 --> 00:10:47,680
על ידי האלגוריתם.

161
00:10:47,680 --> 00:10:51,140
אז כאן תיארנו את מודל הבחירה ואיך אפשר לקחת את הנתונים,

162
00:10:51,140 --> 00:10:54,310
לפצל אותם לערכות אימון, אימות ומבחן.

163
00:10:54,310 --> 00:10:57,310
ולהשתמש בנתוני האימות הצולב כדי לבחור את המודל

164
00:10:57,310 --> 00:10:58,570
ואז להעריך אותו במערך המבחן.

165
00:10:59,630 --> 00:11:02,860
הערה אחת אחרונה שאני צריך לומר

166
00:11:02,860 --> 00:11:06,210
בלמידת מכונה כמו זו שנהוג לעשות אותה כיום, הרבה אנשים

167
00:11:06,210 --> 00:11:10,470
עושים את הדבר עליו דיברתי מקודם, ואמרתי שזה לא רעיון טוב,

168
00:11:10,470 --> 00:11:15,360
דהיינו לבחור את המודל באמצעות סדרת המבחן,

169
00:11:15,360 --> 00:11:19,590
ואז באמצעות אותה סדרת מבחן לחשב את השגיאה,

170
00:11:19,590 --> 00:11:24,120
כמו לבחור את דרגת הפולינום לפי קבוצת הבדיקה, ולאחר מכן לחשב את השגיאה

171
00:11:24,120 --> 00:11:27,840
לפי אותה קבוצת בדיקה כאילו שזו הערכה טובה של שגיאת ההכללה.

172
00:11:27,840 --> 00:11:31,160
זהו סוג של נוהג שלמרבה הצער נהוג כיום על ידי רבים.

173
00:11:31,160 --> 00:11:35,550
אם קבוצת המבחן היא באמת ענקית, אז אולי זה לא דבר כל כך נורא,

174
00:11:35,550 --> 00:11:38,090
אבל הרבה מהמומחים,

175
00:11:38,090 --> 00:11:42,360
רוב המומחים בלימוד ממוחשב נוטים לייעץ נגד הנוהג הזה.

176
00:11:42,360 --> 00:11:45,760
וזה נחשב למנהג יותר טוב ונכון אם יש סדרות או קבוצות נפרדות לאימון,

177
00:11:45,760 --> 00:11:46,728
אימות ומבחן.

178
00:11:46,728 --> 00:11:50,620
אני רק מסב את תשומת לבכם לכך שלפעמים אנשים אכן משתמשים באותם ערכת נתונים

179
00:11:50,620 --> 00:11:54,320
לצורך אימות ולצורך בדיקה.

180
00:11:54,320 --> 00:11:57,430
אבל צריך קבוצת אימון נפרדת מקבוצת בדיקה, וזה נוהג טוב,

181
00:11:57,430 --> 00:12:00,020
אם כי תראה כמה אנשים שלא עושים את זה.

182
00:12:00,020 --> 00:12:03,090
אבל, אם אפשר, אני ממליץ לכם להפריד את הערכות.