בהרצאה הזו, אני רוצה להעביר לכם את האינטואיציות העיקריות מאחורי אופן פעולת הרגולריזציה או ההסדרה. אנו גם נכתוב את פונקציית העלות בה נשתמש, כשנשתמש בהסדרה, עם הדוגמאות האלה המצוירות ביד שיש לנו על השקפים האלה, אני חושב שאהיה מסוגל להעניק לכם חלק מהאינטואיציה. אבל דרך אפילו יותר טובה לראות בעצמכם איך עובדת ההסדרה, היא ליישם אותה בעצמכם ולראות אותה בפעולה. ואם תפתרו את התרגילים לאחר מכן, תקבלו הזדמנות לראות את ההסדרה בפעולה בעצמכם. אז הנה האינטואיציה. בסרטון הקודם ראינו שאם אנו מתאימים לנתונים האלו פונקציה ריבועית, זה נותן לנו התאמה טובה למדי לנתונים. לעומת זאת, כשניסינו להתאים פולינום מדרגה גבוהה מדי, קיבלנו עקומה שמתאימה היטב לסדרת האימון, אבל בגלל התאמת היתר הזו, היא ממש לא ניתנת להכללה לדוגמאות אחרות. אז תחשבו על הרעיון הזה. נניח שהיינו קונסים את הפרמטרים תטא-3 ותטא-4 ומקטינים אותם בהרבה. הנה למה אני מתכוון, הנה מטרת האופטימיזציה שלנו, או בעיית האופטימיזציה שלנו, שבה אנחנו רוצים למזער את סך המחיר של ריבוע השגיאה כרגיל. נניח שאני לוקח את המטרה הזו ומשנה אותה קצת, לפלוס 1000 תטא-3 בריבוע פלוס 1000 תטא-4 בריבוע. אני כותב 1000 פשוט כדוגמה למספר גדול. עכשיו, למזער את הפונקציה הזו, הדרך היחידה שפונקצית העלות החדשה הזו תהיה קטנה היא אם תטא-3 ותטא-4 יהיו מאד קטנים, נכון? כי אחרת עם האיבר אלף כפול תטא-3, העלות החדשה הזו תהיה גדולה. ולכן, כשנמזער את הפונקציה החדשה זו נקבל ערכי תטא-3 קרוב ל-0 ותטא-4 קרוב ל 0, וזה דומה לכך שפשוט מחקנו את שני האיברים האלה. וכשמוחקים את שני האברים האלה, כשתטא-3 ותטא-4 קרובים ל-0 אז אנחנו נשארים עם פונקציה ריבועית, ויש לנו התאמה לנתונים, שהיא פונקציה ריבועית פלוס אולי תרומות זעירות מביטויים קטנים, תטא-3 ותטא-4, שעשויים להיות מאוד קרובים ל-0. ואנחנו נשארים עם נוסחה שהיא בעיקרה פונקציה ריבועית, וזה טוב. כי מדובר בהשערה הרבה יותר טובה. בדוגמא המסוימת הזו, ראינו את ההשפעה של הגבלת שניים מערכי הפרמטרים בגודלם. באופן יותר כללי, זהו הרעיון מאחורי ההסדרה. הרעיון הוא שאם יש לנו ערכים קטנים עבור הפרמטרים, ערכים קטנים של הפרמטרים בדרך כלל מתאימים לרעיון של השערה יותר פשוטה. כך, בדוגמה האחרונה שלנו, קנסנו רק את תטא-3 ותטא-4 וכששניהם קרובים לאפס, מה שיש לנו זו בעצם השערה הרבה יותר פשוטה שהיא בקירוב פונקציה ריבועית. אבל בצורה יותר כללית, אם אנו קונסים את כל הפרמטרים אנחנו יכולים לחשוב על זה כעל ניסיון להגיע להשערה יותר פשוטה, כמו שקרה אצלנו כשהפרמטרים האלה קרובים מאוד לאפס, וזה נתן לנו פונקציה ריבועית. אבל באופן אפילו יותר כללי, אפשר להראות כי שימוש בערכים קטנים יותר של פרמטרים מתאים בדרך כלל לפונקציות יותר חלקות כמו גם יותר פשוטות. שלכן גם פחות נוטות להתאמת-יתר. אני מבין שהסיבות למה אם כל הפרמטרים קטנים, למה זה מתאים להשערה יותר פשוטה; אני מבין שההסבר לכך יכול להיות לא לגמרי ברור לכם כרגע. וזה קצת קשה להסביר אלא אם תיישמו את זה בעצמכם ואז תראו את זה בעצמכם. אבל אני מקווה שהדוגמה שעשינו כשהכרחנו את תטא-3 ותטא-4 להיות קטנים ואיך זה נתן לנו השערה יותר פשוטה, אני מקווה שזה עוזר להסביר מדוע, או לפחות לתת קצת אינטואיציה לגבי השאלה מדוע זה עשוי להיות נכון. בואו ונסתכל על הדוגמא הספציפית לגבי חיזוי מחיר הדירות שבה יש לנו מאה תכונות, שדיברנו עליה שבה יכול להיות ש-x1 הוא הגודל, x2 הוא מספר חדרי השינה, x3 הוא מספר הקומות וכן הלאה. ועשויות להיות לנו מאה מאפיינים. ובשונה ממקרה הפולינום, אנחנו לא יודעים, אנחנו לא יודעים שתטא-3 ותטא-4 הם האיברים מסדר גבוה של הפולינום. אז אם יש לנו פשוט שק, אם יש לנו קבוצה של מאה תכונות, זה קשה לבחור מראש מי מהם יהיו אלה שנוטים להיות פחות רלוונטיים. יש לנו מאה או כמה מאות פרמטרים. ואנחנו לא יודעים אילו לבחור, אנחנו לא יודעים אילו פרמטרים לנסות לבחור כדי לנסות להקטין אותם. אז בהסדרה, מה שאנחנו הולכים לעשות, הוא לקחת את פונקצית העלות שלנו, הנה פונקצית העלות שלנו עבור רגרסיה ליניארית. ומה שאני הולך לעשות הוא לשנות את פונקצית העלות הזו שתקטין את כל הפרמטרים שלי, כי, כמו שאמרתי, אני לא יודע על אחד או שניים מסוימים שכדאי להקטין. אז אני הולך לשנות את פונקצית העלות ולהוסיף מונח בסוף. כמו זה, יש לנו סוגריים מרובעים גם כאן. כשאני מוסיף מונח הסדרה בסוף כדי שיקטין או יכווץ את כל הפרמטרים והמונח הזה נועד לכווץ את כל הפרמטרים שלי תטא-1, תטא-2, תטא-3 עד תטא-100. אגב, לפי המקובל הסכימה כאן מתחילה מ-1 אז אנחנו לא מענישים את תטא-0 ולא מכווצים אותו. זו מין מוסכמה, שהסכום הוא מ-i שווה 1 עד n, ולא i שווה 0 עד n, אבל בפועל, זה לא משנה כל כך, ואם כוללים את תטא-0 או לא, בפועל, זה לא יחולל שינוי גדול מאוד בתוצאות. אבל לפי המקובל, בדרך כלל, אנו מסדירים רק את תטא-1 עד תטא-100. נכתוב כאן שוב את מטרת האופטימיזציה המוסדרת שלנו, שוב את פונקצית העלות המוסדרת שלנו. הנה היא. הנה J של תטא, כשהמונח הזה מימין הוא מונח ההסדרה, המכפיל למבדה כאן נקרא פרמטר ההסדרה ולמבדה שולטת בשווי משקל בין שתי מטרות שונות. המטרה הראשונה שאליה מכוון המונח הראשון כאן, היא שאנחנו רוצים לכוונן, אנחנו רוצים להתאים בצורה טובה את נתוני סדרת האימון. ברצוננו להתאים את סדרת האימון היטב. והמטרה השנייה היא שאנחנו רוצים להגביל את גודלם של הפרמטרים, וזה מבוטא על ידי המונח השני, על ידי מונח ההסדרה. ומה שלמבדה, פרמטר ההסדרה, עושה, הוא שהוא שולט ביחסי הגומלין בין שתי המטרות האלה, בין המטרה של התאמה מיטבית של סדרת האימון ובין המטרה של הגבלת על גודל הפרמטרים שמשמעו השערה יחסית פשוטה כדי למנוע התאמת-יתר או עודף התאמה. בדוגמת חיזוי מחירי הדירות שלנו, כאשר, בעבר, לו ניסינו להתאים פולינום מסדר גבוה מאוד, היינו מגיעים לפונקציה מתפתלת ולא הגיונית. אם במקום זאת נתאים פולינום מסדר גבוה עם כל התכונות הפולינומיות שלו, אבל פשוט נדאג להשתמש ברעיון הזה של הסדרת פונקצית המחיר, אז מה שאנחנו עשויים לקבל הוא למעשה עקום שאינו ממש פונקציה ריבועית, אבל שהוא הרבה יותר חלק והרבה יותר פשוט ואולי עקום כמו הקו האדום כאן שנותן השערה הרבה יותר טובה עבור הנתונים האלה. שוב, אני מבין שזה יכול להיות קצת קשה לראות מדוע הגבלת הפרמטרים יכולה לגרום לתוצאה הזו, אבל אם תיישמו בעצמכם פונקציה עם הסדרה תוכלו לראות את האפקט הזה ממקור ראשון. ברגרסיה ליניארית מוסדרת, אם פרמטר ההסדרה למבדה מוגדר להיות גדול מאוד, אז מה שיקרה הוא שאנו עשויים להגביל את הפרמטרים תטא-1, תטא-2, תטא-3, תטא-4 בצורה מאוד חזקה. כלומר, אם פונקצית ההשערה שלנו היא זו שכתובה כאן למטה, ואם אנחנו מגבילים מאוד את תטא-1, תטא-2, תטא-3, תטא-4, אז אנחנו נקבל בתוצאה הסופית שכל אחד ואחד מהפרמטרים האלה יהיה קרוב לאפס, נכון? תטא-1 יהיה קרוב לאפס; תטא-2 יהיה קרוב לאפס. תטא-3 ותטא-4 יהיו מאד קרובים לאפס. ואם נעשה את זה, זה כאילו שאנחנו בעצם מבטלים לגמרי את המונחים האלו מן ההשערה ואנחנו פשוט נשארים עם השערה שאומרת שמחירי הדירות שווים תטא-0, וזה כאילו בנינו התאמה של קו ישר אופקי שטוח לנתונים. וזו דוגמא ברורה להתאמת-חסר, ובמקרה של ההשערה המסוימת הזאת, הקו הישר הזה פשוט נכשל בלהתאים היטב לסדרת האימון. זה פשוט קו ישר שלא מצליח להתקרב, לא מתקרב בכלל לרוב דוגמאות האימון. ודרך מקובלת אחרת לומר את זה הוא שההשערה הזו יש לה דעה קדומה חזקה מדי או הטיה גבוהה מדי שמחירי הדירות הם פשוט תמיד תטא-0, ולמרות שהיא רואה נתונים ברורים שמראים את ההיפך, היא בוחרת להתאים קו שטוח, קו אופקי שטוח. אני לא ציירתי את זה הכי טוב. אבל זה פשוט קו ישר אופקי. כדי שההסדרה תעבוד היטב, צריך להקפיד ולבחור בצורה טובה את פרמטר ההסדרה למבדה. וכשנדבר בהמשך הקורס הזה על בחירה אוטומטית, נדבר גם על דרך, או מגוון דרכים לבחירה פרמטר ההסדרה למבדה באופן אוטומטי. אז זה הרעיון של ההסדרה ושל פונקצית המחיר בה נשתמש במטרה להפעיל את ההסדרה. בשני הסרטונים הבאים, הבה ניקח את הרעיונות הללו וניישם אותם על רגרסיה ליניארית ורגרסיה לוגיסטית, כך שנוכל לגרום להם להימנע מהתאמת-יתר.