בסרטון הקודם, דיברנו על הצינור של OCR מצילום וכיצד זה עובד. שם לקחנו תמונה והעברנו אותה דרך רצף של רכיבי למידת מכונה על מנת לנסות לקרוא את הטקסט המופיע בתמונה. בסרטון זה הייתי רוצה לדבר קצת יותר על אופן העבודה של הרכיבים השונים של הצינור. בעיקר, רוב הסרטון הזה יתרכז בדיון של מה שנקרא מסווג חלונות מחליקים או נעים - sliding windows. השלב הראשון בצינור שלנו הוא זיהוי טקסט שבו אנחנו מסתכלים על תמונה כזו ומנסים למצוא את אזורי הטקסט המופיעים בתמונה זו. זיהוי טקסט הוא בעיה יוצאת דופן בראייה ממוחשבת. כי בהתאם לאורך הטקסט שאנחנו מנסים למצוא, למלבנים האלה שאנחנו מנסים למצוא יכול להיות יחס גובה-רוחב שונה. אז כדי לדבר על גילוי של דברים כלשהם בתמונות נתחיל עם דוגמא פשוטה יותר של זיהוי הולכי-רגל ולאחר מכן נחזור אל הרעיונות שפותחו בזיהוי הולכי-רגל וניישם אותם לזיהוי טקסט. אז בזיהוי של הולכי-רגל אנחנו רוצים לקחת תמונה שנראית ככה ולמצוא את הולכי הרגל השונים המופיעים בתמונה. אז הנה הולך רגל אחד שמצאנו, הנה השני, השלישי, הרביעי, החמישי והששי. הבעיה הזו אולי קצת יותר פשוטה מאשר זיהוי טקסט רק מכיוון שיחס הממדים של רוב הולכי הרגל די דומה. מה שאומר שאנחנו נשתמש ביחס גובה-רוחב קבוע עבור המלבנים האלה שאנחנו מנסים למצוא. כשאני אומר יחס ממדים אני מתכוון ליחס בין הגובה והרוחב של המלבנים האלה. כאן כולם אותו דבר עבור הולכי הרגל השונים אבל בזיהוי טקסט יש יחס גובה-רוחב שונה עבור שורות שונות של טקסט. למרות שבאיתור הולכי רגל, הולכי הרגל יכול להיות במרחקים שונים מן המצלמה ולכן הגובה של המלבנים האלה יכול להיות שונה בהתאם למרחקם, עדיין יחס הממדים יהיה זהה. כדי לבנות מערכת לזיהוי הולכי-רגל הנה שיטה לבנות אותה. נניח שאנחנו מחליטים לעבוד בסטנדרט כזה של 82 על 36 והיינו יכולים לבחור איזה ערכים מעוגלים כמו 80 על 40 או משהו כזה, אבל 82 על 36 נראה שעובד טוב. מה שהיינו עושים עכשיו הוא לאסוף ערכת אימון גדולה של דוגמאות חיוביות ושליליות. הנה דוגמאות של קטעי תמונה בגודל 82x26 שמכילים הולכי רגל והנה דוגמאות של תמונות שלא. בשקופית הזו אני מראה 12 דוגמאות חיוביות של y=1 ו-12 דוגמאות של y=0. ביישום טיפוסי יותר לזיהוי הולכי רגל, ייתכן שיהיה לנו מספר של בין 1000 דוגמאות הדרכה ועד אולי 10,000 דוגמאות הדרכה, או אפילו יותר אם אפשר להשיג ערכות אימון אפילו גדולות יותר. ומה שאפשר אז לעשות הוא לאמן רשת עצבית או איזה אלגוריתם למידה אחר שיקבלו כקלט פיסות תמונה בגודל 82 על 36, ולסווג כל פיסת תמונה כמכילה הולך-רגל או לא . וזה נותן לנו דרך להחיל למידה בפיקוח על מנת לקחת פיסות תמונה ולקבוע האם הולכי רגל מופיעים או לא בפיסת התמונה. עכשיו, נניח שאנחנו מקבלים תמונה חדשה, תמונה מסדרת המבחן, תמונה כמו זאת, ואנחנו רוצים לנסות למצוא הולכי רגל המופיעים בתמונה. מה שהיינו עושים הוא להתחיל בהגדרת שטח מלבני בתמונה זו. כמו זה שמוצג כאן, אז אולי זה אזור של 82 על 36 בתמונה הזו, ונריץ את פיסת התמונה דרך המסווג שלנו כדי לקבוע אם יש בתמונה הולכי רגל בפיסת התמונה, ואנו מקווים שהמסווג שלנו יחזיר y שווה 0 עבור הפיסה הזו, כי אין בה הולכי רגל. לאחר מכן, אנחנו לוקחים את המלבן הירוק הזה ומחליקים אותו קצת ואז מעבירים את הפיסה החדשה של התמונה דרך המסווג שלנו כדי להחליט אם יש שם הולך רגל. ואחרי שעשינו את זה, אנחנו מחליקים את החלון עוד יותר ימינה ומעבירים את הפיסה החדשה דרך המסווג שוב. הכמות שבה אנחנו מחליקים את המלבן כל פעם היא פרמטר, הוא נקרא לפעמים פרמטר גודל הצעד, ולפעמים גם נקרא פרמטר ההחלקה, ואם הגודל של הצעד הוא פיקסל אחד בכל פעם, אפשר להשתמש בגודל צעד של 1, אז זה בדרך כלל נותן את התוצאות הטובות ביותר, אבל הוא יותר יקר מבחינה חישובית, ולכן שימוש בגודל צעד של אולי 4 פיקסלים בכל פעם, או שמונה פיקסלים בכל פעם או מספר גדול של פיקסלים עשוי להיות נפוץ יותר, שכן כך מזיזים את המלבן קצת יותר בכל פעם. אז באמצעות התהליך הזה, ממשיכים להצעיד את המלבן ימינה קצת בכל פעם ומעבירים כל אחת מהפיסות האלה דרך המסווג, עד שלבסוף, כאשר סיימנו להצעיד את החלון על פני כל המיקומים השונים בתמונה, תחילה בשורה העליונה ולאחר מכן דרך שורות נוספות בתמונה, בעצם העברנו דרך כל הפיסות בתמונה בצעדים כלשהם דרך המסווג. עכשיו, זה היה מלבן קטן למדי, והיה מצליח רק לזהות הולכי רגל בגודל מסוים אחד. מה שאנחנו עושים עכשיו הוא להתחיל להסתכל על פיסות תמונה גדולות יותר. אז עכשיו בואו ניקח תמונות גדולות יותר, כמו אלה המוצגות כאן ונריץ גם אותם דרך המסווג. ודרך אגב כשאני אומר לקחת פיסות תמונה גדולות יותר, מה שאני מתכוון בעצם הוא לקחת פיסות תמונה כאלה, ולשנות את הגודל שלהם ל-82 על 36, נניח. אנחנו לוקחים את הפיסה הגדולה ומצמצמים את גודלה להיות תמונה קטנה יותר והתמונה הקטנה יותר היא מה שאנחנו מעבירים דרך המסווג שלנו כדי לנסות ולהחליט אם יש הולך רגל באותה פיסה. ואז אפשר לעשות את זה בקנה מידה גדול עוד יותר ושוב להריץ חלונות בגודל כזה דרך המסווג, ואחרי כל התהליך יש לקוות שהאלגוריתם שלנו יזהה אם ישנם הולכי רגל בתמונה. אז כך מאמנים מסווג, ולאחר מכן משתמשים במסווג עם חלונות נעים, או בגלאי של חלונות נעים, כדי למצוא הולכי רגל בתמונה. בואו נחזור אל דוגמת זיהוי הטקסט ונדבר על השלב הזה ב-OCR מצילום שלנו, שבו המטרה שלנו היא למצוא את אזורי הטקסט בתמונה. בדומה לזיהוי הולכי רגל אפשר להגדיר סדרת הדרכה מתויגת שבה יש דוגמאות חיוביות ודוגמאות שליליות כשהדוגמאות החיוביות מקבילות לאזורים שבהם מופיע טקסט. אז במקום לנסות לזהות הולכי רגל, אנחנו מנסים עכשיו לזהות טקסטים. ודוגמאות חיוביות תהיינה פיסות של תמונות שבהן יש טקסט. ודוגמאות שליליות תהיינה פיסות של תמונות שבהן אין טקסט. אחרי שעשינו את ההכשרה זו אנו עכשיו יכולים לנסות אותה על תמונה חדשה, על תמונה מסדרת הבדיקה. אז הנה התמונה שבה השתמשנו כדוגמה. עכשיו, בפעם האחרונה שהרצנו..., בדוגמה הזו אנחנו נריץ חלונות נעים רק בקנה מידה אחד קבוע רק לצורך ההדגמה, כלומר אני אשתמש רק במלבן בגודל אחד. אבל בואו נניח שאני מפעיל את מסווג החלונות הנעים שלי על הרבה פיסות תמונה קטנות כמו כאן, אם נעשה את זה, נקבל בסופו של דבר תוצאה כזו שבה האזורים הלבנים הם המקומות שבהם זיהתה מערכת זיהוי הטקסטים שלנו טקסט, הצירים של שתי התמונות האלה הם זהים. אז האזור כאן למעלה מתאים לאזור כאן למעלה, אז העובדה שהאזור הזה שחור פירושה שהמסווג לא חשב שיש שם טקסט, בעוד שהעובדה שיש פה הרבה כתמים לבנים משקפת את העובדה שהמסווג חשב ששם נמצאים קבוצה של קטעי טקסט, שם על התמונה. מה שעשיתי על התמונה הזאת משמאל למטה הוא בעצם להשתמש בצבע לבן כדי להראות איפה המסווג חושב שהוא מצא טקסט. וגוונים שונים של אפור תואמים להסתברות שהמסווג הוציא כפלט, אז גווני אפור חלשים יותר מתאימים למקומות שבהם הוא חשב שהוא אולי מצא טקסט, אבל לא היה לו ביטחון גבוה, לעומת זאת האזורים האפורים הבהירים הם אזורים שבהם המסווג מצא טקסט בהסתברות גבוהה מאוד, הסתברות גבוהה שיש טקסט באזור הזה. עדיין לא ממש סיימנו כי מה שאנחנו בעצם רוצים לעשות הוא לצייר מלבנים סביב כל האזור שבו יש טקסט בתמונה, אז אנחנו נעשה צעד אחד נוסף שבו אנחנו ניקח את הפלט של המסווג ונפעיל עליו מה שנקרא אופרטור הרחבה. מה שזה עושה הוא לקחת את התמונה כאן, והוא לוקח כל אחד מהכתמים הלבנים האלה, כל אחד מהאזורים הלבנים, והוא מרחיב את האזורים הלבנים. מבחינה מתמטית, השיטה ליישם את זה היא, אם תסתכלו על התמונה מימין, מה שאנחנו עושים כדי ליצור את התמונה בצד ימין היא, לגבי כל פיקסל אנחנו שואלים, האם הוא במרחק מסוים מפיקסל לבן בתמונה השמאלית. אז אם פיקסל מסוים נמצא בתוך, למשל, חמישה פיקסלים או עשרה פיקסלים מפיקסל לבן בתמונה השמאלית, אנחנו נצבע את הפיקסל הזה בלבן בתמונה הימנית. אז ההשפעה של זה היא שאנחנו ניקח כל אחד מהכתמים הלבנים בתמונה השמאלית ונרחיב אותם קצת, נגדיל אותם קצת אם אנחנו רואים שפיקסלים סמוכים הם פיקסלים לבנים, ואז נצבע גם את הפיקסלים הסמוכים האלה בלבן. וסופסוף, כמעט סיימנו. עכשיו אנחנו יכולים להסתכל על התמונה מימין ופשוט נסתכל על הרכיבים המחוברים, נסתכל על האזורים הלבנים הרציפים ונצייר תיבות תוחמות סביבם. ובפרט, אם נסתכל על כל האזורים הלבנים, כמו זה, זה, זה וכן הלאה, ואם נשתמש בהיוריסטיקה פשוטה כדי לשלול מלבנים שיחסי הגודל שלהם נראים מוזרים, כי אנחנו יודעים שקופסאות מסביב לטקסט צריכים להיות הרבה יותר רחבים מאשר גבוהים. אז אם נתעלם מהכתמים הדקים והגבוהים כמו זה וכמו זה, ואנחנו מתעלמים מאלה כי הם גבוהים מדי ורזים מדי, ואז אנחנו מציירים מלבנים מסביב לאלה שיחס הגובה לרוחב שלהם מתאים לאזורי טקסט, אז אנחנו מציירים מלבנים, או תיבות שתוחמות את אזור הטקסט הזה, אזור הטקסט הזה, אזור הטקסט, שמתאים ללוגו של "לולה B קניון עתיק", לולה B, והשלט הקטן הזה של "פתוח". שנמצא שם. הדוגמה הזאת בעצם מפספסת פיסת טקסט אחת. זה מאוד קשה לקריאה, אבל יש שם פיסת טקסט אחת. שאומרת "סרטים..." שמתאים לאזור הזה אבל מכיוון שיחס הממדים שם נראה לא מתאים, השמטנו את זה. אז עשינו עבודה יחסית טובה על התמונה הזו, אבל בדוגמה הספציפית הזו המסווג למעשה החמיץ פיסת טקסט אחת. קשה מאוד לקרוא כי זה קטע טקסט שנכתב על גבי חלון שקוף. אז זה היה זיהוי טקסט באמצעות חלונות מחליקים. ואחרי שמצאנו את המלבנים האלה עם הטקסט שבתוכם, עכשיו אנחנו יכולים פשוט לגזור את אזורי התמונה האלה ואז להשתמש בשלבים המאוחרים יותר של הצינור כדי לנסות לפענח את הטקסטים. עכשיו, אתם זוכרים שהשלב השני בצינור היה הפרדת התווים, כשנתונה תמונה כמו זו שמוצגת למעלה, איך נפריד לתווים בודדים בתמונה? אז מה שאנחנו יכולים לעשות הוא שוב להשתמש באלגוריתם למידה בפיקוח עם איזה ערכה של חיוביים וקבוצה של דוגמאות שליליות, שיסתכלו על פיסות תמונה וינסו להחליט אם יש פיצול בין שני תווים ממש באמצע של הפיסה. אז עבור כל דוגמא חיובית, בדוגמא החיובית הראשונה התמונה הזאת נראית כאילו באמצע שלה אכן יש פיצול בין שני תווים ובדוגמה השנייה שוב זה נראה כמו דוגמה חיובית, כי אם אני אפצל אותה לשני תווים על ידי ציור של קו באמצע, זה הדבר הנכון לעשות. אז אלה דוגמאות חיוביות, כאשר באמצע התמונה יש פער או מרחק בין שני תווים נפרדים, ואילו הדוגמאות השליליות, ובכן, לא נרצה לפצל תווים בדיוק באמצע שלהם, אז אלה הן דוגמאות שליליות כי הן אינן מייצגות את נקודת האמצע בין שני תווים. אז מה שאנחנו נעשה הוא לאמן מסווג, אולי באמצעות רשת נוירונים, או אולי באמצעות אלגוריתם למידה שונה, כדי לנסות לסווג בין דוגמאות חיוביות ושליליות. לאחר שלימדנו מסווג כזה, נוכל להפעיל את זה על הסוג של טקסט שמערכת זיהוי הטקסטים שלנו זיהתה. אז אנחנו מתחילים בלהסתכל על המלבן הזה, ואנחנו שואלים, "וואללה, האם נראה לנו שבאמצע המלבן הירוק הזה, זה נראה כמו נקודת האמצע בין שני תווים?" אנחנו מקווים שהמסווג יאמר לא, ואז אנחנו מחליקים את החלון קצת ימינה וזה מסווג של הזזות חלון חד-ממדיות, כי אנחנו מחליקים את החלון רק בקו ישר משמאל לימין, אין כאן שורות שונות. יש פה רק שורה אחת. אבל עכשיו, כשהמסווג נמצא בעמדה הזו, אנו שוב שואלים, טוב, האם אנחנו צריכים לפצל את שני התווים או האם אנחנו צריכים לשים פיצול באמצע המלבן הזה. ואנו מקווים שהמסווג ייתן לנו פלט של y שווה אחד, ובמקרה הזה אנחנו נחליט לצייר כאן קו, כדי לנסות ולפצל בין שני תווים. ואז אנחנו מחליקים את החלון שוב, מריצים את המסווג שאומר לא, מחליקים שוב, המסווג אומר כן, תחתוך שם וכך הלאה, ואנחנו מחליקים את המסווג ימינה לאט ומקווים שזה יסווג את הרווח הבא כעוד דוגמה חיובית וכן הלאה. ואנחנו מחליקים את החלון הזה ימינה, ומפעילים את המסווג בכל שלב, ומקווים שהוא ייתן לנו את המיקומים הנכונים לפצל את האותיות האלה, פשוט לפצל את התמונה הזאת לתווים בודדים. אז כך עושים הזזת חלונות 1D עבור הפרדת תווים. אז הנה שוב התמונה הכוללת של צינור ה-OCR מצילום. בסרטון הזה דיברנו על שלב זיהוי הטקסט, שבו אנו משתמשים בחלונות מחליקים כדי לזהות טקסט. ואנחנו משתמשים גם בהזזת חלונות חד מימדית כדי לעשות הפרדת תווים כדי להפריד את תמונת הטקסט הזאת לתווים בודדים. השלב האחרון בצינור הוא שלב זיהוי התווים, השלב הזה אמור להיות כבר הרבה יותר מוכר לכם מקטעי וידאו מוקדמים בקורס על למידה בפיקוח שבה אפשר ליישם למידה בפיקוח סטנדרטית אולי ברשת נוירונים או אולי במשהו אחר כדי לקחת כקלט תמונה כזאת, ולסווג איזה אות באלפבית או איזו אות מתוך 26 התווים A עד Z, או אולי אנחנו צריכים לדבר על 36 תווים יש גם ספרות, זו פשוט בעיית סיווג רב-מחלקתית שבה לוקחים כקלט תמונה המכילה תו וצריך להחליט איזה תו מופיע בתמונה. אז זה היה צינור ההפעלה של OCR מצילום ואיך אפשר להשתמש ברעיונות כמו מסווג של חלונות מחליקים כדי להרכיב את הרכיבים השונים הדרושים כדי לפתח מערכת OCR מצילום. בקטעי הוידאו הספורים הבאים אנו נמשיך להשתמש בבעיה של OCR מצילום כדי לחקור כמה נושאים מעניינים סביב הבנייה של יישום כזה.