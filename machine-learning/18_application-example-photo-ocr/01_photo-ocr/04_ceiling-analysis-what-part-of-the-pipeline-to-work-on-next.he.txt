בסרטונים קודמים, אמרתי שוב ושוב שכאשר מפתחים מערכת לימוד מכונה, אחד המשאבים היקרים ביותר הוא הזמן של המפתח, במונחים של בחירת על מה לעבוד בשלב הבא. מצד שני, אם יש לכם צוות של מפתחים או צוות של מהנדסים שעובדים יחד על מערכת למידה חישובית, גם כאן, אחד המשאבים היקרים ביותר הוא הזמן של המהנדסים או המפתחים העובדים על המערכת. ומה שבהחלט רצוי להימנע ממנו הוא שאתה או עמיתיך וחבריך תשקיעו המון זמן בעבודה על רכיב כלשהו. רק כדי להבין לאחר שבועות או חודשים של השקעה של זמן, שכל מה שעשיתם פשוט לא ממש משנה מבחינת הביצועים של המערכת הסופית. בסרטון הזה אני רוצה לעשות משהו שנקרא ניתוח תקרה. כאשר אתה או הקבוצה שלך עובדים על מערכת צינור של למידת מכונה, זה יכול לפעמים לתת לכם אות חזק מאוד, הכוונה חזקה מאוד לגבי אילו חלקים של הצינור כנראה הם הניצול הטוב ביותר של הזמן שלכם. כדי לדבר על ניתוח תקרה אני אמשיך להשתמש בדוגמה של צינור ה-OCR מצילום. וכל אחת מהתיבות האלה, זיהוי טקסט, הפרדת תווים, זיהוי תווים, כל תיבה כזו יכול להיות שאפילו צוות הנדסה קטן עובד על זה. או אולי המערכת כולה נבנית על ידיך, כך או כך. אבל השאלה היא איפה כדאי להקצות משאבים? באילו מהתיבות האלה הכי שווה את המאמץ לנסות לשפר ביצועים. כדי להסביר את הרעיון של ניתוח תקרה אני אמשיך להשתמש בדוגמה של צינור ה-OCR מצילום. כפי שציינתי קודם לכן, כל אחת מהתיבות כאן, כל אחד מהרכיבים האלה של מכונת למידה חישובית, יכול להיות עבודה של צוות קטן של מהנדסים, או שכל המערכת יכולה להיבנות על ידי אדם אחד בלבד. אבל השאלה היא, איפה כדאי להקצות את המשאבים הנדירים. כלומר, אילו מהרכיבים האלה, איזה אחד או שניים או אולי כל שלושת המרכיבים האלה הוא הדבר שהכי שווה להשקיע בו את הזמן כדי לנסות לשפר את ביצועיו. אז הנה הרעיון של ניתוח התקרה. כמו בתהליך הפיתוח של מערכות למידת מכונה אחרות, גם כאן, על מנת לקבל החלטות מה לעשות כדי לפתח את המערכת, זה יהיה מאוד מועיל אם יש מספר ממשי אחד שישמש כהערכה או מדד עבור מערכת הלמידה. אז נניח שאנחנו בוחרים בדיוק ברמת התו. דהיינו, אם אתה מקבל תמונה מערכת המבחן, מהו האחוז של התווים בתמונת הבדיקה שאנו מזהים כראוי? או שאפשר לבחור מדדי הערכה אחרים שהם מספר ממשי, אם אתה רוצה. אבל נניח עבור מדד ההערכה שאותו בחרנו, אנחנו מגלים שלמערכת הכוללת כרגע יש 72% דיוק. במילים אחרות, יש לנו קבוצה של תמונות של סדרת מבחן. ועל כל תמונה בסדרה, אנו מפעילים את השלבים של זיהוי טקסט, והפרדת תווים, ואז זיהוי תווים. ואנו מוצאים כי על סדרת הבדיקה שלנו, הדיוק הכולל של המערכת כולה היה 72% במדד ההוא שבחרנו. עכשיו הנה הרעיון מאחורי ניתוח התקרה, והוא זה. אנחנו נעבור, נניח, על המודול הראשון של מכונת הלמידה החישובית שלנו, נניח זיהוי טקסט. ומה שאנחנו הולכים לעשות הוא לשחק עם סדרת הבדיקה. אנחנו הולכים לסדרת המבחן. עבור כל דוגמה בדיקה, אנחנו פשוט נספק למודול את הפלט הנכון, במילים אחרות, אנחנו נעבור על סדרת הבדיקה ופשוט נספר ידנית לאלגוריתם איפה נמצא הטקסט בכל אחת מדוגמאות הבדיקה. במילים אחרות אנחנו מדמים מצב שבו יש לנו מערכת זיהוי טקסט עם דיוק מאה אחוז לצורך זיהוי טקסט בתמונה. ובעצם הדרך לעשות את זה היא די פשוטה, נכון? במקום לתת לאלגוריתם הלמידה לזהות את הטקסט בתמונות. אתה פשוט הולך לתמונות ורושם באופן ידני מה המיקום של הטקסט בתמונות הבדיקה. ואז אתה מוסיף את התוויות הנכונות האלה, תוויות מדגם האמת של היכן נמצא הטקסט, להיות חלק מסדרת הבדיקה. ופשוט משתמש בתוויות האמת האלה כקלט לשלב הבא של הצינור, החלק של הפרדת התווים. טוב, אז רק נאמר זאת שוב. כשאני מסמן וי כאן, מה שאני מתכוון הוא שאני רושם בתוך סדרת המבחן עצמה את התשובות הנכונות. נותן לה את התוויות הנכונות עבור החלק של זיהוי טקסט בצינור. אז זה כאילו יש לי מערכת מושלמת לזיהוי טקסט על סדרת הבדיקה. ואז מה שאנחנו צריכים לעשות הוא להריץ את הנתונים דרך שאר חלקי הצינור. דרך הפרדת התווים וזיהוי התווים. ואז להשתמש באותו מדד הערכה כמו קודם, כדי למדוד מה היה הדיוק הכולל של המערכת כולה. ועם שיטה מושלמת לזיהוי טקסט, אנחנו מקווים שהביצועים ישתפרו. ובדוגמה זו, נניח שזה עלה ל-89%. ואז אנחנו הולכים להמשיך, אז בואו נעשה את השלב הבא בצינור, הפרדת התווים. אז שוב אנחנו משנים את ערכת הבדיקה, ונותנים לדוגמאות את התשובות הנכונות לזיהוי טקסט וגם את התשובות הנכונות של הפרדת התווים. הולכים לסדרת הבדיקה ומכניסים ידנית את ההפרדה הנכונה של הטקסט לתווים בודדים, ואז רואים כמה זה עוזר. ונניח שזה מעלה את הדיוק ל-90% עבור המערכת הכוללת. נכון? אז כמו תמיד אנחנו מדברים על הדיוק של המערכת הכוללת. את הפלט הסופי של מערכת זיהוי התווים. יהיה מה שיהיה הפלט הסופי של כל הצינור, זה הדבר שאת הדיוק שלו אנחנו מודדים. ולבסוף אני הולך למערכת זיהוי התווים ונותן גם לו את התוויות הנכונות, ואז, כמובן אני אמור לקבל 100% דיוק. הדבר הנחמד בניתוח הזה הוא שעכשיו אנחנו יכולים להבין מהו פוטנציאל הרווח של שיפור כל אחד מהמרכיבים האלה. אז אנחנו רואים שאם נגיע לזיהוי טקסט מושלם, הביצועים שלנו יעלו מ-72% ל-89%. אז זה רווח ביצועים של 17%. אז זה אומר שאם ניקח את המערכת הנוכחית שלנו ונבלה הרבה זמן בשיפור זיהוי הטקסט, זה אומר שאנחנו יכולים לשפר את הביצועים של המערכת שלנו ב-17%. זה נראה כאילו זה ממש שווה את הזמן שלנו. ולעומת זאת, כאשר המשכנו הלאה מזיהוי טקסט ועשינו הפרדת תווים מושלמת, הביצועים עלו רק ב 1%, אז זו הודעה פחות שמחה. זה אומר שלא משנה כמה זמן נבלה על הפרדת תווים. אולי פוטנציאל הרווח יהיה די קטן, ואולי לא כדאי לבזבז צוות גדול של מהנדסים בעבודה על הפרדת תווים. סוג זה של ניתוח מראה כי אפילו אם תצליח להגיע להפרדת תווים מושלמת, הביצועים יעלו רק באחוז אחד. זה עושה הערכה מהי התקרה, או מהו הגבול העליון של כמה אפשר לשפר את הביצועים של המערכת בעבודה על אחד מהמרכיבים האלה. ולבסוף, זיהוי תווים, כאשר השגנו זיהוי תווים מושלם, הביצועים עלו ב-10 אחוזים. אז עכשיו אתה יכול להחליט לגבי שיפור של עשרה אחוזים, כמה זה שווה את הזמן שלך? זה אומר לך שאולי עם מאמץ נוסף בשלב האחרון של הצינור, אתה יכול לשפר את הביצועים של המערכת. דרך נוספת לחשוב על זה היא שעל ידי ניתוח מהסוג הזה אתה מנסה להבין מה פוטנציאל השיפור של כל אחד מהרכיבים האלה. או כמה אפשר להרוויח אם אחד מהמרכיבים האלה נעשה לגמרי מושלם. וזה באמת מציב גבול עליון על הביצועים של המערכת. אז הרעיון של ניתוח התקרה הוא די חשוב, תנו לי להדגים את הרעיון הזה שוב אבל עם דוגמה אחרת, דוגמא מורכבת יותר. נניח שאתה רוצה לעשות זיהוי פנים מתמונות. אתה רוצה להסתכל על התמונה ולזהות האם האדם בתמונה הזו הוא חבר מסוים שלך או לא, לנסות לזהות מיהו האדם המוצג בתמונה הזו. זוהי דוגמה מלאכותית במקצת, זה לא ממש איך שזיהוי פנים נעשה בפועל. אבל אנחנו רוצים להגדיר דוגמה של איך עשוי להיראות צינור, לתת לכם דוגמה נוספת של איך עשוי להיראות תהליך ניתוח התקרה. אז יש לנו תמונה ממצלמה, ונניח שאנחנו מתכננים צינור כדלקמן, הדבר הראשון שנרצה לעשות הוא עיבוד מוקדם של התמונה. אז בואו ניקח את התמונה הזאת כמו שהיא מוצגת בפינה הימנית העליונה, ונניח שאנחנו רוצים להסיר את הרקע. אז עושים עיבוד מקדים והרקע נעלם. הדבר הבא שאנחנו רוצים הוא למצוא את הפנים של האדם, זה נעשה בדרך כלל בלמידת מכונה אז נפעיל מסווג חלונות נעים כדי לצייר מלבן סביב הפנים של האדם. לאחר שזיהינו את אזור הפנים, מתברר כי כשרוצים לזהות אנשים, מתברר שהעיניים הם רמז שימושי מאוד. אנחנו למעשה, במונחים של לזהות את החברים שלנו, מראה העיניים שלהם הוא למעשה אחד הרמזים החשובים ביותר שאנחנו משתמשים בהם. אז בואו ונריץ עוד מסווג כדי למצוא את העיניים של האדם. האזור של העיניים מכיוון שזה ייתן לנו תכונות שימושיות כדי לזהות את האדם. ואז חלקים אחרים של הפנים גם הם מעניינים. אולי נמצא את האף, נמצא את הפה. ואז לאחר שמצאנו את העיניים, האף והפה, כל אלה מעניקים לנו תכונות שימושיות כדי להזין אולי מסווג רגרסיה לוגיסטי. וזה התפקיד של המסווג לתת לנו את התווית הכללית, למצוא את התווית של מי שהוא חושב שזו הזהות של האדם הזה. אז זה מין צינור מסובך, הוא בעצם כנראה יותר מסובך ממה שצריך באמת אם באמת רוצים לזהות אנשים, אבל זו דוגמה שממחישה איך לחשוב על ניתוח התקרה. אז איך עושים ניתוח תקרה במקרה של הצינור הזה. ובכן אנחנו עוברים על החתיכות האלה אחת אחת. נניח שלמערכת הכוללת יש דיוק של 85%. הדבר הראשון שנעשה הוא ללכת לסדרת הבדיקה ובאופן ידני לתת לה את ההפרדה המלאה בין תמונה ורקע. באופן ידני ללכת לסדרת הבדיקה. ולהשתמש בפוטושופ או משהו ופשוט למצוא איפה הרקע ואז להסיר באופן ידני את הרקע מהתמונה, להשאיר תמונה חסרת רקע, ולראות כמה משתנה הדיוק. בדוגמה זו הדיוק עלה ב-0.1%. אז זה רמז ברור שאפילו אם תהיה לנו הפרדת רקע מושלמת, אפילו עם הסרת רקע מושלמת, הביצועים של המערכת לא ישתפרו בהרבה. אז אולי זה לא שווה מאמץ גדול לעבוד על העיבוד המקדים של הסרת רקע. ואז נלך לסדרת הבדיקה וניתן לה את זיהוי הפנים הנכון בתמונה ואז נלך לצעד של זיהוי אזור העיניים האף והפה באיזשהו סדר, פשוט נבחר סדר מסויים. פשוט להכניס את המיקום הנכון של העיניים. המיקום הנכון של האף, המיקום הנכון של הפה, ואז בשלב האחרון אנחנו פשוט ניתן לו את התווית הכוללת הנכונה - דהיינו השם של האדם - ונקבל 100% דיוק. וכשעוברים על המערכת ופשוט נותנים ליותר ויותר רכיבים את התוויות הנכונות בסדרת המבחן, הביצועים של המערכת הכוללת עולים ואפשר לראות עד כמה עלו הביצועים בשלבים שונים. אז בשלב שנתנו לאלגוריתם זיהוי פנים מושלם, זה נראה שהביצועים הכוללים של המערכת עלו ב-5.9%. אז זו קפיצה די גדולה. זה אומר שאולי כדאי להשקיע לא מעט מאמץ על זיהוי פנים טוב יותר. עלה 4% שם, זה עלה 1% שם. 1% שם, 3% שם. אז זה נראה שהרכיבים ששווים הכי הרבה מאמץ הם כשעשינו מערכת זיהוי פנים מושלמת הביצועים עלו ב-5.9%, כאשר בנינו הפרדת עיניים מושלמת קיבלנו ארבעה אחוזים. ואז המסווג הלוגיסטי הסופי שלנו נתן לנו עוד פער של אולי שלושה אחוזים. אז זה אומר לנו מהם הרכיבים שאולי הכי כדאי לעבוד עליהם. ודרך אגב אני רוצה לספר לכם סיפור אזהרה אמיתי. הסיבה שאני שם כאן את שלב העיבוד המקדים של הסרת הרקע היא שאני באמת מכיר סיפור אמיתי שבו היה צוות המחקר של שני אנשים שבילו כשנה וחצי, בילו 18 חודשים בעבודה על הסרת רקע טובה יותר. אני מסתיר את הפרטים מסיבות ברורות, אבל זה היה יישום של ראייה ממוחשבת שבו צוות של שני מהנדסים, פשוטו כמשמעו במשך כשנה וחצי עבדו על הסרת רקע טובה יותר, למעשה המציאו אלגוריתמים מסובכים מאוד ובסופו של דבר גם פרסמו מחקר אחד. אבל אחרי כל העבודה הם מצאו כי זה פשוט לא שינה בהרבה את הביצועים הכוללים של היישום בפועל עליו הם עבדו, ואם מישהו רק היה עושה ניתוח תקרה מקודם אולי הם היו מבינים את זה. ואחד מהם אמר לי אחר כך אם רק היינו עושים את הסוג הזה של ניתוח אולי היינו יכולים להבין את זה לפני שעבדנו על זה 18 חודשים. שהם היו צריכים להשקיע את המאמץ ולהתמקד באיזה מרכיב אחר מאשר פשוטו כמשמעו לבזבז 18 חודשי עבודה על הסרת רקע. אז לסיכום, צינורות הם שיטה נפוצה מאוד ביישומים מורכבים ללמידה חישובית. וכאשר עובדים על יישום גדול בלמידת מכונה, זמן העבודה של המפתח הוא כל כך רב ערך, שפשוט לא כדאי לבזבז את הזמן בעבודה על משהו שבסופו של דבר לא ישנה את התוצאה. בסרטון הזה דיברנו על הרעיון הזה של ניתוח תקרה, שאני מצאתי שלעתים קרובות הוא כלי ממש טוב לזיהוי הרכיבים שבהם באמת כדאי להתמקד כדי לעשות שינוי גדול בתוצאה. הרכיבים שלמעשה תהיה להם השפעה עצומה על הביצועים הכוללים של המערכת הסופית. במשך השנים שבהם אני עובד בלמידה חישובית, למדתי למעשה לא לסמוך על תחושת הבטן שלי לגבי אילו על רכיבים לעבוד. המון פעמים, ואני כבר עוסק בלמידת מכונה במשך זמן רב, לעתים קרובות אני מסתכל על בעיה בלמידת מכונה, ואני מקבל איזו תחושת בטן לגבי אה, בואו נקפוץ על הרכיב הזה ופשוט נשקיע בו את כל הזמן. אבל במשך השנים, למדתי לבטוח בתחושת הבטן שלי שאומרת שאסור בעצם לסמוך על תחושת בטן. במקום זה, אם יש לך בעיה של למידה חישובית שבה אפשר לבנות דברים ולעשות ניתוח תקרה, בדרך כלל זוהי דרך הרבה יותר טובה ואמינה כדי להחליט איפה כדאי למקד את המאמצים כדי באמת לשפר את הביצועים של איזשהו רְכִיב. ולהיות סמוך ובטוח שכאשר אנחנו עושים את זה, תהיה לזה למעשה השפעה ממש גדולה על הביצועים הסופיים של המערכת הכוללת.