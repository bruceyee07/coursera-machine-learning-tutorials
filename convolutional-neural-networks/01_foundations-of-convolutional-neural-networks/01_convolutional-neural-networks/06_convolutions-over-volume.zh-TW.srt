1
00:00:01,000 --> 00:00:05,510
您見過了卷積如何作用在 2D 影像中

2
00:00:05,510 --> 00:00:08,505
現在，我們來看您如何建置卷積

3
00:00:08,505 --> 00:00:10,190
不只是在 2D 影像

4
00:00:10,190 --> 00:00:13,265
而是在 3維度容積上

5
00:00:13,265 --> 00:00:15,610
我們用一個例子開始

6
00:00:15,610 --> 00:00:17,930
假設您想偵測特徵

7
00:00:17,930 --> 00:00:20,920
不只是灰階影像

8
00:00:20,920 --> 00:00:22,550
而是 RGB 影像

9
00:00:22,550 --> 00:00:27,035
所以一個 RGB 影像不只是一個 6乘6 影像

10
00:00:27,035 --> 00:00:29,330
它可能是 6乘6乘3

11
00:00:29,330 --> 00:00:32,980
這裡的 3 指的是三原色通道

12
00:00:32,980 --> 00:00:37,575
您可以將它想成是 3 個 6乘6 影像疊起來

13
00:00:37,575 --> 00:00:41,925
為了要偵測這個影像的邊緣
或者一些其他的特徵

14
00:00:41,925 --> 00:00:43,490
您可以把這個拱起來

15
00:00:43,490 --> 00:00:47,320
而不再只是一個 3乘3 過濾器

16
00:00:47,320 --> 00:00:49,120
像我們之前使用的

17
00:00:49,120 --> 00:00:51,907
但現在也會是一個 3D 過濾器

18
00:00:51,907 --> 00:00:54,865
也就會是 3乘3乘3

19
00:00:54,865 --> 00:01:01,960
所以過濾器本身也會有 3層相對於紅

20
00:01:01,960 --> 00:01:04,897
綠跟藍三原色通道

21
00:01:04,897 --> 00:01:07,180
給這些東西一些名字

22
00:01:07,180 --> 00:01:08,980
這裡第一個 6

23
00:01:08,980 --> 00:01:12,290
這個是影像的高度

24
00:01:12,290 --> 00:01:19,360
這是寬度，而這個 3 是通道的數量

25
00:01:19,360 --> 00:01:24,075
而您的過濾器也同樣有高度

26
00:01:24,075 --> 00:01:27,995
寬度跟通道數目

27
00:01:27,995 --> 00:01:31,170
而通道的數目在

28
00:01:31,170 --> 00:01:35,143
您的影像中應該要
跟您過濾器的通道數目相同

29
00:01:35,143 --> 00:01:38,480
所以這兩個數字要相等

30
00:01:38,480 --> 00:01:42,365
我們會在下一張投影片看到
這樣的卷積如何作用

31
00:01:42,365 --> 00:01:46,740
但這裡的輸出會是一個 4乘4 影像

32
00:01:46,740 --> 00:01:49,600
請注意這是 4乘4乘1

33
00:01:49,600 --> 00:01:53,160
最後這裡不再有 3

34
00:01:53,160 --> 00:02:01,313
我們來詳細介紹一下這個如何作用，
但我們先畫一個比較好看的影像

35
00:02:01,313 --> 00:02:05,365
所以這是一個 6乘6乘3 影像

36
00:02:05,365 --> 00:02:10,030
這是一個 3乘3乘3 過濾器

37
00:02:10,030 --> 00:02:11,830
而最後這個數字

38
00:02:11,830 --> 00:02:17,395
3D 影像跟過濾器的通道數目是相同的

39
00:02:17,395 --> 00:02:22,195
為了簡化這個 3乘3乘3 過濾器

40
00:02:22,195 --> 00:02:26,674
而不是將它像是疊起來的矩陣，我會

41
00:02:26,674 --> 00:02:32,325
有時後把它畫成三維度的立方體，像這樣

42
00:02:32,325 --> 00:02:37,775
為了要計算這個卷積運算的輸出

43
00:02:37,775 --> 00:02:42,440
您要做的是拿這個 3乘3乘3 過濾器

44
00:02:42,440 --> 00:02:45,440
首先將它放在左上角的位置

45
00:02:45,440 --> 00:02:51,026
注意到這個 3乘3乘3 過濾器
有 27 個數字

46
00:02:51,026 --> 00:02:53,988
或者 27 個參數，
是一個三維度立方體

47
00:02:53,988 --> 00:02:56,180
您要做的是拿這裡每一個

48
00:02:56,180 --> 00:03:05,695
27 個數字跟相對於紅，

49
00:03:05,695 --> 00:03:07,425
綠跟藍影像的通道相乘積

50
00:03:07,425 --> 00:03:09,620
所以拿第一個 9 個紅色通道的數字

51
00:03:09,620 --> 00:03:12,080
底下綠色通道的 3 (應該是 9) 個數字

52
00:03:12,080 --> 00:03:13,970
跟綠色通道的 3 （應該是 9) 個數字

53
00:03:13,970 --> 00:03:17,880
然後跟相對應的 27 個數字

54
00:03:17,880 --> 00:03:22,310
在左邊的立方體裡相乘

55
00:03:22,310 --> 00:03:28,615
然後相加，這會給您輸出的第一個數字

56
00:03:28,615 --> 00:03:34,700
然後計算下一個輸出，
您將這個立方體往右滑一格

57
00:03:34,700 --> 00:03:37,190
再一次，做 27 次相乘

58
00:03:37,190 --> 00:03:40,375
將 27 個數字相加

59
00:03:40,375 --> 00:03:42,545
給您下一個輸出

60
00:03:42,545 --> 00:03:44,465
再往下一個

61
00:03:44,465 --> 00:03:45,647
位置的下一個數字

62
00:03:45,647 --> 00:03:49,520
這給您第三個輸出，等等

63
00:03:49,520 --> 00:03:54,080
這給您第四個，然後往下一行，下一個

64
00:03:54,080 --> 00:03:55,930
下一個，下一個

65
00:03:55,930 --> 00:03:58,760
等等，您知道我的意思

66
00:03:58,760 --> 00:04:02,080
直到最後面

67
00:04:02,080 --> 00:04:09,090
這是您會得到最後數字的位置

68
00:04:09,090 --> 00:04:10,741
所以這會讓您做什麼？

69
00:04:10,741 --> 00:04:12,775
這裡有一個例子

70
00:04:12,775 --> 00:04:15,170
這個過濾器是 3乘3乘3

71
00:04:15,170 --> 00:04:20,455
如果您想在紅色通道偵測影像邊緣

72
00:04:20,455 --> 00:04:24,990
您可以用第一個過濾器，1,1,1, 

73
00:04:24,990 --> 00:04:27,840
-1, -1, -1 跟之前一樣

74
00:04:27,840 --> 00:04:31,385
然後綠色通道都為 0

75
00:04:31,385 --> 00:04:35,120
藍色通道也都為 0

76
00:04:35,120 --> 00:04:42,410
如果您將這 3 個疊起來
變成您的 3乘3乘3 過濾器

77
00:04:42,410 --> 00:04:46,040
那這會是一個過濾器來偵測邊緣，

78
00:04:46,040 --> 00:04:49,720
偵測垂直邊緣，但只在紅色通道

79
00:04:49,720 --> 00:04:54,950
或者，如果您並不在意
垂直邊緣在哪一個顏色

80
00:04:54,950 --> 00:04:58,871
那您或許會用一個過濾器像這樣

81
00:04:58,871 --> 00:05:01,520
像這樣 1,1,1, 

82
00:05:01,520 --> 00:05:02,800
-1, -1, -1 

83
00:05:02,800 --> 00:05:04,714
在所有三個通道上

84
00:05:04,714 --> 00:05:08,791
所以用第二種方式做設定，設定這樣的參數

85
00:05:08,791 --> 00:05:10,980
您就會有一個邊緣偵測器

86
00:05:10,980 --> 00:05:12,710
一個 3乘3乘3 邊緣偵測器

87
00:05:12,710 --> 00:05:15,935
在任何顏色上偵測邊緣

88
00:05:15,935 --> 00:05:19,460
而使用不同的參數選擇，您可以得到

89
00:05:19,460 --> 00:05:24,280
從這個 3乘3乘3 過濾器
來偵測不同的特徵

90
00:05:24,280 --> 00:05:26,320
傳統上，在電腦視覺中

91
00:05:26,320 --> 00:05:31,790
當您有一個輸入是一定的高度，一定的寬度

92
00:05:31,790 --> 00:05:33,440
一定數量的通道

93
00:05:33,440 --> 00:05:36,200
您的過濾器可能會用不同的高度

94
00:05:36,200 --> 00:05:39,542
不同的寬度，但是會用同樣數量的通道

95
00:05:39,542 --> 00:05:44,780
理論上，使用一個
或許只用在紅色通道的過濾器是可行的

96
00:05:44,780 --> 00:05:50,776
或許一個只看綠色通道的過濾器，
或者只看藍色的過濾器

97
00:05:50,776 --> 00:05:54,565
再提一次，您注意到三度空間的卷積

98
00:05:54,565 --> 00:06:00,793
一個 6乘6乘3 跟一個 3乘3乘3 卷積

99
00:06:00,793 --> 00:06:07,434
會給您一個 4乘4，2Ｄ的輸出

100
00:06:07,434 --> 00:06:10,629
現在您知道如何卷積一個容積

101
00:06:10,629 --> 00:06:17,125
在建立卷積神經網路時
最後有一個重點

102
00:06:17,125 --> 00:06:20,550
也就是如果我們不只要偵測垂直邊緣呢？

103
00:06:20,550 --> 00:06:23,550
如果我們要偵測垂直邊緣跟水平邊緣呢？

104
00:06:23,550 --> 00:06:27,080
或許45度邊緣，跟或許70度邊緣

105
00:06:27,080 --> 00:06:32,189
換句話說，如果您想同時使用多重過濾器呢？

106
00:06:32,189 --> 00:06:35,640
所以，這個是從前面的投影片來的影像

107
00:06:35,640 --> 00:06:38,380
我們有6乘6乘3 跟一個
3乘3乘3 做卷積

108
00:06:38,380 --> 00:06:39,717
得到一個 4乘4

109
00:06:39,717 --> 00:06:42,420
或許這是一個垂直邊緣偵測器

110
00:06:42,420 --> 00:06:46,023
或許是用來偵測其他的特徵

111
00:06:46,023 --> 00:06:52,950
現在，或許是第二個過濾器，
用橘色來代表

112
00:06:52,950 --> 00:07:00,563
可能是一個水平邊緣偵測器

113
00:07:00,563 --> 00:07:05,657
所以用它來跟第一個過濾器卷積
給您第一個 4乘4 輸出

114
00:07:05,657 --> 00:07:13,565
用它跟第二個過濾器卷積，
給您不同的 4乘4 輸出

115
00:07:13,565 --> 00:07:16,800
我們可以做的是拿者兩個 4乘4 輸出

116
00:07:16,800 --> 00:07:20,770
將第一個放在前面

117
00:07:20,770 --> 00:07:25,069
您可以將第二個過濾器的輸出

118
00:07:25,069 --> 00:07:27,870
放在後面像這樣

119
00:07:27,870 --> 00:07:29,465
將這兩個疊在一起

120
00:07:29,465 --> 00:07:35,970
您最終會有一個 4乘4乘2 的輸出容積

121
00:07:35,970 --> 00:07:39,900
您可以將三度空間畫成一個盒子

122
00:07:39,900 --> 00:07:41,710
我猜會像是這樣

123
00:07:41,710 --> 00:07:45,620
所以這會是一個 4乘4乘2 輸出容積

124
00:07:45,620 --> 00:07:49,740
也就是將您的 6乘6乘3 影像

125
00:07:49,740 --> 00:07:54,885
用這兩個 3乘3乘3 過濾器卷積的結果

126
00:07:54,885 --> 00:07:57,870
造成兩個 4乘4 輸出，然後疊起來

127
00:07:57,870 --> 00:08:02,093
成為一個 4乘4乘2 容積

128
00:08:02,093 --> 00:08:07,830
而這兩個是來自於我們
實際上使用兩個不同的過濾器

129
00:08:07,830 --> 00:08:14,320
所以我們來總結一下關於維度

130
00:08:14,320 --> 00:08:19,570
如果您有一個 n乘n乘通道數量 的輸入影像

131
00:08:19,570 --> 00:08:22,975
所以舉個例子，有一個 6乘6乘3

132
00:08:22,975 --> 00:08:26,960
這個 n下標C 是通道數量

133
00:08:26,960 --> 00:08:31,675
而您用它來卷積一個 f乘f乘，再次

134
00:08:31,675 --> 00:08:34,645
這應該是同樣的 nC,

135
00:08:34,645 --> 00:08:38,360
例子上是 3乘3乘3

136
00:08:38,360 --> 00:08:45,180
而傳統上，這個跟這個會是同樣的數字

137
00:08:45,180 --> 00:08:52,150
然後您會得到的是 n-f+1 乘

138
00:08:52,150 --> 00:08:59,970
n-f+1 乘 您想用這個 nC一撇

139
00:08:59,970 --> 00:09:02,314
實際上是下一層的 nC

140
00:09:02,314 --> 00:09:06,850
也就是您使用過濾器的數目

141
00:09:06,850 --> 00:09:11,895
在我們的例子裡是 4乘4乘2

142
00:09:11,895 --> 00:09:16,335
而我這樣寫的假設是
您使用跨一步而且沒有填充

143
00:09:16,335 --> 00:09:19,270
但如果您使用不同的跨步跟填充

144
00:09:19,270 --> 00:09:22,855
那這個 n-f+1 也會照樣影響到

145
00:09:22,855 --> 00:09:26,245
就像我們在之前影片中看到的

146
00:09:26,245 --> 00:09:29,280
所以這個卷積在容積的想法

147
00:09:29,280 --> 00:09:31,519
實際上很強大

148
00:09:31,519 --> 00:09:34,350
只在一小部分中您可以

149
00:09:34,350 --> 00:09:38,080
直接在 RGB影像 使用這三個通道運算

150
00:09:38,080 --> 00:09:40,485
但更重要的是

151
00:09:40,485 --> 00:09:43,420
您現在可以偵測兩個特徵，像是垂直，水平邊緣

152
00:09:43,420 --> 00:09:46,534
或者 10 個，或者 128 個

153
00:09:46,534 --> 00:09:49,365
或者甚至上百個不同的特徵

154
00:09:49,365 --> 00:09:51,390
而輸出會是一個通道的數字

155
00:09:51,390 --> 00:09:58,405
等於您要偵測的過濾器數量

156
00:09:58,405 --> 00:10:00,995
關於記號

157
00:10:00,995 --> 00:10:07,125
我在文獻中一直使用通道數量
來做為最後這個維度

158
00:10:07,125 --> 00:10:14,620
通常人們會稱這個是 3D 容積的深度，
而這兩種說法

159
00:10:14,620 --> 00:10:17,255
通道或者深度，
在文獻中都常被使用

160
00:10:17,255 --> 00:10:19,375
但我發現用深度比較讓人困惑

161
00:10:19,375 --> 00:10:22,855
因為您通常也會用深度來談神經網路

162
00:10:22,855 --> 00:10:26,885
所以在影片中我將使用通道這個專有名詞來指

163
00:10:26,885 --> 00:10:31,966
也就是這些過濾器的第三個維度

164
00:10:31,966 --> 00:10:36,545
現在您知道如何建立卷積在容積上

165
00:10:36,545 --> 00:10:41,595
您現在已經準備好來建置
一個一層的卷積神經網路

166
00:10:41,595 --> 00:10:44,000
我們在下一個影片來看怎麼做