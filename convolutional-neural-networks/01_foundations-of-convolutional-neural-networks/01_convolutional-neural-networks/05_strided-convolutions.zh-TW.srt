1
00:00:00,630 --> 00:00:04,090
跨步卷積是另一個

2
00:00:04,090 --> 00:00:09,550
卷積神經網路的基本建構基石之一

3
00:00:09,550 --> 00:00:11,156
讓我展示您一個例子

4
00:00:11,156 --> 00:00:16,709
假設您想要用這個 7乘7 影像
卷積這個 3乘3 過濾器

5
00:00:16,709 --> 00:00:19,290
除了用平常的方式

6
00:00:19,290 --> 00:00:23,795
我們用跨兩步來做這件事

7
00:00:23,795 --> 00:00:29,260
意思是您照往常一樣拿這個左上角的

8
00:00:29,260 --> 00:00:35,725
3乘3 區域逐元素乘積然後相加，得到 91

9
00:00:35,725 --> 00:00:39,010
但與其將這個藍色框框往右跨一步

10
00:00:39,010 --> 00:00:41,545
我們一次跨兩步

11
00:00:41,545 --> 00:00:45,996
我們將它一次跨兩步像這樣

12
00:00:45,996 --> 00:00:51,130
注意到這個左上角
如何從這裡到這裡

13
00:00:51,130 --> 00:00:52,825
跳過一個位置

14
00:00:52,825 --> 00:00:59,290
然後您做平常的逐元素乘積跟相加得到 100

15
00:00:59,290 --> 00:01:00,580
然後照樣再做一次

16
00:01:00,580 --> 00:01:04,390
讓這個藍色框框一次跳兩步

17
00:01:04,390 --> 00:01:08,105
您最終在這裡得到 83

18
00:01:08,105 --> 00:01:11,125
現在，當您到下一行

19
00:01:11,125 --> 00:01:13,810
再一次跳兩步而不是

20
00:01:13,810 --> 00:01:17,870
跳一步來移動這個藍色框框

21
00:01:17,870 --> 00:01:24,953
請注意到我們跳過了一步，這給我們 69

22
00:01:24,953 --> 00:01:27,740
現在再一次跳過兩步

23
00:01:27,740 --> 00:01:31,775
這給您 91 等等 127

24
00:01:31,775 --> 00:01:38,250
然後到最後一行，是 44, 72, 74

25
00:01:38,250 --> 00:01:43,615
在這個例子，
我們卷積了一個 7乘7 的矩陣

26
00:01:43,615 --> 00:01:49,530
跟這個 3乘3 矩陣，
我們得到這個 3乘3 輸出

27
00:01:49,530 --> 00:01:54,207
輸出跟輸入維度實際上由下列公式控制

28
00:01:54,207 --> 00:01:56,080
如果您有一個 n乘n 影像

29
00:01:56,080 --> 00:02:00,202
跟一個 f乘f 過濾器卷積

30
00:02:00,202 --> 00:02:09,835
而如果您使用填充 p 跟跨步 s, 在這個例子

31
00:02:09,835 --> 00:02:17,633
s 等於 2, 您最終會得到一個輸出也就是 n+2p-f

32
00:02:17,633 --> 00:02:20,755
因為現在您一次跨 s 步

33
00:02:20,755 --> 00:02:22,455
而不是一次一步

34
00:02:22,455 --> 00:02:29,423
您現在要除以 s +1 然後這邊一樣

35
00:02:29,423 --> 00:02:37,165
在我們的例子，我們有 (7+0-3

36
00:02:37,165 --> 00:02:44,920
除以 2) + 1 等於

37
00:02:44,920 --> 00:02:49,705
(4 除以 2) + 1 等於 3

38
00:02:49,705 --> 00:02:54,062
這是為什麼我們最終會有這個 3乘3 輸出

39
00:02:54,062 --> 00:03:02,115
現在，最後一個細節，如果這個分數不是整數怎麼辦

40
00:03:02,115 --> 00:03:04,405
這種情況下，我們用完全捨去法

41
00:03:04,405 --> 00:03:10,775
這個記號記為某數的地板函數

42
00:03:10,775 --> 00:03:14,395
這也稱為 Ｚ的地板值

43
00:03:14,395 --> 00:03:18,075
意思是拿 Ｚ 捨去小數到最近的整數

44
00:03:18,075 --> 00:03:21,640
實作的方式是您用

45
00:03:21,640 --> 00:03:26,230
這樣的藍色框框作乘積，只有當藍色的框框完全

46
00:03:26,230 --> 00:03:29,740
在影像或者影像加填充內，

47
00:03:29,740 --> 00:03:32,590
如果這個藍色框框的一部份

48
00:03:32,590 --> 00:03:35,935
在影像外面，您就不用做這樣的運算

49
00:03:35,935 --> 00:03:41,080
傳統上您的 3乘3 過濾器

50
00:03:41,080 --> 00:03:44,955
必須完全在您的影像內或者

51
00:03:44,955 --> 00:03:47,110
影像加填充區域內，

52
00:03:47,110 --> 00:03:50,020
在您產生輸出之前，
這是約定的做法

53
00:03:50,020 --> 00:03:55,670
如此，正確計算輸出維度是

54
00:03:55,670 --> 00:04:01,990
如果 (n+2p-f) / s  不是整數則捨去

55
00:04:01,990 --> 00:04:04,205
總結一下，關於維度

56
00:04:04,205 --> 00:04:07,780
如果您有一個  n乘n 矩陣 或者說 n乘n 影像，您跟

57
00:04:07,780 --> 00:04:12,620
一個 f乘f 矩陣，或者說 f乘f 過濾器，
使用填充量 p 跟跨步 s

58
00:04:12,620 --> 00:04:16,993
那輸出大小會是這個維度

59
00:04:16,993 --> 00:04:21,000
我們可以自己選擇這些數字
讓它成為整數

60
00:04:21,000 --> 00:04:27,660
雖然有時你不必這樣做, 
完全捨去也只是可以的

61
00:04:27,660 --> 00:04:32,900
但請自己造一些例子使用不同的  n, f

62
00:04:32,900 --> 00:04:35,850
p 跟 s 值來說服自己

63
00:04:35,850 --> 00:04:41,331
這個公式是正確地算出輸出大小

64
00:04:41,331 --> 00:04:45,880
在繼續之前，我想做一個技術的註解有關於

65
00:04:45,880 --> 00:04:49,480
交叉相關跟卷積的關係，這是為了

66
00:04:49,480 --> 00:04:53,735
您必須這麼做來
建立卷積神經網路的事實

67
00:04:53,735 --> 00:04:59,790
如果您讀了不同的數學教科書，
或者訊號處理教科書

68
00:04:59,790 --> 00:05:05,690
有可能看到一個不一致的記號

69
00:05:05,690 --> 00:05:07,850
如果您看一本典型的數學教科書

70
00:05:07,850 --> 00:05:12,650
卷積運算的定義是
在做逐元素乘積跟相加之前

71
00:05:12,650 --> 00:05:16,370
實際上會先採取另外一個步驟

72
00:05:16,370 --> 00:05:20,550
也就是當這個 6乘6 矩陣跟這個  3乘3 過濾器卷積時

73
00:05:20,550 --> 00:05:24,980
您首先拿這個 3乘3 過濾器，將其

74
00:05:24,980 --> 00:05:30,280
垂直跟水平翻轉, 也就是這個 345, 102, -197

75
00:05:30,280 --> 00:05:38,580
會變成 3 在這裡， 4 到這裡

76
00:05:38,580 --> 00:05:43,070
5 到這裡，而第二行

77
00:05:43,070 --> 00:05:49,660
會變成 102 跟 -197

78
00:05:49,660 --> 00:05:53,120
實際上這是將這個 3乘3 過濾器

79
00:05:53,120 --> 00:05:58,218
垂直跟水平鏡射

80
00:05:58,218 --> 00:06:04,225
然後將這個翻轉過的矩陣
複製到這裡

81
00:06:04,225 --> 00:06:06,175
要計算輸出

82
00:06:06,175 --> 00:06:08,650
您會計算  2 乘 7

83
00:06:08,650 --> 00:06:10,045
加上  3 乘  2

84
00:06:10,045 --> 00:06:15,275
加上  7 乘  5 等等

85
00:06:15,275 --> 00:06:19,910
您應該用這個翻轉過的矩陣來

86
00:06:19,910 --> 00:06:25,415
 計算這個  4乘4 輸出矩陣的左上角

87
00:06:25,415 --> 00:06:31,425
然後用這 9 個數字

88
00:06:31,425 --> 00:06:35,916
跨一步，然後跨一步等等

89
00:06:35,916 --> 00:06:38,990
而在影片中，我們在定義卷積運算

90
00:06:38,990 --> 00:06:43,495
時我們跳過了這個鏡射的運算

91
00:06:43,495 --> 00:06:45,930
技術上而言，我們真正使用的

92
00:06:45,930 --> 00:06:49,360
在前面幾個影片中使用的運算

93
00:06:49,360 --> 00:06:54,180
有時稱為交叉相關而不是卷積

94
00:06:54,180 --> 00:06:57,645
但是在深度學習的文獻中，傳統上

95
00:06:57,645 --> 00:07:01,760
我們稱這個為卷積運算

96
00:07:01,760 --> 00:07:06,215
總結一下，傳統上在機器學習中

97
00:07:06,215 --> 00:07:10,730
我們通常不做這個翻轉的運算，技術上

98
00:07:10,730 --> 00:07:15,200
這個運算或許稱為交叉相關比較好，但大部分

99
00:07:15,200 --> 00:07:20,165
深度學習文獻稱之為卷積運算

100
00:07:20,165 --> 00:07:23,430
我在影片中也會用這個約定稱呼

101
00:07:23,430 --> 00:07:28,155
如果您讀過很多機器學習的文獻

102
00:07:28,155 --> 00:07:30,320
您會發現大部分的人稱這個

103
00:07:30,320 --> 00:07:35,490
為卷積運算而不使用這些翻轉

104
00:07:35,490 --> 00:07:40,120
實際上在訊號處理或者特定的數學中

105
00:07:40,120 --> 00:07:43,615
在卷積的定義中使用翻轉

106
00:07:43,615 --> 00:07:49,870
會導致卷積運算的一種特性，也就是 A跟Ｂ卷積，

107
00:07:49,870 --> 00:07:53,320
再跟Ｃ卷積，會等於Ａ跟 Ｂ卷積Ｃ的卷積

108
00:07:53,320 --> 00:07:58,505
這個在數學上稱為結合率

109
00:07:58,505 --> 00:08:02,080
這在訊號處理應用時很棒，但

110
00:08:02,080 --> 00:08:05,860
對於深度網路學習，這真的不重要，所以

111
00:08:05,860 --> 00:08:08,680
省略這個雙重鏡射的運算會簡化

112
00:08:08,680 --> 00:08:14,450
程式，也讓神經網路照樣工作

113
00:08:14,450 --> 00:08:18,380
傳統上，我們大部分人稱這個為卷積

114
00:08:18,380 --> 00:08:24,240
即使數學家喜歡稱之為交叉相關

115
00:08:24,240 --> 00:08:28,352
但這應該不會影響到您要做的

116
00:08:28,352 --> 00:08:31,860
程式練習，也不該

117
00:08:31,860 --> 00:08:38,222
 影響您閱讀跟理解
深度學習文獻的能力

118
00:08:38,222 --> 00:08:41,600
您見到了如何使用卷積

119
00:08:41,600 --> 00:08:45,715
您也見到了如何使用填充跟跨步到卷積

120
00:08:45,715 --> 00:08:49,795
但目前為止，我們都用卷積在矩陣上

121
00:08:49,795 --> 00:08:51,545
像是 6乘6 矩陣

122
00:08:51,545 --> 00:08:55,670
下一段影片，您將見到如何在容積上使用卷積

123
00:08:55,670 --> 00:08:59,730
而這會讓您使用更強大的卷積運算

124
00:08:59,730 --> 00:09:01,580
讓我們進入下一段影片