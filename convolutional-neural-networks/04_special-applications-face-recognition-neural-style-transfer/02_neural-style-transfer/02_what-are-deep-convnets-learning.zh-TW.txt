深層 ConvNet 實際上真正在學什麼？ 在這部影片，我想和你分享一些視覺化的例子，幫助你 增進你的直覺，了解 ConvNet 深的層究竟在做什麼 這能幫助我們思考脈絡，了解怎麼實作 神經風格轉換 讓我們先從一個例子開始 假設你訓練好了一個 ConvNet，這個架構和 AlexNet 很像 而你想要視覺化呈現每一層的隱藏單元在計算什麼 你可以這樣做 先從第一層的某個隱藏單元開始 假設你看過所有的訓練資料，找出是哪些圖片、 或哪些圖片的部分區域 能讓這個單元的啟動值最大 也就是說，把你的訓練資料傳給神經網路，去觀察 哪一張圖片會讓該單元的啟動值最大 要注意到，一個在第一層的單元 只能看到網路中比較小的區域 所以經過視覺化，如果你畫出什麼東西啟動了那一個單元 你只會畫出圖片的一小塊，這很合理 因為那就是一個隱藏單元能看到的全部 所以如果你挑了一個隱藏單元，然後找出九張能夠 讓該單元啟動值最大的圖，你可能會看到類似這九塊 所以在這個隱藏單元所觀察到的照片的某個區域之中 這單元會尋找像這樣子的邊界或是線條 所以這九塊圖片最能激發出某一個 隱藏單元的啟動值，讓值最大 那麼，接下來你可以選另一個第一層的隱藏單元，做同樣的事 所以這是另一個隱藏單元的。看起來這第二個、 這邊九塊圖片所代表的 看起來這個隱藏單元會尋找那塊區域的線條 我們也可稱之為感受野 (receptive field) 如果你對其他隱藏單元也這樣做，你會發現其他單元 在類似這種的圖片區塊時，更會被激發 這一個似乎喜歡垂直的邊界線 也喜歡左邊是綠色的； 這一個傾向於橘色的 — 這一塊圖片還滿有趣的 這是紅色和綠色混在一起，像是褐色或棕黃色 不過這個神經元看到那圖仍然很樂意被激發。依此類推。 所以這邊是九個具代表性的神經元 對於每個神經元，畫出九塊會造成最大啟動值的圖 這讓你有點感覺：第一層訓練出的隱藏單元 他們常常去尋找 比較簡單的特徵，例如邊界、或是某特定顏色的陰影 在這部影片舉的所有例子 來自於這篇論文：由 Matthew Zeiler 和 Rob Fergus 所著 叫 "Visualizing and Understanding Convolutional Networks"
(視覺化並理解卷積網路) 我用的是比較簡單的方法去視覺化 神經網路的隱藏單元在計算什麼 如果你去讀這篇論文，他們有更細膩的方法 把 ConvNet 在學什麼給視覺化 總之，你重複這樣的流程若干次 跑了第一層的九個隱藏單元 如果同樣的事 你做在網路比較深層的隱藏單元，會怎樣呢？ 神經網路在深一些的層會學到什麼呢？ 在比較深的層，一個隱藏單元會看到圖片比較大的區域 也就是在圖片的那一端 每個像素理論上都能影響到網路的後面幾層 因此，後面幾層的單元，其實能看到比較大塊的圖片區域 不過在投影片中，我還是會把這些區域畫成同樣大小 如果我們重複這樣的程序，前面做過的第一層長這樣 而這個是第二層中，哪些會讓九個隱藏單元的啟動值最大 的視覺化結果 我想說明這視覺化在做什麼 這九塊圖，會讓某個隱藏單元的啟動值很高、很被激發 然後每一組 — 這個是另外一組九塊區域 會讓某個隱藏單元被激發 所以這視覺化的結果顯示出 9 個第二層的隱藏單元 其中每個隱藏單元，這邊顯示了九塊圖，會讓該隱藏單元 的輸出非常大、有非常大的啟動值 你也可以重複這步驟，做在更後面的層 那麼在這張投影片中，要看這一堆小圖 會有點困難，所以讓我放大其中的一些 之前看到的第一層長這樣 例如，這一組是之前看到的第一個單元：如果在輸入圖片的 相對應區域，你能看到這種角度的邊線，那單元就會高度激發 現在我們放大第二層的視覺化結果 這很有趣 看起來第二層會去偵測更複雜的形狀和花樣 例如這個隱藏單元，它看起來在尋找 某種垂直的紋理，有很多條垂直的線 這一個隱藏單元似乎會在左邊有圓形 的時候，被高度激發 這邊這個會尋找非常細的垂直線。諸如此類的 因此，第二層偵測的特徵逐漸變複雜 那第三層呢？ 讓我們放大一下 — 實際上讓我們放更大 這樣你能看更清楚。這些東西最會去激發第三層 不過我們放更大來看。這同樣非常有趣 看起來有某個隱藏單元，對於圖塊左下部份 含有圓形的時候，會高度地回應 所以最終會偵測到很多車 看起來這一個甚至開始在偵測人 而這個看起來在偵測某些材質，像蜂窩狀 或是方格狀、不規則的材質 而這邊有些很難用人眼看的出來在偵測什麼 不過很明顯地在偵測更複雜的樣式了 再下一層呢？ 這是第四層，你看它偵測出的 特徵或是花樣甚至更複雜了 看起來這幾乎就是個狗狗偵測器了 不過這些狗狗看起來都很像對吧 這個... 我不知道這是哪種品種的狗 這些都是狗沒錯，但彼此看起來滿像的 看起來這一個第四層的單元在偵測水 這似乎其實是偵測鳥的腿。諸如此類的 然後第五層，甚至偵測更細膩複雜的東西 你會注意到這裡也有一個神經元像是個狗狗偵測器 但是，這裡偵測出的狗看起來比較多樣 然後這看起來在偵測鍵盤，或有鍵盤花樣的東西 或許背景有很多點點 我猜這個神經元可能在偵測文字，很難確定 然後這一個在偵測花 所以呢，我們走過漫長的路：從偵測比較簡單的東西 例如第一層的邊線，到第二層的花樣 一直到比較深的層偵測出非常複雜的物件 那麼，我希望這能給你更清楚的直覺，體會到 神經網路比較淺和比較深的層分別在計算什麼 接下來，讓我們用這個概念來建構「神經風格轉換」 的演算法