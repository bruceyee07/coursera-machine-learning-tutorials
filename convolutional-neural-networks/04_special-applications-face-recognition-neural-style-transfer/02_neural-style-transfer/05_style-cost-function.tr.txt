Son videoda, nasıl tanımlanacağını gördüğümüz sinirsel stil aktarımı için içerik maliyet fonksiyonudur. Bundan sonra, hadi stil maliyet fonksiyonuna bakalım. yani, görselin tipi (stili) ne demektir? Hadi bu fotoğrafı girdi olarak alalım. Bunun gibi bir convnet (CNN) görüyorlardı, Farklı katmanların olduğu özellikleri hesaplamak. ve L katmanını seçtiğiniz diyelim, Belki bu katman görselin stilinin ölçüsünü belirlemek olabilir. Yapmamız gereken stili belirlemek, korelasyon: Bu katman L aktivasyonundaki farklı kanallar arasındaki aktivasyonlar olabilir. Yani bununla kastettiğim şey budur. Bu katmanı L aktivasyonunu ele aldığınızı varsayalım. Yani bu aktivasyonun nc bloğu tarafından nw'den nh olacak. ve farklı kanallardaki aktivasyonların nasıl korelasyon olduğunu soracağız. Yani bununla ne demek istediğimi açıklamak için biraz şifreli ifade olabilir. Hadi bu aktivasyon bloğunu ele alalım. ve farklı kanalları farklı renklerle gölgelememe izin verin. Yani bu aşağıdaki örnekte, Beş kanal dedik ve bu yüzden burada beş renk tonum var. Örnekte, elbette, Nöral Ağda genellikle beşten fazla kanala sahip oluruz. ama sadece beşini kullanmak çizim yapmayı kolaylaştırır. Fakat bir resmin stilini yakalamak için, Sonrakinde ne yapacaksın? Hadi ilk iki kanala bir göz atalım. Kırmızı kanal ve sarı kanalı bakalım ve İlk iki kanalda aktivasyonlar ne kadar korelasyonlu söyleyelim. Yani, örneğin, sağ alt köşede, İlk kanalda bazı aktivasyonunuz ve ikinci kanalda bazı aktivasyonunuz var. Böylece size sayı çifti verir. Ve yaptığınız şey farklı pozisyonlara bu aktivasyon bloğu boyunca bakmaktır ve sayı çiftlerine bakmaktır. İlk kanalda bir, kırmızı kanal, sarı kanalda bir, ikinci kanal. Ve sadece bu iki çift sayıya bakarsınız ve Tüm bu pozisyonlara genel baktığınız zaman görürsünüz, tüm bu nh (nw pozisyonlarından), Bu iki sayı ne kadar ilişkilidir. Peki, neden bu yakalama stili? Hadi başka örnek yapalım. İşte önceki videodan görselleştirmelerden biri. Bu daha önceden referans aldığım Matthew Zeiler ve Rob Fergus dan geliyor. ve argümanlar uğruna diyelim ki, kırmızı nöron tekabül eder ki, ve argümanlar uğruna diyelim ki, Kırmızı kanalın bu nöronlara karşılık gelmesi için, eğer var mı diye anlamaya çalışıyoruz bu nh deki belirli pozisyonda küçük dikey doku ve bunun ikinci kanal olduğunu söyleyelim. bu sarı ikinci kanal nörona karşılık gelir. Belirsiz şekilde turuncu boyanmış parçalara bakan. Bu iki kanalın yüksek korelasyon göstermesi ne anlama geliyor? eğer yüksek derecede ilişkiliyse, bunun anlamı ne olursa olsun, görüntünün bir kısmı bu tür ince dikey dokuya sahip, Görüntünün o kısmı muhtemelen bu turuncu-msu renk tonuna sahip olacaktır. Ve onların korelasyon göstermemesi ne anlama geliyor? Yani, bu dikey doku olduğunda, Muhtemelen bu kadar turuncu-msu renkte olmayacaktır. ve yani korelasyondan anlayacağımız Bu yüksek seviyeli doku bileşenlerinden hangisinin oluşması veya oluşmaması eğilimi Bir resmin bir parçası ve size verilen korelasyon derecesidir. Bu farklı yüksek seviyeli özelliklerin ne sıklıkla ölçüldüğünü ölçmenin bir yolu, dikey doku veya bu turuncu renk tonu veya başka şeyler gibi, Ne sıklıkla oluşurlar ve ne sıklıkla oluşurlar? birlikte ve görüntünün farklı bölümlerinde birlikte oluşmaz. Ve böylece, stilin ölçüsü olarak kanallar arasındaki korelasyon derecesini kullanırsak, sonra yapabileceğiniz şey, oluşturulan görüntünüzdeki dereceyi ölçmektir. Bu ilk kanal ile ikinci kanalın birbiriyle korelasyonlu veya korelasyonsuz ve bu size oluşturulan görüntüde ne sıklıkta olduğunu söyleyecektir bu dikey doku oluşur veya olmaz Bu turuncu-msu renk tonuyla oluşur ve bu size oluşturulan görüntünün stilinin giriş stili görüntüsünün stiline ne kadar benzediğinin bir ölçüsünü verir. Şimdi bu sezgiyi formalize edelim. Yani yapmanız gereken şey, bir görüntü matrisi olarak adlandırılan bir görüntüyü hesaplamak, Son slaytta konuştuğumuz tüm korelasyonları ölçeceğiz. Daha resmi olarak, üst indis olarak l, alt indis i, j,k pozisyondaki aktivasyonu belirtmek i,j,k gizlenmiş katman l. Yani i yüksekliği indeks eder (gösterir), j genişliği gösterir, ve k karşılıklı değişik kanalları gösterir. Yani, önceki slaytta Bu beş kanalda k bu beş kanalı gösterecek. Yani stil matrisinin yapacağı şey, bir matris cümleleri hesaplamak olacak G üst simge köşeli ayraçlı l. Bu nc boyutlu matris tarafından nc olacak, bu yüzden kare matris olur. Hatırlayın ki kanallarınız var ve böylece her bir çiftin ne kadar korelasyonlu olduğunu ölçmek için nc boyutlu bir matrisiniz var. Yani berilli G,l,k k birincil kanaldaki aktivasyonların nasıl korelasyonlu olduğunu ölçecek k kanalı, k birincil kanalındaki aktivasyonları karşılaştırır k ve k prime 1'den nc'ye kadar değişecek. Bu katmandaki tüm kanalların sayısı. Yani daha resmi olarak, hesaplama yolu G, l ve Bir elemanın hesabı için formülü yazacağım. Yani k, k birincil bunun elemanı Bu i nin toplamı olacak, j nin toplamı, deaktivasyon ve bu katman i, j, k kere i,j,k birincilde aktivasyon. Yani, burda, hatırlayın ki i ve j indeksi bloktaki değişik pozisyonların karşısındadır. yükseklik ve büyüklükteki üzerine indeksler. i, 1'den nh'ye olanların toplamına eşittir.
j, 1'den nw'ye olanların toplamına eşittir. ve k burada ve k birincil indeksi kanalın ötesinde k ve k birincil, sinir ağının bu katmanındaki bir kanalın toplam kanal sayısına kadar değişir. Yani tüm bunların yaptığı görüntüyü yükseklik ve genişlik üzerinde farklı konumlarda toplamak. ve kanaların (k ve k birincil) birlikte aktivasyonlarını çarpmak ve bu G,k,k birincil in dönüşümleridir. Ve bunu, bu matris G'yi hesaplamak için k ve k prime'nin her değeri için yaparsınız. ayrıca stil matrisi olarak adlandırılabilir. Ve dikkat edin ki, eğer bu aktivasyonların her ikisi de birbirine yapışırsa, sonra G,k,k birincil büyük olacaktır. eğer korelasyon olmazsa bu durumda g,k,k birincil küçük olmalıdır. teknik olarak, ben kullanıyordum... korelasyon terimini sezgiyi iletmek için kullanıyordum fakat aslında Bu aslında alanların anormalleşmiş kesişimidir çünkü ortalamayı çıkarmıyoruz ve bu sadece bu elemanlar tarafından doğrudan çarpılıyor. Bu sizin görsel stilini hesaplamanızdır. Ve bunu, hem stil görüntüsü (s,n) için hem oluşturulan görüntü (G) için yapardın. Yani Stil görseli olduğunu ayırt etmek, belki parantez içinde S eklersem, sadece bu resmin stil görseli olduğunu belirtmek için S ve onlar stil görseldeki aktivasyonlardır. ve daha sonra yapmanız gereken aynı şeyi oluşturulan görsel (G) için yapmak. Yani gerçekten aynı şey toplandı ( j, a, i'nin toplamı) j, k, l, a, i, j, k, l ve toplama indisleri aynıdır. Bunu takip edelim ve bunun sadece oluşturulan görüntü için olduğunu göstermek istediğinizde, Buraya parantez içinde G koyacağım. Yani, şimdi, görselin stilini elde etmek için iki matrisimiz var görsel S ve görsel G'nin stili nedir. Ve, Bu arada, Büyük G harfini bu matrisleri göstermek için kullanmıştım. Lineer Cebir'de, büyük matris olarak da adlandırılır. Bunların büyük matrisi denilen büyük matrisler ama bu videoda, terim olarak stil matrisini kullanacağım. Çünkü bu terim büyük matris bunların çoğunluğu büyük G harfini bu matrisleri göstermek için kullanıyorlar. son olarak, maliyet fonksiyonu, stil maliyet fonksiyonu. Eğer bunları l katmanındaki s ve G arasında yapıyorsanız, artık bu matrisler arasındaki değişikliği değişikliği belirleyebilirsiniz G l, G karesi ve bunlar matrislerdir. hadi bunu öncekinden alalım. Bu sadece elemanın kareler toplamı arasındaki farklılıklar Bu iki matris ve bunu bölersek, bu, k'nin toplamı olacak. s, k, bu farklılıkların k birincil üzerinde toplamı, k birincil eksi G l, G, k, k birincil ve sonrasında elemanların kareleri toplamı Yazarlar genellikle bu normalleştirme sabitini kullanırlar 2 çarpı nh, nw, bu katmanda katmandaki nc ve bunun karesini alacağım. Bunu da buraya koyabilirsiniz. Ama normalleştirme sabiti çok sorun değil çünkü nedense bazı hiper parametre b ile çarpılır. Yani sadece bitirmek için, bu stil maliyet fonksiyonu katman l kullanılarak belirlendi ve önceki slaytta gördüğünüz gibi Bu temelde hesaplanan iki yıldız matris arasındaki Frobenius normu görsel s ve görsel G'nin üstünde Frobenius kare üzerinde ve önemli olmayan düşük normalleşme sabitleriyle asla, ve, son olarak, eğer daha görsel açıdan hoş sonuçlar alırsanız çoklu değişik katmanlarından stil maliyet fonksiyon kullanabilirsiniz. Yani, tüm stil maliyet fonksiyonu, Siz bu katman için stil maliyet fonksiyonunun tüm farklı katmanları üzerinden toplam olarak belirleyebilirsiniz. Kitabı bir dizi parametreye göre tanımlamalıyız. bazı ek hiper metreler seti tarafından, burda benim lambda ile belirlediğim Yani ne yapar, sinir ağında farklı katmanları kullanmanıza izin verir. öncekilere göre, nispeten daha basit düşük seviye özelliklerini ölçen kenarları ve daha sonraki bazı katmanları Yüksek seviye özellikleri ölçen ve sinir ağının alınmasına neden olan hesap stili hesaplanırken hem düşük hem de yüksek düzeyde korelasyonlar hesaba katılır. ve, sonraki örnekte, olması gereken daha fazla sezgi elde edeceksiniz Bu tür bir parametre lambda için de makul seçimler. ve hadi bunu alalım, şimdi tüm maliyet fonksiyonunu belirleyebilirsiniz. alfa kere başlık c ve G arasındaki değer beta kere stil maliyet s ve G ve sonra anlam üretmek ya da isterseniz daha sofistike bir optimizasyon algoritması normalize eden bir G görüntüsünü bulmak için Bu, G.'nin bu maliyet fonksiyonunu en aza indirmeye çalışır. Ve eğer bunu yaparsanız, oldukça iyi görünümlü nöral artistik oluşturabilirsiniz ve eğer bunu yaparsanız, oldukça güzel bir roman yapıtı üretebileceksiniz. Yani bu nöral stil transferi için ve umarım sizde bu haftaki baskı alıştırmasında bunu hayata geçirirsiniz. Bu hafta sona ermeden önce, Seninle paylaşmak istediğim son bir şey var. kıvrımların nasıl yapıldığı Sadece 2D görüntüler yerine 1D veya 3D veriler. Son videoya gidelim.