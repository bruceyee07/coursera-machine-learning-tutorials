ディープConvNet が 本当に学んでいるものは 何なのか？ このビデオでは 視覚化の例を いくつか共有して ConvNet の深い層が行っていることについて 洞察を得て欲しい これは ニューラル スタイル変換の実装方法を考える上でも 役に立つ 例を見る事から始めよう。 ConvNet を訓練したとしよう これは AlexNet のようなネットワークだ そして 隠れ層の異なるユニットで計算されているものを 視覚化したいとする こんなことができる 層１の隠れユニットから始める 学習セットを走査して どの画像 もしくは どの画像内小領域が ユニットの活性を最大化するか 探すものとする 言い換えれば 学習セットを ニューラルネットワークに渡して あるユニットの活性を最大化する画像が 何なのかを調べたい では 気付いているだろうけど 層１の隠れユニットは 相対的に ニューラルネットワークの小さな部分しか見ない よって もし視覚化するなら
何が活性化されたか描くなら そのユニットの活性化を描くなら それが 画像のほんの小さな領域になるのは 当然だ なぜなら １つのユニットが見るのは 画像全体の中のほんの少しだからだ よって １つの隠れユニットを選び その活性を最大化する９つの画像を見つけたら こんな９つの小領域を見つけるんじゃないかな 画像の多くの場所で この隠れユニットは こんな感じの エッジや線を探している １つの隠れユニットを 最高に活性化するのが これら９つの小領域だ 今度は 層１の 別の隠れユニットを選んで 同じことを行うと 異なる隠れユニットに対しては この２番目のようになる この９つの小領域で表される この隠れユニットは 入力域の こんな部分を探しているようだ ここで言う入力域は 受容野と呼ばれる そして 別の隠れユニットでは こんな感じの小領域で 活性化される傾向があると分かるだろう 今度のは 垂直の明るいエッジを選ぶようだ ただし 左側が緑になっている これは オレンジを選ぶ そして 興味深い小領域だ この 赤と緑は 一緒になって 茶色や赤茶色を作る しかし ニューロンは それで活性化するだろう そして これが ９つの異なるニューロンの表現だ それぞれに対する９つの画像小領域が それらを最高に活性化する これで 層１の隠れユニットを訓練する感覚が掴めたでしょ そこのユニットは 探すわけだ 比較的単純な特徴 エッジとか ある色をした影なんかをね なお このビデオで 使っている例は 全て この論文から来ている Mathew Zeiler と Rob Fergus によるもので
タイトルは "Visualizing and understanding convolutional networks" だ 私は もっと簡単な方法で 視覚化をしたい ニューラルネットワークが計算しているものの視覚化をね 彼らの論文では もっと洗練されたやり方をしている ConvNet が学習しているものを視覚化するのにね 兎に角 この手続きを 層１の隠れユニットに 何度か繰り返す これを ニューラルネットワークの 深い層の隠れユニットに行うと どうなるだろうか？ ニューラルネットワークが深い層で学んでいるのは 何だろうか？ 深い層では 隠れ層は 画像のより大きな領域を見るだろう 各ピクセルは 最終的に ニューラルネットワークの後の層の出力に 作用すると言えるだろう 結局 後の層ほど 大きな領域を見る ただし このまま 同じサイズで 画像の小領域を描くよ この処理を繰り返すと これは 前に 層１で得たもので これは 層２の９つの隠れユニットを最高に活性化するものを 視覚化したものだ この視覚化が何なのか ハッキリさせておきたい これら ９つの小領域は １つの隠れユニットを高く活性化させる 各グループ 異なる９つの画像小領域は それぞれ１つの隠れユニットを活性化させる そして ここの視覚化は 層２の９つの隠れユニットを表し ９つの画像小領域それぞれが 対応する１つの隠れユニットに とても大きな出力をさせる とても大きな活性化をさせる これを深い層にも繰り返していく このスライドでは これらの小さな画像域を 見るのは難しいので いくつか拡大してみよう 層１に対しては 既に見たこれ 例えば これで 最初のユニットが高く活性化される 入力画像の こんな角度のエッジがある場所でね では 層２の視覚化も拡大しよう これは 面白い 層２は より複雑な形やパターンを検出している 例えば この隠れユニットは 垂直の模様 沢山の垂直線を探しているようだ この隠れユニットは 丸い形が 画像の左にある時に 高く活性化されるようだ ここでは とても細い垂直線を探している 等々 つまり ２番目の層が検出している特徴は より複雑になっている 層３はどうなっている？ 拡大しよう もっと拡大した方が 層３を最高に活性化するものが もっと良く見えるだろう もっと拡大してみよう これも また 非常に面白いね 画像の左下にある丸い形に 高く反応する隠れユニットが あるようだ そうして 多くの車を検出することになる 驚くことに 人の検出も始まっている そして これは ハニカムのような質感を検出しているようだ もしくは 規則的な四角形を検出しているようだ この内のいくつかは 見るのが難しくて 何を検出しているのか ハッキリとしない しかし より複雑なパターンを検出し始めているのは 明らかだ 次の層は？ これが 層４だ 検出している 特徴量 もしくはパターンは より複雑化している ここでは ほぼ犬検出器を学習したように見える しかし ここの犬は 似ているのばかりだ ね？ ここは 犬という生物種になるのか 犬の種類になるのか分からないけど とにかく 犬に近いか 犬にとても良く似ているものだ この隠れユニットは 水を検出しているようだ これは 鳥の足か何かを検出しているようだ そして 層５では より洗練されたものを検出している 犬検出器と思われるニューロンがあるのが分かるでしょ ただし 検出している犬の種類は もっと多くなっている それから ここでは キーボードを検出している それに キーボードのような模様があるもの 背景に沢山の点があるものかもしれない このニューロンは 多分 文字を検出していると思う 確信を持つのは難しいけど そして これは 花を検出している 比較的簡単なものの検出から ずっと来て 層１ではエッジを 層２では質感を 深い層では とても複雑なものを検出するようになった さて このことが 何らかの良い洞察を与えてくれたと期待する ニューラルネットワークの浅い層と深い層が計算しているものについてね 次に この洞察を使って ニューラル スタイル変換アルゴリズムの構築を始めよう 呼ぶ。