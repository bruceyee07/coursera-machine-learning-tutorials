1
00:00:00,000 --> 00:00:01,440
在上一节课中

2
00:00:01,440 --> 00:00:06,410
你知道怎样让神经网络输出4个变量bx,

3
00:00:06,410 --> 00:00:08,850
by,bh和bw来指定

4
00:00:08,850 --> 00:00:12,840
你想让神经网络去定位的对象的边界框。

5
00:00:12,840 --> 00:00:14,753
对于更普遍的情况，

6
00:00:14,753 --> 00:00:17,400
你可以让神经网络只输出重要的点和图像的

7
00:00:17,400 --> 00:00:20,700
(X,Y)坐标，

8
00:00:20,700 --> 00:00:24,960
有时被称为地标，就是你想要神经网络识别出的东西。

9
00:00:24,960 --> 00:00:26,451
我们来看一些例子
这个东西叫Foldit我们来看一些例子
这个东西叫Foldit

10
00:00:26,451 --> 00:00:31,095
比如说你要建立一个脸部识别应用，出于某些原因，

11
00:00:31,095 --> 00:00:36,835
你想要算法告诉你某人的眼角在哪里.

12
00:00:36,835 --> 00:00:40,530
那个点有个(X,Y)坐标，

13
00:00:40,530 --> 00:00:43,310
所以你可以建立一个神经网络

14
00:00:43,310 --> 00:00:48,235
它的最后一层“输出层“，只输出2个数字

15
00:00:48,235 --> 00:00:51,804
我会把它叫做lx和ly

16
00:00:51,804 --> 00:00:56,730
来告诉你这个人眼角的坐标。

17
00:00:56,730 --> 00:01:01,680
现在，如果你想要神经网络告诉你眼角的所有四个角，

18
00:01:01,680 --> 00:01:03,595
两只眼睛都要。

19
00:01:03,595 --> 00:01:06,360
所以，如果我们称这些点，第一个，第二个，

20
00:01:06,360 --> 00:01:08,640
第三个和第四个从左到右，

21
00:01:08,640 --> 00:01:13,585
那么我们可以修改神经网络，让它输出

22
00:01:13,585 --> 00:01:17,975
(l1x,l1y)作为第一个点，

23
00:01:17,975 --> 00:01:22,140
(l2x,l2y)作为第二个点等等，

24
00:01:22,140 --> 00:01:25,015
那么神经网络可以输出

25
00:01:25,015 --> 00:01:29,590
人脸上这四个点的预估位置

26
00:01:29,590 --> 00:01:31,500
但是如果你想要的不仅仅是这4个点？

27
00:01:31,500 --> 00:01:33,195
你想要输出（眼周的）这个点，

28
00:01:33,195 --> 00:01:36,885
这个点、这个点和这个点？

29
00:01:36,885 --> 00:01:39,945
也许我会在嘴的四周放一些关键的点，

30
00:01:39,945 --> 00:01:44,205
然后你就可以提取出嘴型，从而知道一个人在笑或者不开心，

31
00:01:44,205 --> 00:01:47,250
或许提取出鼻子边的一些关键点

32
00:01:47,250 --> 00:01:50,175
但是你可以定义一些数字，

33
00:01:50,175 --> 00:01:57,080
为了讨论的方便，比如说人脸上的64个点或者64个地标。

34
00:01:57,080 --> 00:02:02,020
或者甚至是一些可以帮助你定义脸形的点，

35
00:02:02,020 --> 00:02:06,480
仅仅通过选择一些地标来定义下颚线

36
00:02:06,480 --> 00:02:11,415
并产生一个包含所有地标的标签训练集合，

37
00:02:11,415 --> 00:02:14,240
然后你可以让神经网络来告诉你

38
00:02:14,240 --> 00:02:19,045
所有脸部重要的位置或者重要的地标在哪。

39
00:02:19,045 --> 00:02:21,305
所以你要做的是，比如你有这张图片，

40
00:02:21,305 --> 00:02:23,755
一个人脸作为输入，

41
00:02:23,755 --> 00:02:28,564
让它作为卷及神经网络的

42
00:02:28,564 --> 00:02:32,160
还有一些特征，

43
00:02:32,160 --> 00:02:34,285
或者让它输出0或者1，

44
00:02:34,285 --> 00:02:40,605
像脸上是否有任何变化，然后同时输出L1x,

45
00:02:40,605 --> 00:02:48,675
l1y然后一直到l64x,l64y.

46
00:02:48,675 --> 00:02:52,065
在此我用l代表一个地标。

47
00:02:52,065 --> 00:02:59,905
所以，这个例子里会有129个输出单位，

48
00:02:59,905 --> 00:03:02,005
1个代表是不是脸

49
00:03:02,005 --> 00:03:04,020
然后如果你有64个地标，

50
00:03:04,020 --> 00:03:05,520
那就是64*2（个输出）

51
00:03:05,520 --> 00:03:09,600
总共是128+1个输出单位

52
00:03:09,600 --> 00:03:14,450
并且，这个可以告诉你图片中是否有张脸，并且所有关键特征是否在脸上。

53
00:03:14,450 --> 00:03:19,225
所以，这是一个从脸部识别表情的基本模块

54
00:03:19,225 --> 00:03:25,020
并且如果你玩Snapchat和其他的一些娱乐应用，

55
00:03:25,020 --> 00:03:28,635
还有AR滤镜，类似

56
00:03:28,635 --> 00:03:33,635
Snapshot照片能够在你脸上画个皇冠
和一些其他的特效

57
00:03:33,635 --> 00:03:36,565
能够从脸部识别这些特征，

58
00:03:36,565 --> 00:03:41,949
也是电脑图像特效的重要部分

59
00:03:41,949 --> 00:03:48,125
能够在脸上画一些皇冠或者帽子的特殊效果。

60
00:03:48,125 --> 00:03:50,600
当然，为了有一个这样的网络，

61
00:03:50,600 --> 00:03:52,995
你需要一个有标签的训练集

62
00:03:52,995 --> 00:03:57,455
我们有一组图像和标签Y，

63
00:03:57,455 --> 00:04:00,350
由人工枯燥地遍历并

64
00:04:00,350 --> 00:04:04,925
注释所有的这些地标。

65
00:04:04,925 --> 00:04:11,870
最后一个例子，如果你对人体姿势检测感兴趣的话，

66
00:04:11,870 --> 00:04:17,110
你也可以定义一些关键的位置，比如胸部的中间点，

67
00:04:17,110 --> 00:04:21,807
左肩，左肘，手腕，

68
00:04:21,807 --> 00:04:24,936
等等，建立一个神经网络去标识

69
00:04:24,936 --> 00:04:34,195
人的姿势的关键位置以及通过这个神经网络输出，

70
00:04:34,195 --> 00:04:36,743
所有我标识的这些点，

71
00:04:36,743 --> 00:04:42,685
你也可以让神经网络输出人的姿势。

72
00:04:42,685 --> 00:04:47,325
当然，为了实现这个，你也需要指出

73
00:04:47,325 --> 00:04:50,775
这些关键特征就像l1x和l1y

74
00:04:50,775 --> 00:04:55,395
是胸部到或者l32x，l32y的中间点，

75
00:04:55,395 --> 00:05:01,840
如果你有32个坐标来指定一个人的姿势的情况下。

76
00:05:01,840 --> 00:05:06,690
所以，这个方法似乎很简单，仅仅是填加一堆输出单位

77
00:05:06,690 --> 00:05:12,200
输出不同的你想要识别的特征的X,Y坐标。

78
00:05:12,200 --> 00:05:16,290
声明一点，地标的身份一定要

79
00:05:16,290 --> 00:05:18,525
在不同的图像中一致，比如

80
00:05:18,525 --> 00:05:21,368
地标一总是眼睛的这个角，

81
00:05:21,368 --> 00:05:23,535
地标二总是眼睛的这个角，

82
00:05:23,535 --> 00:05:25,650
地标三，地标四，等等。

83
00:05:25,650 --> 00:05:29,475
所以，标签必须在不同的图片中保持一致性。

84
00:05:29,475 --> 00:05:34,350
但是如果你可以雇佣一个打标签的人或者你自己去给足够大的数据集做标记的话，

85
00:05:34,350 --> 00:05:38,368
那么这个神经网络可以输出所有的特征（地标）

86
00:05:38,368 --> 00:05:43,440
可以用来实现其他的一些有趣的效果，比如人的姿势，

87
00:05:43,440 --> 00:05:47,935
或许尝试着从图片中去识别一个人的表情，等等。

88
00:05:47,935 --> 00:05:50,460
所以这就是特征（地标）检测。

89
00:05:50,460 --> 00:05:53,280
接下来，让我们带着这些模块，用它们来

90
00:05:53,280 --> 00:05:56,280
建立对象检测。