1
00:00:00,000 --> 00:00:01,440
在前面的影片中

2
00:00:01,440 --> 00:00:06,410
你知道怎麼讓一個神經網路輸出四個數字

3
00:00:06,410 --> 00:00:08,850
b_x, b_y, b_h 和 b_w，

4
00:00:08,850 --> 00:00:12,840
來指定一個物件的邊界框，讓神經網路定位之

5
00:00:12,840 --> 00:00:14,753
更一般來說

6
00:00:14,753 --> 00:00:17,400
你可以讓神經網路輸出

7
00:00:17,400 --> 00:00:20,700
圖片中重要的點的座標 (x,y)

8
00:00:20,700 --> 00:00:24,960
有時叫作「特徵點」(landmark)，我們想要神經網路辨認之

9
00:00:24,960 --> 00:00:26,451
讓我來舉一些例子

10
00:00:26,451 --> 00:00:31,095
假設你在做臉部辨認的應用，基於一些原因

11
00:00:31,095 --> 00:00:36,835
你想讓演算法告訴你某個人的眼角在哪

12
00:00:36,835 --> 00:00:40,530
那麼，眼角這個點有座標 (x,y)

13
00:00:40,530 --> 00:00:43,310
所以你可以讓神經網路

14
00:00:43,310 --> 00:00:48,235
的最後一層多輸出兩個數字

15
00:00:48,235 --> 00:00:51,804
— 我要叫他們 l_x, l_y

16
00:00:51,804 --> 00:00:56,730
來告訴你那個眼角的座標

17
00:00:56,730 --> 00:01:01,680
但是，如果要他告訴你眼睛的四個角落呢？

18
00:01:01,680 --> 00:01:03,595
也就是兩隻眼睛的眼角

19
00:01:03,595 --> 00:01:06,360
那麼，如果我們叫這些點

20
00:01:06,360 --> 00:01:08,640
由左到右是第 1, 2, 3, 4 點

21
00:01:08,640 --> 00:01:13,585
那你可以修改神經網路，讓他輸出

22
00:01:13,585 --> 00:01:17,975
l_1x, l_1y 表示第一點

23
00:01:17,975 --> 00:01:22,140
l_2x, l_2y 表示第二點，依此類推

24
00:01:22,140 --> 00:01:25,015
讓這神經網路能輸出

25
00:01:25,015 --> 00:01:29,590
這個人臉上這四個點的位置

26
00:01:29,590 --> 00:01:31,500
可是，如果你不只要四個點呢？

27
00:01:31,500 --> 00:01:33,195
如果你想要輸出這個點

28
00:01:33,195 --> 00:01:36,885
眼睛周圍的這個和這個點，該怎麼辦呢

29
00:01:36,885 --> 00:01:39,945
也可能我要在嘴巴周圍放些關鍵點

30
00:01:39,945 --> 00:01:44,205
讓你可以取得嘴巴的形狀，辨認一個人在笑還是不開心

31
00:01:44,205 --> 00:01:47,250
或許在鼻子周圍取一些點

32
00:01:47,250 --> 00:01:50,175
你可以在臉上定義若干個點

33
00:01:50,175 --> 00:01:57,080
舉例來說，假設是 64 個點、64 個特徵點

34
00:01:57,080 --> 00:02:02,020
甚至可能一些點去定出臉龐的邊緣、

35
00:02:02,020 --> 00:02:06,480
下巴的線條... 總之定義了一些特徵點

36
00:02:06,480 --> 00:02:11,415
並且產生有標記、含有這些特徵點的訓練集之後

37
00:02:11,415 --> 00:02:14,240
你就能讓神經網路告訴你

38
00:02:14,240 --> 00:02:19,045
一張臉上的關鍵點、特徵點在哪裡

39
00:02:19,045 --> 00:02:21,305
那麼你要做的是把這張圖片

40
00:02:21,305 --> 00:02:23,755
這張人臉作為輸入

41
00:02:23,755 --> 00:02:28,564
讓他通過 ConvNet

42
00:02:28,564 --> 00:02:32,160
得到一些特徵

43
00:02:32,160 --> 00:02:34,285
讓他輸出 0 或 1

44
00:02:34,285 --> 00:02:40,605
表示「這張圖有沒有臉」；還讓他輸出 l_1x、

45
00:02:40,605 --> 00:02:48,675
l_1y、一直到 l_64x, l64y

46
00:02:48,675 --> 00:02:52,065
這裡我用 l 表示特徵點

47
00:02:52,065 --> 00:02:59,905
所以以這例子，會有 129 個輸出單元

48
00:02:59,905 --> 00:03:02,005
一個代表「是不是臉」

49
00:03:02,005 --> 00:03:04,020
然後如果有 64 個特徵點

50
00:03:04,020 --> 00:03:05,520
就會有 64 乘 2

51
00:03:05,520 --> 00:03:09,600
也就是 128 再加一個輸出單元

52
00:03:09,600 --> 00:03:14,450
這些能告訴你圖中有沒有臉，以及臉上所有的特徵點在哪

53
00:03:14,450 --> 00:03:19,225
所以，要做臉部表情辨識的話

54
00:03:19,225 --> 00:03:25,020
這是滿關鍵的要素。如果你玩過 Snapchat 或是其他的

55
00:03:25,020 --> 00:03:28,635
像是擴增實境的濾鏡

56
00:03:28,635 --> 00:03:33,635
像 Snapchat 能在照片的臉上頭畫個皇冠或是其他特效

57
00:03:33,635 --> 00:03:36,565
能偵測到臉的特徵點是很關鍵的元件

58
00:03:36,565 --> 00:03:41,949
像是那些繪圖特效，將臉變形

59
00:03:41,949 --> 00:03:48,125
弄出各種特效，讓人戴頂皇冠或帽子一類的。

60
00:03:48,125 --> 00:03:50,600
當然，為了要能訓練出這樣的網路

61
00:03:50,600 --> 00:03:52,995
你要有標記好的訓練資料

62
00:03:52,995 --> 00:03:57,455
我們要有一堆圖片，還有一堆標記 y

63
00:03:57,455 --> 00:04:00,350
而這需要有人看過這些圖片

64
00:04:00,350 --> 00:04:04,925
手動努力地標出這些特徵點

65
00:04:04,925 --> 00:04:11,870
最後一個例子：如果你對人的姿勢偵測感興趣

66
00:04:11,870 --> 00:04:17,110
你也可以定義一些關鍵點，例如胸部中間

67
00:04:17,110 --> 00:04:21,807
左肩、左手肘、手腕等等

68
00:04:21,807 --> 00:04:24,936
然後讓神經網路去標記

69
00:04:24,936 --> 00:04:34,195
一個人姿勢的特徵點，讓他輸出

70
00:04:34,195 --> 00:04:36,743
所有我這邊點出的點

71
00:04:36,743 --> 00:04:42,685
這樣神經網路也能輸出一個人的姿勢

72
00:04:42,685 --> 00:04:47,325
所以當然要這樣的話，一樣也必須要標好

73
00:04:47,325 --> 00:04:50,775
這堆特徵點，例如 l_1x, l1_y

74
00:04:50,775 --> 00:04:55,395
可能是胸部中點，一直可能到 l_32x, l_32y

75
00:04:55,395 --> 00:05:01,840
— 如果你想用 32 個座標來表示一個人的姿勢

76
00:05:01,840 --> 00:05:06,690
那麼，這個主意可能聽起來很簡單：只要加一堆輸出單元

77
00:05:06,690 --> 00:05:12,200
輸出各個想偵測的特徵點座標 (x,y) 就好。

78
00:05:12,200 --> 00:05:16,290
這邊提醒一下，在所有圖片中

79
00:05:16,290 --> 00:05:18,525
特徵點的定義都要一致 

80
00:05:18,525 --> 00:05:21,368
例如特徵點1都是這個眼角

81
00:05:21,368 --> 00:05:23,535
特徵點2都是這個眼角

82
00:05:23,535 --> 00:05:25,650
特徵點3, 特徵點4, 等等等

83
00:05:25,650 --> 00:05:29,475
橫跨各個圖片，標記都要一致

84
00:05:29,475 --> 00:05:34,350
如果你能僱用專門標記的人，或你自己能標出足夠多的資料

85
00:05:34,350 --> 00:05:38,368
那神經網路就能預測出所有的特徵點

86
00:05:38,368 --> 00:05:43,440
讓你能跟著做其他有趣的事，像是姿勢辨認、

87
00:05:43,440 --> 00:05:47,935
了解某個人的情緒，諸如此類

88
00:05:47,935 --> 00:05:50,460
那麼，這就是「特徵點偵測」(Landmark detection)

89
00:05:50,460 --> 00:05:53,280
接下來，讓我們從這個元件出發

90
00:05:53,280 --> 00:05:56,280
往物件偵測 (object detection) 邁進