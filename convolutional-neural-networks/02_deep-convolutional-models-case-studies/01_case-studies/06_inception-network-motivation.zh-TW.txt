當設計一個卷積網路層時，您或許需要去選擇 您要用 1乘3 過濾器 或者 3乘3，5乘5 或者您要一個池層？ 而 Inception 網路的方式是 為什麼不全都做呢？ 而這會讓網路架構更加複雜 但也作用得特別好 我們來看看要怎麼做？ 假設為了討論的例子，您有一個輸入為 28乘28乘192 維度的容積 Inception 網路或者說 Inception 層的方式是 與其選擇在卷積層使用多大的過濾器 或甚至於您要選擇卷積層或者池層 我們通通都做，如果您使用 1乘1 卷積 這個會輸出 28乘28乘 一個數 假設 28乘28乘64 輸出 您會有一個容積在那裏 但或許您也想試一個 3乘3，輸出或許會是 28乘28乘128 您要做的是將第二個容積跟第一個容積疊在一起 讓這兩個維度相吻合 我們假設這是用相同卷積 所以輸出維度依然是 28乘28 跟輸入維度相同，指的是高度跟寬度 在這個例子 28乘28乘128 或許您要說，我想兩方押寶 或許 5乘5 過濾器作用得更好 我們也一起做，輸出會是 28乘28乘32 再提一次，您使用相同卷積來保持維度相同 而或許您不想用卷積層 我們用池層，這會有一些輸出，我們將這些疊起來 而這裡池層輸出為 28乘28乘32 現在為了讓所有維度相吻合 您實際上需要使用填充來做最大池化 這是一種非常態的池層，因為為了您希望 輸入高度跟寬度是 28乘28，而輸出 您要配合其他維度
成為 28乘28 那您需要用到相同填充跟跨步為 1 在池層上 這些細節現在看起來很滑稽 但讓我們繼續 我們等一下會讓這些都有用 但使用像這樣的 Inception 模組 您可以輸入一些容積，而輸出 在這個例子，如果您將所有這些數字相加 32 加 32 加 128 加 64 這會是 256 所以您會有一個 inception 模組，輸入是 28乘28乘129 而輸出為 28乘28乘256 而這就是 inception 網路的核心，由 Christian Szegedy, Wei Liu, Yangqing Jia, Pierre Sermanet, Scott Reed, Dragomir Anguelov, Dumitru Erhan, Vincent Vanhoucke and Andrew Rabinovich. 提出 而基本的想法是 與其您必須選擇過濾器大小，或者要不要用池層 您可以全部都做，然後將輸出結合起來 而讓網路來決定什麼樣的參數它要使用 什麼樣的過濾器大小是它要的 但現在有一個問題 使用像這樣描述的 inception 層 會有計算成本的問題 在下一張投影片 我們來算一下這個 5乘5 過濾器的計算成本 也就是這一區塊 所以聚焦在這個上一張投影片的 5乘5 容積 我們的輸入是 28乘28乘129 區塊 而您建置一個5乘5 相同卷積 32 個過濾器，輸出為 28乘28乘32 在前一張投影片，我用淡紫色來畫 但這裡我用看起來正常的藍色來畫 我們來看一下輸出這個 28乘28乘32 的計算成本 您有 32 個過濾器，因為輸出是 32 通道 每一個過濾器都是 5乘5乘192 而輸出是 28乘28乘32 所以您必須計算 28乘28乘32 個數字 中間每一個數字，您都需要做乘法，對吧？ 5乘5乘192 所以整個要做乘法的數目是 您需要的每一個輸出值的乘法數目乘上 您需要計算的所有輸出值 而如果您乘上這些所有數字 會等於 一億兩千萬個 (120 million) 乘法 所以，當然您可以在當今電腦上做一億兩千萬乘法 但這還是相當昂貴的運算 在下一張投影片，您會見到如何使用 1乘1 卷積的觀念 您在前面學到的 您能夠降低計算成本大約 十分之一 從一億兩千萬個乘法降為大約十分之一 所以請記住這個一億兩千萬，將來您可以 在下一張投影片做比較，一億兩千萬 這裡有另外一種架構來輸入 28乘28乘192 輸出為28乘28乘32，如下 您將這個輸入容積 使用一個 1乘1 卷積來降低容積為
 16 個通道，而不是192 個通道 然後在這個較小的容積 跑一個 5乘5 卷積來給您一個最終輸出 請注意，輸入跟輸出的維度跟之前一樣 您的輸入是 28乘28乘192 輸出是 28乘28乘32 跟之前投影片一樣 但我們做到的是，我們將在左邊這個巨大的容積 我們將其縮小為中間這個小很多的容積 現在只有 16 個而不是 192 個通道 有時候這個被稱為瓶頸層 我猜因為瓶頸通常指的是東西最小的部分，對吧？ 我猜如果您有玻璃瓶像這樣 然後我猜軟木塞這樣走 而瓶頸就是瓶子最窄的部分 同樣的，瓶頸層就是這網路的最小部分 我們先縮小，再增加大小 現在讓我們來看相關計算成本 為了應用這 1乘1卷積 我們使用了 16 個過濾器 每一個過濾器的維度是 1乘1乘192 這個 192 跟這個 192 互相吻合 所以計算成本對於這個 28乘28乘16 容積 您需要這麼多輸出 每一個輸出您需要做 192 個乘法 我可以寫成 1乘1乘192，對吧？ 也就是這個，如果您將他們乘出來 這是兩百四十萬 (2.4 million) 大約兩百四十萬 第二個呢？ 剛剛是第一個卷積層的成本 第二個卷積層的成本會是 您有這麼多的輸出 28乘28乘32 對於每一個輸出，您需要應用 5乘5乘16 維度的過濾器 所以是 5乘5乘16 如果您將它們相乘，會是一千萬 (10 million) 所以整個相乘的數目是您需要把兩項相加 也就是 一千兩百四十萬 如果跟我們之前投影片的數字相比 您從大約 一億兩千萬降低計算成本 約十分之一 到一千兩百四十萬的乘法 而需要相加的數目 大約類似於需要做乘法的數目 所以這是為什麼我只算乘法的數目 總結一下，如果您要建 一個神經網路層，您不想要決定 您要 1乘1， 3乘3，或者 5乘5 或者池層 在 inception 模組，讓您全部都做 再全部連結起來 然後我們會碰到計算成本的問題 您在這裡看到的是如何使用 1乘1 卷積 您可以建立一個瓶頸層 來明顯降低計算成本 您或許會疑惑 如此巨大的縮減大小 會不會傷害您的神經網路的績效 實際上只要您建置瓶頸層在這種情況下 您可以明顯地縮減大小 而不至於傷害到績效 但卻減少很多計算成本 所以這是 inception 模組的主要觀念 讓我們將它們放在一起 在下一段影片顯示您全 inception 網路的樣子