1
00:00:00,930 --> 00:00:04,720
当你实现梯度逆传播时 你会发现一个测试

2
00:00:04,720 --> 00:00:07,700
名叫梯度检验 可以帮助你确保

3
00:00:07,700 --> 00:00:10,710
你的梯度逆传播的实现是正确的

4
00:00:10,710 --> 00:00:14,376
因为有时写下这些方程后 你无法百分百确定

5
00:00:14,376 --> 00:00:17,940
你的所有细节都做对了 实现了正确的逆传播

6
00:00:17,940 --> 00:00:21,020
所以 为了之后能介绍梯度检验

7
00:00:21,020 --> 00:00:25,490
我们先谈谈如何在数值上近似计算梯度

8
00:00:25,490 --> 00:00:28,400
在下一个视频中 我们再讨论如何实现

9
00:00:28,400 --> 00:00:32,028
梯度检验 从而确保逆传播的实现是正确的

10
00:00:32,028 --> 00:00:37,310
我们来看一下函数f 我把它画在了这里

11
00:00:37,310 --> 00:00:43,110
这个f(𝜃)等于𝜃立方 我们从某些𝜃取值出发

12
00:00:43,110 --> 00:00:44,640
比如𝜃=1

13
00:00:44,640 --> 00:00:50,180
这次我们不再将𝜃向右扰动到𝜃+𝜀

14
00:00:50,180 --> 00:00:52,460
我们将同时向左右扰动

15
00:00:52,460 --> 00:00:58,110
得到𝜃-𝜀和𝜃+𝜀

16
00:00:58,110 --> 00:01:02,935
所以这里是1 这里是1.01 这里是0.99

17
00:01:02,935 --> 00:01:06,144
𝜀与之前一样是0.01

18
00:01:06,144 --> 00:01:10,378
事实上 相比于取这个小三角形

19
00:01:10,378 --> 00:01:15,526
并计算高和宽 你还能得到更好的估计值

20
00:01:15,526 --> 00:01:20,922
如果你选取这个点f(𝜃-𝜀)和这个点

21
00:01:20,922 --> 00:01:26,230
然后计算这个大三角形的高和宽

22
00:01:26,230 --> 00:01:31,988
由于一些技术原因 我在此不作解释 这个大三角形的

23
00:01:31,988 --> 00:01:37,601
高和宽会给你一个𝜃点处梯度更好的近似值

24
00:01:37,601 --> 00:01:41,338
很容易发现 如果不取右上的这个小三角形

25
00:01:41,338 --> 00:01:43,372
你可以认为你有两个小三角形

26
00:01:43,372 --> 00:01:47,220
右上的这个和左下的这个

27
00:01:47,220 --> 00:01:49,760
你相当于同时考虑这两个三角形

28
00:01:49,760 --> 00:01:54,450
通过使用这个大的绿三角形

29
00:01:54,450 --> 00:01:57,720
所以你这次取了双侧的差值而不是单侧的差值

30
00:01:57,720 --> 00:01:58,954
我们来写成数学形式

31
00:01:58,954 --> 00:02:03,648
这个点是f(𝜃+𝜀)

32
00:02:03,648 --> 00:02:07,870
而这个点是f(𝜃-𝜀)

33
00:02:07,870 --> 00:02:12,390
所以这个大的绿三角形的高是f(𝜃+𝜀)-f(𝜃-𝜀)

34
00:02:12,390 --> 00:02:15,230
所以这个大的绿三角形的高是f(𝜃+𝜀)-f(𝜃-𝜀)

35
00:02:15,230 --> 00:02:21,250
至于宽度 这里是1个𝜀 这里是第2个𝜀

36
00:02:21,250 --> 00:02:24,390
所以这个绿色三角形的宽就是2𝜀

37
00:02:24,390 --> 00:02:28,400
所以这里的高度就是 首先是高度

38
00:02:28,400 --> 00:02:35,110
也就是f(𝜃+𝜀)-f(𝜃-𝜀)除以宽度

39
00:02:35,110 --> 00:02:37,920
也就是2𝜀 我写在这里了

40
00:02:38,950 --> 00:02:43,450
这个很可能与g(𝜃)很接近

41
00:02:43,450 --> 00:02:46,350
代入这些值 记住f(𝜃)是𝜃立方

42
00:02:46,350 --> 00:02:49,890
这里𝜃+𝜀也就是1.01

43
00:02:49,890 --> 00:02:58,250
我取它的立方 然后减去0.99的立方 再除以2*0.01

44
00:02:58,250 --> 00:03:03,580
你可以暂停视频并在计算器上算一下

45
00:03:03,580 --> 00:03:06,259
你会得到结果是3.0001

46
00:03:06,259 --> 00:03:10,581
前一个幻灯片中 我们知道g(𝜃)

47
00:03:10,581 --> 00:03:14,272
也就是3𝜃^2 而𝜃是1

48
00:03:14,272 --> 00:03:18,519
所以这两个值十分接近

49
00:03:18,519 --> 00:03:22,250
近似误差是0.0001

50
00:03:22,250 --> 00:03:27,456
在上一个幻灯片中 我们取过单侧的差值

51
00:03:27,456 --> 00:03:34,150
𝜃和𝜃+𝜀之间的结果是3.0301

52
00:03:34,150 --> 00:03:40,340
所以近似误差就是0.03而不是0.0001

53
00:03:40,340 --> 00:03:44,260
所以用这个取双侧差值的方法

54
00:03:44,260 --> 00:03:48,462
来近似导数 你会发现结果非常接近3

55
00:03:48,462 --> 00:03:53,320
所以这将让你更加自信

56
00:03:53,320 --> 00:03:56,890
g(𝜃)很可能就是求f导数的正确实现

57
00:03:58,220 --> 00:04:01,480
当你把这个方法用于梯度检验和逆传播时

58
00:04:01,480 --> 00:04:06,230
它运行起来很可能比用单侧差值要慢两倍

59
00:04:06,230 --> 00:04:10,193
但从实践的角度 我认为这个方法值得一用

60
00:04:10,193 --> 00:04:11,752
因为它精确很多

61
00:04:11,752 --> 00:04:13,946
我再说一些选修的理论知识

62
00:04:13,946 --> 00:04:18,685
给你们之中比较熟悉微积分的人

63
00:04:18,685 --> 00:04:22,249
如果你听不懂我即将说到的内容也没有关系

64
00:04:22,249 --> 00:04:26,772
事实上 导数的正式定义

65
00:04:26,772 --> 00:04:31,629
就是对于很小的𝜀 计算[f(𝜃+𝜀)-f(𝜃-𝜀)]/(2𝜃)

66
00:04:31,629 --> 00:04:33,917
就是对于很小的𝜀 计算[f(𝜃+𝜀)-f(𝜃-𝜀)]/(2𝜃)

67
00:04:33,917 --> 00:04:38,852
而导数的正式定义就是右边这个公式

68
00:04:38,852 --> 00:04:42,480
当𝜀趋近于0时的极限

69
00:04:42,480 --> 00:04:46,270
极限的定义就是微积分课上学的那样

70
00:04:46,270 --> 00:04:48,980
但我这里不再详述

71
00:04:48,980 --> 00:04:52,398
对于一个非零的𝜀值

72
00:04:52,398 --> 00:04:56,517
你可以证明这个近似的误差

73
00:04:56,517 --> 00:05:00,889
在𝜀平方这个阶上 𝜀是个很小的数

74
00:05:00,889 --> 00:05:08,471
如果𝜀是0.01 就像这里 那么𝜀平方就是0.0001

75
00:05:08,471 --> 00:05:12,098
这个大O记号就表示误差就是某个常数乘以这个

76
00:05:12,098 --> 00:05:15,240
这就是我们的近似误差

77
00:05:15,240 --> 00:05:17,478
这个例子中的大O的常数恰好就是1

78
00:05:17,478 --> 00:05:22,182
相比而言 如果我们用这边的另一个公式

79
00:05:22,182 --> 00:05:25,129
误差就在𝜀这个阶上

80
00:05:25,129 --> 00:05:29,872
当𝜀是一个小于1的数时

81
00:05:29,872 --> 00:05:34,618
𝜀就比𝜀平方大很多 这也就是为什么

82
00:05:34,618 --> 00:05:38,790
这个公式不如左边这个公式精确

83
00:05:38,790 --> 00:05:43,690
这也就是为什么我们做梯度检验时采用双侧差值

84
00:05:43,690 --> 00:05:48,113
你计算f(𝜃+𝜀)-f(𝜃-𝜀)再除以2𝜀

85
00:05:48,113 --> 00:05:52,900
而不使用这个不够精确的单侧差值

86
00:05:53,980 --> 00:05:57,090
如果你不理解我最后说的两点 所有东西都写在这儿了

87
00:05:57,090 --> 00:05:58,480
Don't worry about it.Don't worry about it.

88
00:05:58,480 --> 00:06:02,460
对微积分和数值近似比较熟悉的人

89
00:06:02,460 --> 00:06:04,630
可以多学一些

90
00:06:04,630 --> 00:06:08,890
简单来说就是双侧差值的公式更加精确

91
00:06:08,890 --> 00:06:12,445
我们在下一个梯度检验视频中就会用到这个

92
00:06:13,725 --> 00:06:16,355
所以你们学习了如何取双侧差值

93
00:06:16,355 --> 00:06:20,845
来在数值上验证是否给定的函数g(𝜃)

94
00:06:20,845 --> 00:06:25,675
是函数f的导数的正确实现

95
00:06:25,675 --> 00:06:28,265
我们来看看如何使用这个来验证是否

96
00:06:28,265 --> 00:06:31,435
你的逆传播的实现是正确的

97
00:06:31,435 --> 00:06:34,855
还是说里面有错误要剔除掉