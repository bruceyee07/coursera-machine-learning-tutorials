1
00:00:00,930 --> 00:00:04,720
當您建置反向傳播時
您會發現有一種測試稱為

2
00:00:04,720 --> 00:00:07,700
梯度檢查可以
真的幫助您確認

3
00:00:07,700 --> 00:00:10,710
您的反向傳播建置
是正確的

4
00:00:10,710 --> 00:00:14,376
因為有時候您寫了所有這些
方程式您並不能 100% 確定

5
00:00:14,376 --> 00:00:17,940
您是否弄對所有細節
當您建置反向傳播時

6
00:00:17,940 --> 00:00:21,020
為了要建立梯度檢查

7
00:00:21,020 --> 00:00:25,490
讓我們先來談如何用
數值趨近來計算梯度

8
00:00:25,490 --> 00:00:28,400
在下一段影片
我們會談到如何建置

9
00:00:28,400 --> 00:00:32,028
梯度檢查來確定
反向傳播的建置是正確的

10
00:00:32,028 --> 00:00:37,310
讓我們拿一個函數 f 
這裡重新畫一次, 記得這個

11
00:00:37,310 --> 00:00:43,110
f of θ 等於 θ 三次方，
讓我們開始一些 θ 的值

12
00:00:43,110 --> 00:00:44,640
假設 θ 等於 1

13
00:00:44,640 --> 00:00:50,180
現在與其將 θ 往右微調 加上 ε

14
00:00:50,180 --> 00:00:52,460
我們要同時往右微調跟

15
00:00:52,460 --> 00:00:58,110
往左微調得到 θ 減 ε 
跟 θ 加 ε

16
00:00:58,110 --> 00:01:02,935
所以這是 1, 這是 1.01, 這是 0.99

17
00:01:02,935 --> 00:01:06,144
ε 跟之前一樣 0.01

18
00:01:06,144 --> 00:01:10,378
實際上與其用這個小三角形來

19
00:01:10,378 --> 00:01:15,526
計算高度除以寬度
您可以得到更加的梯度估計

20
00:01:15,526 --> 00:01:20,922
如果您在這一點
 f of θ - ε 跟這一點

21
00:01:20,922 --> 00:01:26,230
您取而代之計算這個高度
除以這個大三角形的寬度

22
00:01:26,230 --> 00:01:31,988
為了技術上的原因, 我不去深入談到
這個高度除以這個

23
00:01:31,988 --> 00:01:37,601
大的綠色三角形的寬度會給您
比較好的在 θ 的導數估計

24
00:01:37,601 --> 00:01:41,338
您自己也可以看到
用右上角的這個三角形

25
00:01:41,338 --> 00:01:43,372
就像您有兩個三角形

26
00:01:43,372 --> 00:01:47,220
一個在右上
一個在左下

27
00:01:47,220 --> 00:01:49,760
而您有點像將兩個同時考慮

28
00:01:49,760 --> 00:01:54,450
用這個大一點的三角形

29
00:01:54,450 --> 00:01:57,720
所以與其用一邊的差異
您用了雙邊的差異

30
00:01:57,720 --> 00:01:58,954
所以讓我們來做一些數學

31
00:01:58,954 --> 00:02:03,648
這一點是 f(θ + ε)

32
00:02:03,648 --> 00:02:07,870
這一點是 f(θ - ε)

33
00:02:07,870 --> 00:02:12,390
所以這裡大綠色三角形的高是 f(θ + ε)

34
00:02:12,390 --> 00:02:15,230
減去 f(θ - ε)

35
00:02:15,230 --> 00:02:21,250
而寬度，這裡是一個 ε, 這是兩個 ε

36
00:02:21,250 --> 00:02:24,390
所以這個大綠色三角形個寬是 2ε

37
00:02:24,390 --> 00:02:28,400
所以高度除以寬度是
首先是高度

38
00:02:28,400 --> 00:02:35,110
也就是 f(θ + ε) 減去
 f(θ - ε) 除以寬度

39
00:02:35,110 --> 00:02:37,920
也就是 2ε
我們寫在這裡

40
00:02:38,950 --> 00:02:43,450
這希望靠近於 g of θ

41
00:02:43,450 --> 00:02:46,350
所以代入這個值
記得 f of θ 是 θ 三次方

42
00:02:46,350 --> 00:02:49,890
所以這個是 θ + ε  是 1.01

43
00:02:49,890 --> 00:02:58,250
所以我取它的三次方減去 0.99的三次方
除以 2 乘 0.01

44
00:02:58,250 --> 00:03:03,580
歡迎暫停影片
用計算機練習算一下

45
00:03:03,580 --> 00:03:06,259
您應該會得到 3.0001

46
00:03:06,259 --> 00:03:10,581
而從前面的投影片中
我們看到了 g of θ

47
00:03:10,581 --> 00:03:14,272
是 3 θ 平方
而 θ 等於 1

48
00:03:14,272 --> 00:03:18,519
這兩個數字實際上
非常接近

49
00:03:18,519 --> 00:03:22,250
近似誤差是 0.0001

50
00:03:22,250 --> 00:03:27,456
而在前面的投影片中
我們取單邊

51
00:03:27,456 --> 00:03:34,150
的差異為 θ 跟 θ + ε, 我們得到 3.0301

52
00:03:34,150 --> 00:03:40,340
近似誤差為 0.03 而不是 0.0001

53
00:03:40,340 --> 00:03:44,260
所以這種雙邊差異的方式

54
00:03:44,260 --> 00:03:48,462
來近似您要找的導數
是非常接近 3

55
00:03:48,462 --> 00:03:53,320
所以這給您比較多的信心
來確定 g of θ 

56
00:03:53,320 --> 00:03:56,890
或許是正確的建置 f 的導數

57
00:03:58,220 --> 00:04:01,480
當您使用這種方式來作
梯度檢查跟反向傳播

58
00:04:01,480 --> 00:04:06,230
這實際上會跑得兩倍慢
相對於您只使用單邊差異

59
00:04:06,230 --> 00:04:10,193
實際上在實作中我覺得
用這種方式是值得的因為

60
00:04:10,193 --> 00:04:11,752
這比較精確

61
00:04:11,752 --> 00:04:13,946
再來一點可以選讀的理論

62
00:04:13,946 --> 00:04:18,685
如果您比較熟悉微積分
實際上

63
00:04:18,685 --> 00:04:22,249
如果您不懂我將要說的也沒關係

64
00:04:22,249 --> 00:04:26,772
但實際上導數的正規定義是

65
00:04:26,772 --> 00:04:31,629
對於很小的 ε 是
 f(θ + ε) 減去 f(θ- ε)

66
00:04:31,629 --> 00:04:33,917
除以 2ε

67
00:04:33,917 --> 00:04:38,852
而正規的導數定義是在這個

68
00:04:38,852 --> 00:04:42,480
右邊公式的極限值當 ε 趨近於 0

69
00:04:42,480 --> 00:04:46,270
而極限的定義
是您學過的如果您

70
00:04:46,270 --> 00:04:48,980
上過微積分課
我不會在這裡談到

71
00:04:48,980 --> 00:04:52,398
而實際上對於一個
非 0 的 ε 值

72
00:04:52,398 --> 00:04:56,517
您可以證明這個
趨近值的誤差是在

73
00:04:56,517 --> 00:05:00,889
ε 平方等級的
記得 ε 是非常小的數

74
00:05:00,889 --> 00:05:08,471
所以如果 ε 是 0.01
那這裡 ε 平方會是 0.0001

75
00:05:08,471 --> 00:05:12,098
這個大 O 的意思是
誤差實際上是一個常數乘上這個項目

76
00:05:12,098 --> 00:05:15,240
但這的確正是我們個近似誤差

77
00:05:15,240 --> 00:05:17,478
所以這個大 O 常數剛好為 1

78
00:05:17,478 --> 00:05:22,182
而相對的如果
我們使用這個公式, 另一個公式

79
00:05:22,182 --> 00:05:25,129
那誤差會是 ε 等級

80
00:05:25,129 --> 00:05:29,872
再次, 當 ε 是小於 1 的數字時, 那 ε 確實

81
00:05:29,872 --> 00:05:34,618
比ε 平方大多了
這是為什麼這裡確實

82
00:05:34,618 --> 00:05:38,790
比較不像左邊這個公式
那麼精確

83
00:05:38,790 --> 00:05:43,690
這也是為什麼當作梯度檢查時
我們會使用雙邊差異

84
00:05:43,690 --> 00:05:48,113
當您計算 f(θ + ε) 
減去 f(θ - ε) 然後

85
00:05:48,113 --> 00:05:52,900
除以 2ε, 而不用一邊的差異
因為他比較不精確

86
00:05:53,980 --> 00:05:57,090
如果您不懂我最後這些意見, 這裡的東西

87
00:05:57,090 --> 00:05:58,480
不用擔心

88
00:05:58,480 --> 00:06:02,460
這是對於那些比較熟悉微積分

89
00:06:02,460 --> 00:06:04,630
跟數值近似的人談的

90
00:06:04,630 --> 00:06:08,890
但重點是雙邊差異公式
是比較精確的

91
00:06:08,890 --> 00:06:12,445
這也是我們將在梯度檢查時
使用的公式, 在下一段影片中

92
00:06:13,725 --> 00:06:16,355
所以您看到如何使用雙邊差異

93
00:06:16,355 --> 00:06:20,845
您可以數值驗證是否
有人給您的一個函數 g, g of θ 

94
00:06:20,845 --> 00:06:25,675
是正確的 f 函數的導數

95
00:06:25,675 --> 00:06:28,265
讓我們看如何使用這個來驗證

96
00:06:28,265 --> 00:06:31,435
是否您的反向傳播建置是正確或者

97
00:06:31,435 --> 00:06:34,855
也許有錯誤您需要去挑出來