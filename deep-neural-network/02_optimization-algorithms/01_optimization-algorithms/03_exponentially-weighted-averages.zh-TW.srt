1
00:00:00,000 --> 00:00:02,760
我想要給你看一些最佳化的演算法

2
00:00:02,760 --> 00:00:04,795
他們比梯度下降法還要快。

3
00:00:04,795 --> 00:00:06,807
而為了能夠理解那些演算法，

4
00:00:06,807 --> 00:00:11,850
你必須能利用一個叫「指數加權平均」
(exponentially weighted averages)

5
00:00:11,850 --> 00:00:15,840
在統計領域也叫「指數移動平均」
(exponentially weighted moving averages)

6
00:00:15,840 --> 00:00:17,030
我們先談談這個，

7
00:00:17,030 --> 00:00:21,420
然後再藉此建構出更精密的最佳化演算法。

8
00:00:21,420 --> 00:00:23,820
那麼，雖然我現在住在美國

9
00:00:23,820 --> 00:00:25,463
我是在倫敦出生的

10
00:00:25,463 --> 00:00:31,120
所以這個例子，我是拿去年倫敦每天的溫度

11
00:00:31,120 --> 00:00:32,511
那麼一月一號

12
00:00:32,511 --> 00:00:35,175
氣溫是華氏40度

13
00:00:35,175 --> 00:00:37,795
我知道大部份地方都用攝氏

14
00:00:37,795 --> 00:00:41,065
不過我住在美國，用的是華氏

15
00:00:41,065 --> 00:00:43,550
總之這是攝氏4度。

16
00:00:43,550 --> 00:00:46,150
然後一月二號

17
00:00:46,150 --> 00:00:48,630
是攝氏9度，等等等

18
00:00:48,630 --> 00:00:50,250
然後一年過了一半

19
00:00:50,250 --> 00:00:52,373
一年有365天，所以會是

20
00:00:52,373 --> 00:00:56,530
第180天，我想大約是五月底

21
00:00:56,530 --> 00:01:00,795
氣溫是華氏60度，也就是攝氏15度

22
00:01:00,795 --> 00:01:05,575
所以天氣開始變暖，逐漸要到夏天，而一月的時候比較冷。

23
00:01:05,575 --> 00:01:08,435
所以你把這些資料畫出來會長這樣

24
00:01:08,435 --> 00:01:12,290
第一天是一月；這一個點你知道

25
00:01:12,290 --> 00:01:13,775
是夏天剛開始

26
00:01:13,775 --> 00:01:15,070
而這點是一年的最後

27
00:01:15,070 --> 00:01:17,380
也就是十二月底。

28
00:01:17,380 --> 00:01:20,194
所以這是一月一號

29
00:01:20,194 --> 00:01:21,885
這是年中近夏

30
00:01:21,885 --> 00:01:24,710
而這是年底的資料。

31
00:01:24,710 --> 00:01:29,885
所以這個資料看起來有些噪音，
如果你想計算其趨勢

32
00:01:29,885 --> 00:01:35,547
某種局部平均 (local average) 或移動平均 (moving average)

33
00:01:35,547 --> 00:01:37,885
你可以這樣做

34
00:01:37,885 --> 00:01:41,530
讓我們初始化 V_0 為 0

35
00:01:41,530 --> 00:01:43,640
然後呢，在每一天

36
00:01:43,640 --> 00:01:49,340
我們這樣做平均：對前一次的值乘以 0.9 作為加權

37
00:01:49,340 --> 00:01:53,600
再加上 0.1 乘以當天的氣溫

38
00:01:53,600 --> 00:01:57,155
所以這邊的 theta 1 是第一天的氣溫

39
00:01:57,155 --> 00:02:01,180
然後在第二天，我們同樣算加權平均：

40
00:02:01,180 --> 00:02:08,210
0.9 乘以上一個值，加上 0.1 乘以今天的氣溫，...

41
00:02:08,210 --> 00:02:12,930
... V_2 + 0.1 乘 theta_3，等等。

42
00:02:12,930 --> 00:02:20,470
一般性的公式是，某一天的 V 會是 0.9 乘前一天的 V

43
00:02:20,470 --> 00:02:25,460
再加上 0.1 乘當天的氣溫。

44
00:02:25,460 --> 00:02:28,035
那麼，如果你這樣計算，用紅色畫線

45
00:02:28,035 --> 00:02:29,527
會得到這個

46
00:02:29,527 --> 00:02:32,660
你會得到一個「移動平均」(moving average)，或者所謂

47
00:02:32,660 --> 00:02:36,510
每日氣溫的「指數加權平均」
(exponentially weighted average)

48
00:02:36,510 --> 00:02:39,560
那麼讓我們看看前一張投影片的方程式

49
00:02:39,560 --> 00:02:42,225
這是 V_t 等於

50
00:02:42,225 --> 00:02:44,210
剛剛我們用 0.9

51
00:02:44,210 --> 00:02:46,790
我們現在用一個參數 beta，

52
00:02:46,790 --> 00:02:51,190
beta 乘以 V_t-1 加上 — 剛剛用

53
00:02:51,190 --> 00:02:56,715
0.1，我在這邊換成 1-beta — 然後乘以 theta_t

54
00:02:56,715 --> 00:03:00,175
所以剛剛我們用 beta = 0.9

55
00:03:00,175 --> 00:03:03,230
實際上因為某些原因，我們等等會解釋，

56
00:03:03,230 --> 00:03:13,860
這樣的計算，你可以把 V_t 看成近似去平均

57
00:03:13,860 --> 00:03:21,400
「(1-beta) 分之一」天的氣溫

58
00:03:21,400 --> 00:03:26,895
所以例如 beta 為 0.9 的時候，你可以把

59
00:03:26,895 --> 00:03:32,430
這公式看成把過去10天的氣溫作平均

60
00:03:32,430 --> 00:03:36,050
這個就是這條紅線。

61
00:03:36,050 --> 00:03:37,215
現在我們試試不同的

62
00:03:37,215 --> 00:03:39,200
假設 beta 很靠近 1，

63
00:03:39,200 --> 00:03:41,660
假設是 0.98

64
00:03:41,660 --> 00:03:46,640
那麼，你看 1 / (1-0.98)，

65
00:03:46,640 --> 00:03:48,040
這個會等於 50

66
00:03:48,040 --> 00:03:51,340
所以你可以把這想成大約是

67
00:03:51,340 --> 00:03:54,085
最近50天氣溫的平均，

68
00:03:54,085 --> 00:03:58,360
畫出來會是這條綠色的線。

69
00:03:58,360 --> 00:04:01,870
注意幾件事情，當 beta 很大時

70
00:04:01,870 --> 00:04:04,565
畫出來的線會變比較平滑，因為

71
00:04:04,565 --> 00:04:07,635
你對更多天的氣溫去做平均

72
00:04:07,635 --> 00:04:08,795
所以你知道這曲線

73
00:04:08,795 --> 00:04:10,800
波動較小、比較平滑，

74
00:04:10,800 --> 00:04:14,300
但另一方面，這曲線會更

75
00:04:14,300 --> 00:04:18,840
往右偏移，因為你對比較大範圍 (window) 的氣溫去平均

76
00:04:18,840 --> 00:04:21,030
而拿比較大的範圍取平均

77
00:04:21,030 --> 00:04:24,275
這個公式，這個指數加權平均的公式

78
00:04:24,275 --> 00:04:25,850
他反映會比較慢

79
00:04:25,850 --> 00:04:27,920
當氣溫改變的時候

80
00:04:27,920 --> 00:04:29,755
所以會有比較多的延遲

81
00:04:29,755 --> 00:04:33,860
這是因為當 beta 等於 0.98 的時候

82
00:04:33,860 --> 00:04:38,240
前一次的值拿了很高的權重，而只有很小的權重 0.02

83
00:04:38,240 --> 00:04:40,700
會給現在看到的值，

84
00:04:40,700 --> 00:04:42,080
所以當氣溫改變

85
00:04:42,080 --> 00:04:43,560
當氣溫變高或變低

86
00:04:43,560 --> 00:04:45,845
這一個指數加權平均

87
00:04:45,845 --> 00:04:48,990
在 beta 很大時反應會很慢。

88
00:04:48,990 --> 00:04:51,160
那現在我們試試另一個值

89
00:04:51,160 --> 00:04:53,045
如果你把 beta 設成另個極端

90
00:04:53,045 --> 00:04:54,980
假設是 0.5

91
00:04:54,980 --> 00:04:58,755
根據右邊的公式，這個

92
00:04:58,755 --> 00:05:03,690
會類似只對兩天的氣溫平均，

93
00:05:03,690 --> 00:05:06,420
如果畫出來，會是這黃線。

94
00:05:06,420 --> 00:05:09,290
如果只對兩天的氣溫平均

95
00:05:09,290 --> 00:05:12,240
就如同你對很小的範圍 (window) 去平均

96
00:05:12,240 --> 00:05:13,415
所以噪音更大

97
00:05:13,415 --> 00:05:15,515
易被異常值影響

98
00:05:15,515 --> 00:05:19,490
但是這個能更快反映出氣溫的變化。

99
00:05:19,490 --> 00:05:24,390
所以要實作指數加權平均就是用這個公式

100
00:05:24,390 --> 00:05:26,090
再次說明，在統計的文獻中

101
00:05:26,090 --> 00:05:28,760
這被稱作指數加權「移動」平均

102
00:05:28,760 --> 00:05:32,210
我們就簡稱指數加權平均。

103
00:05:32,210 --> 00:05:36,000
藉由調整這個參數 — 其實之後會看到

104
00:05:36,000 --> 00:05:39,350
這其實是你的學習演算法的一個超參數 — 你會得到

105
00:05:39,350 --> 00:05:41,315
稍微不同的效果，而通常會有

106
00:05:41,315 --> 00:05:44,075
某個比較中庸的值效果最好。

107
00:05:44,075 --> 00:05:46,893
例如紅色這條線，這看起來可能

108
00:05:46,893 --> 00:05:50,450
比起綠線或黃線還是個更好的氣溫平均。

109
00:05:50,450 --> 00:05:54,160
你明白了指數加權平均計算的基本功

110
00:05:54,160 --> 00:05:58,010
在下部影片，讓我們去更體會這在做啥