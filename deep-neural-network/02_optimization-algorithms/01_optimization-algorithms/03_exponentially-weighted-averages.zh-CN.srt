1
00:00:00,000 --> 00:00:02,760
我想向你们展示几个优化算法

2
00:00:02,760 --> 00:00:04,795
它们比梯度下降更快

3
00:00:04,795 --> 00:00:06,807
为了理解这些算法

4
00:00:06,807 --> 00:00:11,850
你需要用到一种叫做指数加权平均的操作

5
00:00:11,850 --> 00:00:15,840
在统计学上也被称为指数加权滑动平均

6
00:00:15,840 --> 00:00:17,030
我们首先来看一下这个概念

7
00:00:17,030 --> 00:00:21,420
然后我们将要使用这个概念来构建更复杂的优化算法

8
00:00:21,420 --> 00:00:23,820
虽然现在我住在美国

9
00:00:23,820 --> 00:00:25,463
但我是在伦敦出生的

10
00:00:25,463 --> 00:00:31,120
所以在这个例子中 我将使用伦敦去年每天的温度作为例子

11
00:00:31,120 --> 00:00:32,511
比如在1月1日

12
00:00:32,511 --> 00:00:35,175
温度是40华氏度

13
00:00:35,175 --> 00:00:37,795
我知道现在世界上大部分地区都使用摄氏度了

14
00:00:37,795 --> 00:00:41,065
但是我所在的美国是使用华氏度的

15
00:00:41,065 --> 00:00:43,550
这个温度相当于4摄氏度

16
00:00:43,550 --> 00:00:46,150
在1月2日

17
00:00:46,150 --> 00:00:48,630
温度是9摄氏度 等等

18
00:00:48,630 --> 00:00:50,250
到了年中的时候

19
00:00:50,250 --> 00:00:52,373
因为一年有365天

20
00:00:52,373 --> 00:00:56,530
所以年中差不多是第180天 大约在5月末

21
00:00:56,530 --> 00:01:00,795
那时候的温度大概是60华氏度 也就是15摄氏度 等等

22
00:01:00,795 --> 00:01:05,575
进入夏天后越来越暖和 而1月的时候还是比较冷的

23
00:01:05,575 --> 00:01:08,435
如果你把这些数据画出来 就会得到这样一张图

24
00:01:08,435 --> 00:01:12,290
第一天就是1月份的某一天

25
00:01:12,290 --> 00:01:13,775
这里开始是夏天

26
00:01:13,775 --> 00:01:15,070
这里就是年末

27
00:01:15,070 --> 00:01:17,380
大约是12月底

28
00:01:17,380 --> 00:01:20,194
这里大概是1月1日

29
00:01:20,194 --> 00:01:21,885
这里是年中 接近夏天的时候

30
00:01:21,885 --> 00:01:24,710
这里就是年末的时候的数据

31
00:01:24,710 --> 00:01:29,885
这些数据看起来好像有些噪声
如果你想要计算数据的趋势

32
00:01:29,885 --> 00:01:35,547
即温度的局部平均或滑动平均

33
00:01:35,547 --> 00:01:37,885
你可以这样做

34
00:01:37,885 --> 00:01:41,530
首先令V_0=0

35
00:01:41,530 --> 00:01:43,640
之后每一天

36
00:01:43,640 --> 00:01:49,340
我们先用0.9乘以之前的值

37
00:01:49,340 --> 00:01:53,600
再加上0.1乘以当天的温度

38
00:01:53,600 --> 00:01:57,155
这里的theta_1就是第一天的温度

39
00:01:57,155 --> 00:02:01,180
对于第二天 我们仍然使用加权平均

40
00:02:01,180 --> 00:02:08,210
即0.9乘以之前的值 再加上0.1乘以今天的温度

41
00:02:08,210 --> 00:02:12,930
0.9*V_2加上0.1*theta_3 以此类推

42
00:02:12,930 --> 00:02:20,470
计算某天的V值更通用的公式是<br />0.9乘以前一天的V

43
00:02:20,470 --> 00:02:25,460
加上0.1乘以当天的温度

44
00:02:25,460 --> 00:02:28,035
如果你这样计算 并把结果用红色画出来

45
00:02:28,035 --> 00:02:29,527
你就会得到

46
00:02:29,527 --> 00:02:32,660
一个滑动平均的图

47
00:02:32,660 --> 00:02:36,510
称为每日温度的指数加权平均

48
00:02:36,510 --> 00:02:39,560
因此我们来看一下之前幻灯片的公式

49
00:02:39,560 --> 00:02:42,225
就是V_t等于

50
00:02:42,225 --> 00:02:44,210
之前的权重是0.9

51
00:02:44,210 --> 00:02:46,790
我们现在把它换成参数beta

52
00:02:46,790 --> 00:02:51,190
beta*V_(t-1)加上

53
00:02:51,190 --> 00:02:56,715
之前使用的是0.1 现在把它换成(1-beta)*theta_t

54
00:02:56,715 --> 00:03:00,175
之前beta=0.9

55
00:03:00,175 --> 00:03:03,230
出于我们之后会讲的某些原因

56
00:03:03,230 --> 00:03:13,860
当你计算这个公式的时候 你可以认为V_t近似于

57
00:03:13,860 --> 00:03:21,400
1/(1-beta)天温度的平均

58
00:03:21,400 --> 00:03:26,895
举例来说 当beta=0.9的时候

59
00:03:26,895 --> 00:03:32,430
你可以认为它是前10天的气温平均值

60
00:03:32,430 --> 00:03:36,050
这就是这条红线

61
00:03:36,050 --> 00:03:37,215
我们来试一下别的值

62
00:03:37,215 --> 00:03:39,200
我们把beta设置为非常接近1的值

63
00:03:39,200 --> 00:03:41,660
比如0.98

64
00:03:41,660 --> 00:03:46,640
这时计算1/(1-0.98)

65
00:03:46,640 --> 00:03:48,040
就得到了50

66
00:03:48,040 --> 00:03:51,340
这相当于粗略计算了

67
00:03:51,340 --> 00:03:54,085
前50天气温的平均值

68
00:03:54,085 --> 00:03:58,360
如果把它画出来 就会得到这条绿色的线

69
00:03:58,360 --> 00:04:01,870
有几个点需要注意
当beta的值很大的时候

70
00:04:01,870 --> 00:04:04,565
你得到的曲线会更平滑

71
00:04:04,565 --> 00:04:07,635
因为你对更多天数的温度做了平均处理

72
00:04:07,635 --> 00:04:08,795
因此曲线就

73
00:04:08,795 --> 00:04:10,800
波动更小 更加平滑

74
00:04:10,800 --> 00:04:14,300
但另一方面 这个曲线会右移

75
00:04:14,300 --> 00:04:18,840
因为你在一个更大的窗口内计算平均温度

76
00:04:18,840 --> 00:04:21,030
通过在更大的窗口内计算平均

77
00:04:21,030 --> 00:04:24,275
这个指数加权平均的公式

78
00:04:24,275 --> 00:04:25,850
在温度变化时

79
00:04:25,850 --> 00:04:27,920
适应地更加缓慢

80
00:04:27,920 --> 00:04:29,755
这就造成了一些延迟

81
00:04:29,755 --> 00:04:33,860
原因是 当beta=0.98的时候

82
00:04:33,860 --> 00:04:38,240
之前的值具有更大的权重 而当前值的权重就非常小

83
00:04:38,240 --> 00:04:40,700
只有0.02

84
00:04:40,700 --> 00:04:42,080
所以当温度变化的时候

85
00:04:42,080 --> 00:04:43,560
温度上升或者下降

86
00:04:43,560 --> 00:04:45,845
这个指数加权平均

87
00:04:45,845 --> 00:04:48,990
在beta较大时 就会适应得更慢

88
00:04:48,990 --> 00:04:51,160
我们来试试另一个值

89
00:04:51,160 --> 00:04:53,045
让beta的值取另一个极端

90
00:04:53,045 --> 00:04:54,980
比如0.5

91
00:04:54,980 --> 00:04:58,755
那么由右边的公式

92
00:04:58,755 --> 00:05:03,690
这就变成了只对两天进行平均

93
00:05:03,690 --> 00:05:06,420
如果画出来 就会得到黄色的线

94
00:05:06,420 --> 00:05:09,290
由于仅仅平均两天的气温

95
00:05:09,290 --> 00:05:12,240
即只在很小的窗口内计算平均

96
00:05:12,240 --> 00:05:13,415
得到结果中会有更多的噪声

97
00:05:13,415 --> 00:05:15,515
更容易受到异常值的影响

98
00:05:15,515 --> 00:05:19,490
但它可以更快地适应温度变化

99
00:05:19,490 --> 00:05:24,390
使用这个公式就可以实现指数加权平均

100
00:05:24,390 --> 00:05:26,090
在统计学中 它被称为

101
00:05:26,090 --> 00:05:28,760
指数加权滑动平均

102
00:05:28,760 --> 00:05:32,210
我们把它简称为指数加权平均

103
00:05:32,210 --> 00:05:36,000
通过调整这个参数

104
00:05:36,000 --> 00:05:39,350
也就是我们之后会在学习算法中看到的一个超参数

105
00:05:39,350 --> 00:05:41,315
就可以得到略微不同的收效

106
00:05:41,315 --> 00:05:44,075
通常取中间的某个值效果最好

107
00:05:44,075 --> 00:05:46,893
也就是这里的红色的曲线

108
00:05:46,893 --> 00:05:50,450
它对温度的平均比绿色或者黄色的曲线更好

109
00:05:50,450 --> 00:05:54,160
现在我们已经学习了如何计算指数加权平均

110
00:05:54,160 --> 00:05:58,010
在接下来的视频中 我们来直观地理解一下它的本质