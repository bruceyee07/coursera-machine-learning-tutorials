1
00:00:00,380 --> 00:00:03,660
你現在學到了如何做出指數加權平均
(exponentially weighted averages)

2
00:00:03,660 --> 00:00:06,760
技術上還有個細節，叫偏差矯正 (bias correction)

3
00:00:06,760 --> 00:00:10,335
這能讓你的計算更加準確

4
00:00:10,335 --> 00:00:11,990
我們來看它如何作用

5
00:00:11,990 --> 00:00:15,920
在上部影片，你見過這張 beta=0.9 的圖

6
00:00:15,920 --> 00:00:18,260
而這一個是 beta=0.98

7
00:00:18,260 --> 00:00:24,230
但是實際上呢，你用這一個公式實作的話

8
00:00:24,230 --> 00:00:29,320
例如當 beta=0.98，其實你畫不出來這條綠色的曲線

9
00:00:29,320 --> 00:00:32,430
你其實會得到紫色這條線

10
00:00:32,430 --> 00:00:36,410
你可以注意到，紫色這條線一開始非常低

11
00:00:36,410 --> 00:00:38,400
讓我們看看怎麼解決之。

12
00:00:38,400 --> 00:00:45,844
當你在實作移動平均 (moving average) 時，你從
v_0 = 0 開始

13
00:00:45,844 --> 00:00:50,524
然後 v_1 = 0.98 v_0 + 0.02 theta_1

14
00:00:50,524 --> 00:00:54,150
但是 v_0 是零，所以這一項就不見了

15
00:00:54,150 --> 00:00:57,430
所以 v_1 只剩 0.02 乘以 theta_1

16
00:00:57,430 --> 00:01:03,832
也就是假設第一天的氣溫是華氏 40 度的話

17
00:01:03,832 --> 00:01:07,837
那 v_1 會是 0.02 乘以 40，也就是 8 (口誤)

18
00:01:07,837 --> 00:01:10,790
所以這邊你得到一個非常低的值

19
00:01:10,790 --> 00:01:14,545
對於第一天的氣溫，這並不是個好的估計

20
00:01:14,545 --> 00:01:20,831
v_2 會是 0.98 v_1 + 0.02 theta_2

21
00:01:20,831 --> 00:01:26,893
如果你代入 v_1，也就是這個，然後乘起來

22
00:01:26,893 --> 00:01:32,092
你會發現 v_2 其實等於 0.98 乘以 0.02

23
00:01:32,092 --> 00:01:36,887
再乘以 theta_1，加上 0.02 乘以 theta_2

24
00:01:36,887 --> 00:01:45,102
這會是 0.0196 theta_1 + 0.02 theta_2

25
00:01:45,102 --> 00:01:49,319
所以同樣的，假設 theta_1, theta_2 是正的

26
00:01:49,319 --> 00:01:53,910
你算出這個 v_2，他會比 theta_1 或 theta_2 還要小的多

27
00:01:53,910 --> 00:01:59,190
所以 v_2 並不會是前兩天氣溫的好估計

28
00:01:59,190 --> 00:02:02,800
其實呢，用某個方法修改一下，就能讓這估計

29
00:02:02,800 --> 00:02:04,330
變得更好、更準

30
00:02:04,330 --> 00:02:08,050
尤其是對於估計一開始的階段

31
00:02:08,050 --> 00:02:13,460
是這樣的：不拿 v_t 當估計，而是拿 v_t 除以

32
00:02:13,460 --> 00:02:18,770
1 減 beta的t次方，這裡的 t 是你現在算哪一筆

33
00:02:18,770 --> 00:02:20,580
讓我們舉個實際的例子

34
00:02:20,580 --> 00:02:25,945
當 t=2 時， 1 - beta的t次方

35
00:02:25,945 --> 00:02:30,940
是 1 - 0.98 平方

36
00:02:30,940 --> 00:02:37,049
也就是 0.0396

37
00:02:37,049 --> 00:02:41,746
所以，你對第二天氣溫的估計

38
00:02:41,746 --> 00:02:45,949
會變成 v_2 除以 0.0396

39
00:02:45,949 --> 00:02:53,560
這會是 0.0196 乘以 theta_1 加上 0.02 乘 theta_2

40
00:02:53,560 --> 00:02:59,470
注意到這兩項的係數加起來，會等於分母 0.0396

41
00:02:59,470 --> 00:03:03,035
所以意思是，這個變成了 theta_1 和 theta_2 的加權平均

42
00:03:03,035 --> 00:03:05,190
這就把偏差弭平了。

43
00:03:05,190 --> 00:03:10,270
那你會注意到當 t 變大時，beta的t次方

44
00:03:11,730 --> 00:03:14,360
會趨近於 0，所以當 t 夠大的時候

45
00:03:14,360 --> 00:03:16,860
這邊的偏差矯正幾乎不會有分別；

46
00:03:16,860 --> 00:03:19,460
這就是為什麼 t 很大的時候

47
00:03:19,460 --> 00:03:21,765
紫線和綠線幾乎重疊了

48
00:03:21,765 --> 00:03:25,866
但在這一開始學習的階段，還在暖身的時候

49
00:03:25,866 --> 00:03:30,031
這種偏差矯正能幫你得到比較準確的

50
00:03:30,031 --> 00:03:31,138
氣溫估計

51
00:03:31,138 --> 00:03:34,731
偏差矯正讓你從紫色的線變成

52
00:03:34,731 --> 00:03:36,757
這條綠色的線。

53
00:03:36,757 --> 00:03:40,117
在機器學習中，大部分實作

54
00:03:40,117 --> 00:03:45,157
指數加權平均的時候，大家不會特別用心去做偏差矯正

55
00:03:45,157 --> 00:03:48,457
因為很多人寧願等著、撐過一開始的階段

56
00:03:48,457 --> 00:03:50,597
做有一點點誤差的估計，然後拿來用。

57
00:03:50,597 --> 00:03:54,170
不過，如果你對這初始階段的偏差有所擔心

58
00:03:54,170 --> 00:03:57,880
當你的指數加權移動平均還在暖車的時候

59
00:03:57,880 --> 00:04:02,873
那麼偏差矯正能幫助你，在早期就拿到比較準的估計

60
00:04:02,873 --> 00:04:06,800
現在呢，你知道怎麼實作指數移動加權平均了

61
00:04:06,800 --> 00:04:11,050
讓我們繼續下去，利用它來發明一些更好的優化演算法