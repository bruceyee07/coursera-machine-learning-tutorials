情感分类的任务是分析一段文本 告诉人们某个人是不是 喜欢他们正在谈论的东西 它是自然语言处理最重要的组成部分<br />在很多应用中使用 情感分类的挑战之一是 你可能缺乏一个特别大的<br />标签训练集 不过 使用词嵌入（word embedding）后 依靠一个中等大小的标签训练集 你也可以构建出一个很好的情感分类器 让我们看看该怎么做 有这样一个情感分类问题 输入X是一段文本 输出Y 是你想预测出的情感 比如酒店的 星级评分 如果有人说 甜点很棒 并且在评论中给了四颗星 服务很慢 两颗星 简单吃一顿还行 但没特色 三颗星还行 还有段比较严厉的批评 完全没品味 服务差 环境不好 评价只有一颗星 所以如果你要根据类似这样的标签数据集<br />训练实现从X到Y映射的系统 然后你可以用它来监控 人们对你开的餐厅的评论 人们也可能会在社交媒体上发些<br />与你的餐厅有关的信息 比如在Twitter Facebook Instagram或其他社交媒体上 如果你有一个情感分析器 它可以看一段文字 然后猜出 对你酒店的评论帖子的情感是正面还是负面的 然后你可以跟踪餐厅是否有问题 或者你的餐厅随时间变得更好还是更差 其中 情感分类的一个挑战是 你的标签数据集可能不是特别大 那么 对情感分类任务而言 训练集的数据可能在 10,000到100,000个词之间 这个都很常见 有时候甚至少于10,000个词<br />词嵌入可以 帮你更好地 了解训练集小的时候的情况 你可以这样做 在这个视频中 我们看一些不同的算法 有这样一个情感分类模型 你可以接收一个类似“甜点极好”的句子 然后在你的词典里面查这些词 我们像往常一样使用1万字的词典 我们现在构建一个分类器 把它映射到四星级的输出Y上。 给定这四个词 同之前一样 我们可以输入这四个词 查找one-hot向量 可以得出0 8 9 2 8 它是一个one-hot向量与嵌入矩阵E的乘积 它可以从更大的文本向量中学习 例如 它可以从 十亿词的向量或千亿词的向量学习 使用该向量抽取出"the"这个词的嵌入向量 然后对"dessert"执行相同的操作。 然后对"is" 然后对"excellent"执行相同的操作 如果利用非常大的数据集训练 例如几千亿个词 那么你可以甚至可以从不常见的词 中获取很多知识<br />然后把它们用到你的问题上 即使那些不在标注了的训练集中的词语也能用 现在我们有一个方法来构建分类器 你可以用这些向量 例如说有300维的向量 然后你可以对它们求和或求平均数 现在我在这儿放一个更大的求平均数符号<br />你可以用它来求和或求平均数 它会给你一个300维的向量 然后你可以把它传给一个softmax分类器<br />由它来输出Y-hat 然后softmax可以输出 一星到五星这五个结果的概率 这会有五个可能的结果来预测Y是什么 大家注意 这儿我们通过使用求平均的操作 这个特别的算法对短的或长的评论都有效果 即使评论只有100个单词长也有效果 你可以简单地对这一百个单词的所有特征向量求和或求平均 所以给你一个表示 一个300维的特征表示 然后你可以把它传到你的情感分类器 平均数的方法会有相当好的效果 它实际做的是求你的例子中所有单词的意思 平均数或求和 这对...（难以听清）情况也适用 这个算法的问题之一是它忽视了单词的顺序 特别是 以下面这个特别负面的评论为例 品味完全不佳 服务不好 环境不好 但是好这个词出现很多次 有很多 好 好 好 所以如果你使用类似这种忽视词语顺序的算法 仅仅对不同词语的所有向量求和或求平均数 那么最后在你最终的特征向量中<br />会有很多好的表示 你的分类起可能会 认为这个评论不错<br />即使这实际上是一个非常严厉的评论 这是个一星级的评论 现在有一个更复杂的模型 它不仅仅对你所有的词嵌入求和 你可以使用RNN进行情感分类 你可以这样做<br />你可以输入那则评论 品味完全不佳 服务不好 环境不好 然后为它们每一个都找出one-hot向量 所以我想只跳过 单个one-hot向量表示<br />但是利用多个one-hot向量 跟通常一样<br />把它与词嵌入矩阵E相乘 然后你可以得到多个词嵌入向量<br /> 接着你可以把它们输入到RNN 接下来RNN的任务是在最后一步计算 该表示 让你预测出Y-hat 这是我们上周看过的 多对一的RNN架构的一个例子 有了类似这样的算法后 可以考虑单词的顺序 得到更好的结果<br />并且能意识到 没有好品味 是一个负面评论 而且与之前的算法不同<br />知道 不好 是一个负面评论 因为之前的算法只是把所有的东西加和成一个大的词向量 并没有意识到 不好 的意思与 好 差别很大以及 品味不好 等等情况 那么如果你训练这个算法 最后你会得到一个非常不错的情感分类算法 因为你可以使用一个大得多的数据集训练词嵌入向量 得到的效果会更好 这甚至还可以泛化到没有在训练集中出现过的词语<br /> 比如如果有其他人说 完全缺乏好品味 好服务和好环境 或类似的评论 即使 缺乏 这个词不在你的标签训练集中 如果它在你训练词嵌入向量的十亿词或千亿词语料库中存在 或许你能得到正确的结果<br />甚至可以更好到泛化到那些 在训练词嵌入向量的训练集中存在 但是 在标签训练集中不一定存在的词语上 这个标签训练集可能是<br />你为情感分类问题专门准备的 这就是今天我要讲的关于情感分类的内容 我希望本节视频能给你一种感觉 一旦你从学习了一个词嵌入向量<br />或从网上下载了一个词嵌入向量 它可以让你相当迅速地构建出<br />非常有效的自然语言处理系统